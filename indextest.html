<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë”í™ˆì ê²€ - í•˜ìê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    
    <!-- Google Lens ìë™ ì‹¤í–‰ ë°©ì§€ -->
    <meta name="google" content="notranslate">
    <meta name="google" content="nositelinkssearchbox">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#10b981">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ë”í™ˆì ê²€">
    
    <!-- PWA Manifest -->
    <!-- manifest.json ì œê±° (CORS ì—ëŸ¬ ë°©ì§€) -->
    
    <!-- jsPDF + html2canvas Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- JSZip for ZIP download -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <!-- ExcelJS for Excel with images (ì•ˆì •ì ì¸ ë²„ì „) -->
    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>
    
    <!-- Google API Client Library -->
    <!-- Google API (ê´‘ê³ ì°¨ë‹¨ê¸°ë¡œ ì¸í•´ ì£¼ì„ ì²˜ë¦¬) -->
    <!-- <script src="https://apis.google.com/js/api.js"></script> -->
    <!-- <script src="https://accounts.google.com/gsi/client" async defer></script> -->
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --secondary: #fbbf24;
            --danger: #ef4444;
            --bg-dark: #1a202c;
            --bg-darker: #111827;
            --card-bg: rgba(30, 41, 59, 0.5);
            --border: rgba(255, 255, 255, 0.1);
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
        }

        /* ë¼ì´íŠ¸ ëª¨ë“œ */
        body.light-mode {
            --bg-dark: #f3f4f6;
            --bg-darker: #e5e7eb;
            --card-bg: rgba(255, 255, 255, 0.9);
            --border: rgba(0, 0, 0, 0.1);
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
            transition: background 0.3s ease, color 0.3s ease;
        }

        body.light-mode {
            background: linear-gradient(135deg, #f9fafb 0%, #e5e7eb 100%);
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(16, 185, 129, 0.3);
            position: relative; /* ë²„íŠ¼ ìœ„ì¹˜ ê¸°ì¤€ */
            /* sticky ì œê±° - íƒ­ë§Œ ê³ ì • */
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: white;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .tabs {
            display: flex;
            background: var(--card-bg);
            border-radius: 12px;
            padding: 5px;
            margin: 20px -20px;
            gap: 5px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            
            /* ìƒë‹¨ ê³ ì • */
            position: sticky;
            top: 0;
            z-index: 99;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .tab {
            flex: 1;
            padding: 12px 20px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 8px;
            font-weight: bold;
            transition: all 0.3s ease;
            white-space: nowrap;
            min-width: fit-content;
        }

        .tab.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            backdrop-filter: blur(10px);
        }

        body.light-mode .card {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid #e5e7eb;
        }

        .form-field {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            color: var(--primary);
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 14px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s ease;
        }

        body.light-mode .form-input {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #d1d5db;
        }

        body.light-mode textarea.form-input {
            background: rgba(255, 255, 255, 0.9);
        }

        body.light-mode select.form-input {
            background: rgba(255, 255, 255, 0.9);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .btn {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        .btn:active {
            transform: scale(0.97);
            opacity: 0.9;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .btn-primary:active {
            transform: scale(0.97);
            box-shadow: 0 2px 10px rgba(16, 185, 129, 0.6);
        }

        .btn-secondary {
            background: rgba(251, 191, 36, 0.1);
            border: 2px solid var(--secondary);
            color: var(--secondary);
        }

        .btn-danger {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--danger);
            color: var(--danger);
        }

        /* í‰ë©´ë„ ê´€ë¦¬ */
        .floorplan-container {
            text-align: center;
        }

        .floorplan-preview {
            width: 100%;
            max-height: 400px;
            object-fit: contain;
            border-radius: 12px;
            margin: 15px 0;
            border: 2px solid var(--border);
        }

        .photo-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .photo-action-btn {
            padding: 14px;
            background: var(--card-bg);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .photo-action-btn.camera {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--primary);
            color: var(--primary);
        }

        .photo-action-btn:active {
            transform: scale(0.98);
        }

        /* í•˜ì ëª©ë¡ */
        .defect-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid var(--border);
            position: relative;
        }

        body.light-mode .defect-card {
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
            border: 1px solid #e5e7eb;
        }

        .defect-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
        }

        .defect-number {
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
        }

        .defect-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            display: none; /* ìˆ¨ê¹€ ì²˜ë¦¬ */
        }

        .status-pending {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .status-completed {
            background: rgba(16, 185, 129, 0.2);
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .photo-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-delete {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 24px;
            height: 24px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ê³µê¸°ì§ˆ ì¸¡ì • */
        .air-quality-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid var(--border);
            position: relative;
        }

        .air-room-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            gap: 10px;
        }

        .air-room-name-input {
            flex: 1;
            padding: 10px 12px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--primary);
            font-weight: bold;
            font-size: 16px;
        }

        .air-room-delete {
            width: 40px;
            height: 40px;
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--danger);
            color: var(--danger);
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .air-inputs {
            display: grid;
            gap: 12px;
        }

        .air-input-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .air-input-group label {
            min-width: 100px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .air-input-group input {
            flex: 1;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            text-align: center;
        }

        .air-input-group span {
            color: var(--text-secondary);
            font-size: 12px;
            min-width: 80px;
        }

        .air-add-btn {
            width: 100%;
            padding: 14px;
            background: rgba(16, 185, 129, 0.1);
            border: 2px dashed var(--primary);
            border-radius: 12px;
            color: var(--primary);
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .air-add-btn:active {
            transform: scale(0.98);
        }

        .reference-info {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid var(--secondary);
            border-radius: 10px;
            padding: 12px;
            margin-top: 15px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* ë°ì´í„° ê´€ë¦¬ */
        .saved-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .saved-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .saved-info {
            flex: 1;
        }

        .saved-info h3 {
            color: var(--primary);
            margin-bottom: 5px;
        }

        .saved-info p {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .saved-actions {
            display: flex;
            gap: 8px;
        }

        .icon-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .icon-btn.load {
            background: rgba(16, 185, 129, 0.2);
            color: var(--primary);
        }

        .icon-btn.delete {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        /* Toast ì•Œë¦¼ */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(16, 185, 129, 0.95);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            font-weight: bold;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* ì¹´ë©”ë¼ ëª¨ë‹¬ */
        .camera-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .camera-modal.active {
            display: flex;
        }

        #cameraPreview {
            width: 100%;
            max-width: 600px;
            border-radius: 12px;
            /* Google Lens ìë™ ì‹¤í–‰ ë°©ì§€ */
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            pointer-events: auto;
        }

        .camera-controls {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
        }

        .camera-btn {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            border: 4px solid white;
            background: var(--primary);
            color: white;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            transition: all 0.1s ease;
        }

        .camera-btn:active {
            transform: scale(0.9);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .camera-btn.close {
            background: var(--danger);
        }

        /* í•€ì¹˜ì¤Œ ê¸°ëŠ¥ ì¶”ê°€ */
        .zoom-level {
            position: absolute;
            top: 30px;
            right: 20px;
            background: rgba(16, 185, 129, 0.9);
            color: white;
            padding: 10px 16px;
            border-radius: 20px;
            font-size: 15px;
            font-weight: bold;
            z-index: 1001;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        /* ì¤Œ ë²„íŠ¼ ì œê±°ë¨ - í•€ì¹˜ ì¤Œë§Œ ì‚¬ìš© */

        /* í…Œë§ˆ í† ê¸€ ë²„íŠ¼ */
        .theme-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 10;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        body.light-mode .theme-toggle {
            background: rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(0, 0, 0, 0.2);
        }

        /* í”Œë¡œíŒ… ë²„íŠ¼ */
        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5);
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .floating-btn:active {
            transform: scale(0.95);
        }

        .floating-btn:hover {
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.6);
        }

        /* ë¡œë”© */
        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 30px 40px;
            border-radius: 16px;
            z-index: 2000;
            text-align: center;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 20px;
            }

            .tab {
                padding: 10px 15px;
                font-size: 13px;
            }

            /* ë™/í˜¸ìˆ˜ëŠ” ëª¨ë°”ì¼ì—ì„œë„ ê°€ë¡œë¡œ í‘œì‹œ (ê°„ê²©ë§Œ ì¤„ì„) */
            .grid-2 {
                gap: 10px;
            }
        }

        /* ì„ íƒ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        select.form-input {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2310b981' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 36px;
        }

        /* ì…ë ¥ í•„ë“œ ë¹„í™œì„±í™” ìŠ¤íƒ€ì¼ */
        .form-input:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* í„°ì¹˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .touch-button-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 10px;
        }

        .touch-btn {
            padding: 10px 8px;
            border: 2px solid var(--border);
            background: rgba(30, 41, 59, 0.3);
            color: var(--text-secondary);
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        .touch-btn:active {
            transform: scale(0.95);
            opacity: 0.8;
        }

        .touch-btn.selected {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }
        
        .touch-btn.selected:active {
            transform: scale(0.95);
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.6);
        }

        .touch-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .selected-count {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* ==================== ë¡œê·¸ì¸ í™”ë©´ ìŠ¤íƒ€ì¼ ==================== */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .login-overlay.hidden {
            display: none;
        }

        .login-box {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 40px 30px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--border);
            backdrop-filter: blur(10px);
        }

        .login-logo {
            text-align: center;
            font-size: 48px;
            margin-bottom: 10px;
        }

        .login-title {
            text-align: center;
            color: var(--primary);
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .login-subtitle {
            text-align: center;
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 30px;
        }

        .login-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border);
            background: rgba(30, 41, 59, 0.3);
            color: var(--text-primary);
            border-radius: 12px;
            font-size: 16px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .login-input:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(30, 41, 59, 0.5);
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .login-btn:active {
            transform: scale(0.98);
        }

        .login-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .login-error {
            color: var(--danger);
            font-size: 14px;
            text-align: center;
            margin-top: 15px;
            display: none;
        }

        .login-error.show {
            display: block;
        }

        .login-info {
            text-align: center;
            color: var(--text-secondary);
            font-size: 12px;
            margin-top: 20px;
            line-height: 1.6;
        }

        .logout-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            z-index: 10;
            padding: 8px 14px;
            border-radius: 20px;
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid rgba(239, 68, 68, 0.4);
            backdrop-filter: blur(10px);
            color: var(--danger);
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);
            transition: all 0.3s ease;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
            display: none;
        }

        .logout-btn:active {
            transform: scale(0.95);
            background: var(--danger);
            color: white;
        }
        
        body.light-mode .logout-btn {
            background: rgba(239, 68, 68, 0.15);
            border: 2px solid rgba(239, 68, 68, 0.3);
        }
        /* ==================== ë¡œê·¸ì¸ í™”ë©´ ìŠ¤íƒ€ì¼ ë ==================== */
    </style>

</head>
<body>
    <!-- ==================== ë¡œê·¸ì¸ í™”ë©´ ==================== -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-box">
            <div class="login-logo">ğŸ </div>
            <div class="login-title">ë”í™ˆì ê²€</div>
            <div class="login-subtitle">ì§ì› ë¡œê·¸ì¸</div>
            
            <input 
                type="text" 
                id="accessCodeInput" 
                class="login-input" 
                placeholder="ì´ë¦„ (ì˜ˆ: ë°•ì§€í˜„)"
                autocomplete="off"
            >
            
            <input 
                type="password" 
                id="pinInput" 
                class="login-input" 
                placeholder="ê°œì¸ PIN (4ìë¦¬)"
                maxlength="4"
                inputmode="numeric"
                autocomplete="off"
            >
            
            <button id="loginBtn" class="login-btn" onclick="handleLogin()">
                ë¡œê·¸ì¸
            </button>
            
            <div id="loginError" class="login-error"></div>
            
            <div class="login-info">
                ğŸ“Œ ì´ë¦„ê³¼ PINì„ ëª¨ë¥´ì‹œë©´<br>
                ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”<br>
                ğŸ“ 070-8019-1456
            </div>
        </div>
    </div>

    <!-- ==================== ë¡œê·¸ì¸ í™”ë©´ ë ==================== -->

    <!-- í—¤ë” -->
    <div class="header">
        <!-- ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ (ë¡œê·¸ì¸ í›„ í‘œì‹œ) -->
        <button id="logoutBtn" class="logout-btn" onclick="handleLogout()">
            ğŸšª ë¡œê·¸ì•„ì›ƒ
        </button>
        
        <!-- í…Œë§ˆ í† ê¸€ ë²„íŠ¼ -->
        <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle" title="ë‹¤í¬/ë¼ì´íŠ¸ ëª¨ë“œ ì „í™˜">
            ğŸŒ™
        </button>
        
        <h1>ğŸ  ë”í™ˆì ê²€</h1>
        <p>í•˜ìê´€ë¦¬ ì‹œìŠ¤í…œ v3.2 (ì‚¬ì§„ 2ì¥ ì´¬ì˜)</p>
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>
    </div>

    <div class="container">
        <!-- íƒ­ ë©”ë‰´ -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('project', event)">ğŸ“ í”„ë¡œì íŠ¸</button>
            <button class="tab" onclick="switchTab('defects', event)">ğŸ” í•˜ìì ê²€</button>
            <button class="tab" onclick="switchTab('equipment', event)">ğŸ“¸ ì¥ë¹„ì ê²€</button>
            <button class="tab" onclick="switchTab('airquality', event)">ğŸŒ¬ï¸ ê³µê¸°ì§ˆ</button>
            <button class="tab" onclick="switchTab('data', event)">ğŸ’¾ ë°ì´í„°</button>
            <button class="tab" onclick="switchTab('contract', event)">ğŸ“„ ê³„ì•½ì„œ</button>
        </div>

        <!-- í”„ë¡œì íŠ¸ ì •ë³´ ì„¹ì…˜ -->
        <div id="project" class="section active">
            <!-- í”„ë¡œì íŠ¸ ëª©ë¡ ì¹´ë“œ -->
            <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; margin-bottom: 20px;">
                <h2 style="color: white; margin-bottom: 15px;">ğŸ“‹ í”„ë¡œì íŠ¸ ëª©ë¡</h2>
                
                <div style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap;">
                    <button onclick="addNewProject()" class="btn" style="background: white; color: #667eea; flex: 1; min-width: 120px;">
                        â• ìƒˆ í”„ë¡œì íŠ¸
                    </button>
                    <button onclick="deleteCurrentProject()" class="btn" style="background: rgba(255,255,255,0.2); color: white; flex: 1; min-width: 120px;">
                        ğŸ—‘ï¸ í˜„ì¬ ì‚­ì œ
                    </button>
                </div>

                <div id="projectList" style="background: rgba(255,255,255,0.1); border-radius: 8px; padding: 10px; max-height: 200px; overflow-y: auto;">
                    <!-- í”„ë¡œì íŠ¸ ëª©ë¡ì´ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>

                <div style="margin-top: 10px; font-size: 13px; opacity: 0.9;">
                    ğŸ’¡ íŒ: í•˜ë£¨ì— ì—¬ëŸ¬ í”„ë¡œì íŠ¸ë¥¼ ì‘ì—…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”„ë¡œì íŠ¸ë¥¼ í´ë¦­í•˜ë©´ ì „í™˜ë©ë‹ˆë‹¤.
                </div>
            </div>

            <div class="card">
                <h2 style="color: var(--primary); margin-bottom: 20px;">ğŸ“ í”„ë¡œì íŠ¸ ì •ë³´</h2>
                
                <div class="form-field">
                    <label class="form-label">ì•„íŒŒíŠ¸ëª…</label>
                    <input type="text" class="form-input" id="apartmentName" placeholder="ì˜ˆ: ë˜ë¯¸ì•ˆ ì•„íŒŒíŠ¸" oninput="autoSaveProjectData()">
                </div>

                <div class="grid-2">
                    <div class="form-field">
                        <label class="form-label">ë™</label>
                        <input type="text" class="form-input" id="dong" placeholder="ì˜ˆ: 101" oninput="cleanDongHo(this, 'ë™'); autoSaveProjectData()">
                    </div>
                    <div class="form-field">
                        <label class="form-label">í˜¸ìˆ˜</label>
                        <input type="text" class="form-input" id="ho" placeholder="ì˜ˆ: 502" oninput="cleanDongHo(this, 'í˜¸'); autoSaveProjectData()">
                    </div>
                </div>

                <div class="form-field">
                    <label class="form-label">ì ê²€ì¼ì</label>
                    <input type="date" class="form-input" id="inspectionDate" onchange="autoSaveProjectData()">
                </div>

                <div class="grid-2">
                    <div class="form-field">
                        <label class="form-label">ê³ ê°ëª…</label>
                        <input type="text" class="form-input" id="customerName" placeholder="ê³ ê° ì´ë¦„" oninput="autoSaveProjectData()">
                    </div>

                    <div class="form-field">
                        <label class="form-label">ì ê²€ ì‘ì„±ì</label>
                        <input type="text" class="form-input" id="author" placeholder="ì‘ì„±ì ì´ë¦„" oninput="autoSaveProjectData()">
                    </div>
                </div>

                <div class="form-field" style="display: none;">
                    <label class="form-label">ì—°ë½ì²˜</label>
                    <input type="tel" class="form-input" id="customerPhone" placeholder="010-0000-0000" oninput="autoSaveProjectData()">
                </div>

                <button class="btn btn-primary" onclick="saveProject()">âœ… í”„ë¡œì íŠ¸ ì •ë³´ ì €ì¥</button>
            </div>

            <!-- í‰ë©´ë„ ì„¹ì…˜ í†µí•© -->
            <div class="card" style="margin-top: 20px;">
                <h2 style="color: var(--primary); margin-bottom: 20px;">ğŸ“ í‰ë©´ë„ ê´€ë¦¬</h2>
                
                <div class="floorplan-container">
                    <img id="floorplanPreview" class="floorplan-preview" style="display: none;">
                    <p id="floorplanPlaceholder" style="color: var(--text-secondary); padding: 60px 0;">
                        í‰ë©´ë„ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”
                    </p>
                    
                    <div class="photo-actions">
                        <button class="photo-action-btn camera" onclick="openFloorplanCamera()">
                            ğŸ“· ì´¬ì˜í•˜ê¸°
                        </button>
                        <button class="photo-action-btn" onclick="openFloorplanGallery()">
                            ğŸ–¼ï¸ ê°¤ëŸ¬ë¦¬
                        </button>
                    </div>

                    <button class="btn btn-danger" onclick="deleteFloorplan()" style="margin-top: 15px;">
                        ğŸ—‘ï¸ í‰ë©´ë„ ì‚­ì œ
                    </button>
                </div>
            </div>
        </div>

        <!-- í•˜ì ì ê²€ ì„¹ì…˜ -->
        <div id="defects" class="section">
            <div class="card">
                <h2 style="color: var(--primary); margin-bottom: 20px;">ğŸ” í•˜ì ì ê²€</h2>
                <p style="color: var(--text-secondary); font-size: 14px;">
                    ìš°ì¸¡ í•˜ë‹¨ì˜ â• ë²„íŠ¼ì„ ëˆŒëŸ¬ í•˜ìë¥¼ ì¶”ê°€í•˜ì„¸ìš”
                </p>
            </div>

            <div id="defectsList"></div>
        </div>

        <!-- ì¥ë¹„ì ê²€ ì„¹ì…˜ -->
        <div id="equipment" class="section">
            <div class="card">
                <h2 style="color: var(--primary); margin-bottom: 20px;">ğŸ“¸ ì¥ë¹„ ì ê²€ LIST</h2>
                <p style="color: var(--text-secondary); font-size: 14px;">
                    ì—´í™”ìƒ ì¹´ë©”ë¼ ë° ì‹¤ë¬¼ ì‚¬ì§„ ì´¬ì˜ (ìš°ì¸¡ í•˜ë‹¨ â• ë²„íŠ¼)
                </p>
            </div>

            <div id="equipmentList"></div>
        </div>

        <!-- ê³µê¸°ì§ˆ ì¸¡ì • ì„¹ì…˜ -->
        <div id="airquality" class="section">
            <div class="card">
                <h2 style="color: var(--primary); margin-bottom: 20px;">ğŸŒ¬ï¸ ê³µê¸°ì§ˆ ì¸¡ì •</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 14px;">
                    ì‹¤ë‚´ ê³µê¸°ì§ˆì„ ì¸¡ì •í•˜ê³  ê¸°ë¡í•˜ì„¸ìš”
                </p>
            </div>

            <div id="airQualityList"></div>

            <button class="air-add-btn" onclick="addAirQualityRoom()">
                â• ë°© ì¶”ê°€
            </button>

            <div class="card reference-info">
                <strong>ğŸ“‹ ê¶Œê³ ê¸°ì¤€</strong><br>
                ë¼ëˆ: 148 Bq/mÂ³ ì´í•˜<br>
                í¬ë¦„ì•Œë°íˆë“œ: 0.210 mg/mÂ³ ì´í•˜<br>
                ì´íœ˜ë°œì„±ìœ ê¸°í™”í•©ë¬¼: 0.500 mg/mÂ³ ì´í•˜
            </div>
        </div>

        <!-- ë°ì´í„° ê´€ë¦¬ ì„¹ì…˜ -->
        <div id="data" class="section">
            <!-- Google Drive ì—°ë™ ì¹´ë“œ -->
            <!-- Google Drive ì—°ë™ (ê¸°ë³¸ ìˆ¨ê¹€) -->
            <div class="card" id="googleDriveCard" style="background: linear-gradient(135deg, #4285f4 0%, #34a853 100%); color: white; margin-bottom: 20px; display: none;">
                <h2 style="color: white; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; justify-content: space-between;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                            <path d="M6.5 12L1 21h11l5.5-9H6.5zM19 12l-5.5-9L8 12h11zM7.5 3l-6 9h11l-5-9z"/>
                        </svg>
                        Google Drive ì—°ë™ (ì„ íƒ ê¸°ëŠ¥)
                    </div>
                    <button onclick="toggleGoogleDrive()" style="background: rgba(255,255,255,0.3); border: none; color: white; padding: 4px 12px; border-radius: 12px; cursor: pointer; font-size: 14px;">
                        âœ• ë‹«ê¸°
                    </button>
                </h2>
                
                <div style="margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 8px; font-size: 13px;">
                    ğŸ’¡ <strong>íŒ€ ê³µìœ  ê¸°ëŠ¥:</strong> Google Client IDë¥¼ ì„¤ì •í•˜ë©´ íŒ€ì›ë“¤ê³¼ ë°ì´í„°ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜¼ì ì‚¬ìš©í•˜ì‹ ë‹¤ë©´ ì´ ê¸°ëŠ¥ì€ í•„ìš” ì—†ìŠµë‹ˆë‹¤.
                </div>
                
                <div id="googleDriveStatus" style="margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.2); border-radius: 8px; font-size: 14px;">
                    <div id="notSignedIn" style="display: block;">
                        âš ï¸ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.
                    </div>
                    <div id="signedIn" style="display: none;">
                        âœ… <span id="userEmail"></span>ë‹˜ ë¡œê·¸ì¸ë¨
                    </div>
                </div>
                
                <!-- Google Client ID ì„¤ì • -->
                <div id="clientIdSetup" style="margin-bottom: 15px; padding: 10px; background: rgba(251, 191, 36, 0.2); border: 1px solid rgba(251, 191, 36, 0.5); border-radius: 8px; display: none;">
                    <div style="font-size: 13px; color: #fbbf24; margin-bottom: 8px;">
                        ğŸ”‘ Google Client IDë¥¼ ì…ë ¥í•˜ì„¸ìš”
                    </div>
                    <input type="text" id="clientIdInput" placeholder="123456789-abcdef.apps.googleusercontent.com" 
                           style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ddd; margin-bottom: 8px; font-size: 12px;">
                    <button onclick="saveClientId()" class="btn" style="width: 100%; background: #fbbf24; color: #1a202c; font-weight: bold;">
                        ğŸ’¾ ì €ì¥
                    </button>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button id="signInBtn" class="btn" onclick="handleGoogleSignIn()" style="flex: 1; background: white; color: #4285f4; font-weight: bold;">
                        ğŸ” Google ë¡œê·¸ì¸
                    </button>
                    <button id="signOutBtn" class="btn" onclick="handleGoogleSignOut()" style="flex: 1; background: rgba(255,255,255,0.2); color: white; display: none;">
                        ğŸšª ë¡œê·¸ì•„ì›ƒ
                    </button>
                    <button onclick="toggleClientIdSetup()" class="btn" style="background: rgba(251, 191, 36, 0.2); color: #fbbf24; padding: 0 15px;">
                        âš™ï¸
                    </button>
                </div>
                
                <!-- ë™ê¸°í™” ë²„íŠ¼ (ì˜¤í”„ë¼ì¸ ì‘ì—… ì‹œ í‘œì‹œ) -->
                <button id="syncBtn" class="btn" onclick="syncPendingProjects()" style="display: none; margin-top: 10px; background: #fbbf24; color: #1a202c; font-weight: bold; position: relative;">
                    <span id="syncBadge" style="position: absolute; top: -8px; right: -8px; background: #ef4444; color: white; border-radius: 50%; width: 24px; height: 24px; display: none; align-items: center; justify-content: center; font-size: 12px; font-weight: bold;">0</span>
                    ğŸ“¤ ëŒ€ê¸° í”„ë¡œì íŠ¸ ë™ê¸°í™”
                </button>
            </div>

            <!-- í´ë¼ìš°ë“œ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° -->
            <div class="card" id="cloudActionsCard" style="display: none;">
                <h3 style="color: var(--primary); margin-bottom: 15px;">â˜ï¸ í´ë¼ìš°ë“œ ì €ì¥ì†Œ</h3>
                
                <button class="btn btn-primary" onclick="uploadProjectToDrive()" style="margin-bottom: 10px;">
                    â˜ï¸ Driveì— ì €ì¥
                </button>
                
                <button class="btn btn-secondary" onclick="loadFromDrive()" style="margin-bottom: 10px;">
                    ğŸ“¥ Driveì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
                </button>

                <button class="btn" onclick="showDriveProjects()" style="background: #34a853; color: white;">
                    ğŸ“‚ í”„ë¡œì íŠ¸ ëª©ë¡ ë³´ê¸°
                </button>
            </div>

            <div class="card">
                <h2 style="color: var(--primary); margin-bottom: 15px;">ğŸ’¾ ë‹¤ìš´ë¡œë“œ & ê´€ë¦¬</h2>
                
                <button class="btn btn-primary" onclick="generatePDF()">ğŸ“„ PDF ë³´ê³ ì„œ ìƒì„±</button>
                
                <div style="height: 10px;"></div>
                
                <button class="btn" onclick="downloadAllData()" style="background: #3b82f6; color: white; font-weight: bold;">
                    ğŸ“¦ ëª¨ë“  ìë£Œ ë‹¤ìš´ë¡œë“œ (ì—‘ì…€ + ì‚¬ì§„ ZIP)
                </button>
                
                <div style="height: 10px;"></div>
                
                <button class="btn" onclick="generateEquipmentOnlyPDF()" style="background: #6366f1; color: white; font-weight: bold;">
                    ğŸ”§ ì¥ë¹„ì ê²€ ë³´ê³ ì„œ (ì¥ë¹„ì¸¡ì •ë§Œ)
                </button>
                
                <div style="height: 10px;"></div>
                
                <button class="btn" onclick="generateFieldReportPDF()" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; font-weight: bold;">
                    ğŸ“‹ í˜„ì¥ì¶œë ¥ë³´ê³ ì„œ (ìš”ì•½í˜• í…Œì´ë¸”)
                </button>
                
                <div style="height: 20px;"></div>
                
                <details style="margin-bottom: 20px;">
                    <summary style="cursor: pointer; padding: 10px; background: rgba(239, 68, 68, 0.1); border-radius: 8px; color: #ef4444; font-weight: bold;">
                        âš ï¸ ê³ ê¸‰ ê¸°ëŠ¥ (ì¼ë°˜ ì‚¬ìš©ìëŠ” í•„ìš” ì—†ìŒ)
                    </summary>
                    <div style="padding: 15px; background: rgba(0,0,0,0.05); border-radius: 8px; margin-top: 10px;">
                        <p style="font-size: 13px; color: #333; margin-bottom: 10px;">
                            ğŸ’¡ <strong>ìë™ ì €ì¥:</strong> ë°ì´í„°ëŠ” ì…ë ¥ê³¼ ë™ì‹œì— ìë™ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.<br>
                            ğŸ’¡ <strong>ë°ì´í„° ì‚­ì œ:</strong> ë¸Œë¼ìš°ì € ë°ì´í„°ë¥¼ ì™„ì „íˆ ì§€ìš°ê³  ì‹¶ì„ ë•Œë§Œ ì‚¬ìš©í•˜ì„¸ìš”.
                        </p>
                        
                        <!-- íŒ€ ê³µìœ  ê¸°ëŠ¥ ë²„íŠ¼ -->
                        <button onclick="toggleGoogleDrive()" class="btn" style="width: 100%; background: rgba(66, 133, 244, 0.1); color: #4285f4; margin-bottom: 10px; font-weight: bold;">
                            â˜ï¸ íŒ€ ê³µìœ  ê¸°ëŠ¥ (Google Drive ì—°ë™)
                        </button>
                        
                        <button class="btn btn-secondary" onclick="saveCurrentData()" style="width: 100%; margin-bottom: 10px;">
                            ğŸ’¾ ìˆ˜ë™ ì €ì¥ (ìë™ ì €ì¥ë˜ë¯€ë¡œ ë¶ˆí•„ìš”)
                        </button>
                        <button class="btn btn-danger" onclick="clearAllData()" style="width: 100%; margin-bottom: 15px;">
                            ğŸ—‘ï¸ ëª¨ë“  ë°ì´í„° ì‚­ì œ (ë³µêµ¬ ë¶ˆê°€)
                        </button>
                        
                        <div style="border-top: 2px solid rgba(239, 68, 68, 0.2); padding-top: 15px; margin-top: 15px;">
                            <h3 style="color: var(--danger); margin-bottom: 15px; font-size: 16px;">ğŸ“¦ ì €ì¥ëœ í”„ë¡œì íŠ¸ ëª©ë¡</h3>
                            <p style="font-size: 13px; color: #333; margin-bottom: 10px;">
                                âš ï¸ <strong>í”„ë¡œì íŠ¸ ì‚­ì œ ì‹œ ë³µêµ¬ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤!</strong>
                            </p>
                            <div id="savedList" class="saved-list"></div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
    </div>

    <!-- ì¹´ë©”ë¼ ëª¨ë‹¬ -->
    <div id="cameraModal" class="camera-modal">
        <video id="cameraPreview" autoplay playsinline></video>
        
        <!-- í„°ì¹˜ í¬ì¸íŠ¸ ë§ˆì»¤ í‘œì‹œìš© ìº”ë²„ìŠ¤ ì˜¤ë²„ë ˆì´ -->
        <canvas id="markerCanvas" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10;"></canvas>
        
        <!-- ì¤Œ ë ˆë²¨ í‘œì‹œ -->
        <div class="zoom-level" id="zoomLevel">ì¤Œ: 1.0x</div>
        
        <div class="camera-controls">
            <button class="camera-btn" onclick="capturePhoto()" ontouchend="capturePhoto()">ğŸ“¸</button>
            <button class="camera-btn close" onclick="closeCameraModal()" ontouchend="closeCameraModal()">âœ•</button>
        </div>
    </div>

        <!-- ê³„ì•½ì„œ ê´€ë¦¬ ì„¹ì…˜ (ìˆ¨ê¹€) -->
        <div id="contract" class="section">
            <div class="card">
                <h2 style="color: var(--primary); margin-bottom: 20px;">ğŸ“„ í”„ë¦¬ëœì„œ ê³„ì•½ì„œ ê´€ë¦¬</h2>
                <p style="color: var(--text-secondary); margin-bottom: 30px; font-size: 14px;">
                    í”„ë¦¬ëœì„œ ê³ ìš©ê³„ì•½ì„œë¥¼ ë””ì§€í„¸ë¡œ ì‘ì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤
                </p>

                <!-- ê³„ì•½ì„œ ì‘ì„± ì•ˆë‚´ -->
                <div style="text-align: center; margin-bottom: 30px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); padding: 30px; border-radius: 15px;">
                    <p style="color: white; font-size: 20px; font-weight: bold; margin-bottom: 12px;">
                        âœ¨ ê°„í¸í•œ ê³„ì•½ì„œ ì‘ì„±
                    </p>
                    <p style="color: white; font-size: 15px; margin-bottom: 20px; opacity: 0.95;">
                        ì‘ì„± â†’ ì„œëª… â†’ PDF ë‹¤ìš´ë¡œë“œ â†’ ì¹´í†¡/ì´ë©”ì¼ ê³µìœ 
                    </p>
                    <button class="btn" onclick="showContractForm()" 
                        style="background: white; color: #10b981; font-size: 17px; padding: 14px 35px; font-weight: bold; border: none;">
                        â• ê³„ì•½ì„œ ì‘ì„±í•˜ê¸°
                    </button>
                </div>

                <!-- ê³„ì•½ì„œ ì‘ì„± í¼ -->
                <div id="contractForm" style="display: block;">
                    <div class="form-group">
                        <h3 style="color: var(--primary); margin-bottom: 15px;">ğŸ‘¤ í”„ë¦¬ëœì„œ ì •ë³´</h3>
                        
                        <div class="form-field">
                            <label class="form-label">ì„±ëª… *</label>
                            <input type="text" class="form-input" id="contractName" required>
                        </div>

                        <div class="form-field">
                            <label class="form-label">ì£¼ì†Œ *</label>
                            <input type="text" class="form-input" id="contractAddress" required>
                        </div>

                        <div class="form-field">
                            <label class="form-label">ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ *</label>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input type="text" class="form-input" id="contractJumin1" placeholder="ìƒë…„ì›”ì¼ 6ìë¦¬" 
                                    maxlength="6" style="width: 150px;" required>
                                <span>-</span>
                                <input type="text" class="form-input" id="contractJumin2" placeholder="ë’·ìë¦¬ 1ìë¦¬" 
                                    maxlength="1" style="width: 60px;" required>
                                <span>******</span>
                            </div>
                        </div>

                        <div class="form-field">
                            <label class="form-label">ì—°ë½ì²˜ *</label>
                            <input type="tel" class="form-input" id="contractPhone" placeholder="010-0000-0000" required>
                        </div>

                        <div class="form-field">
                            <label class="form-label">ì´ë©”ì¼ *</label>
                            <input type="email" class="form-input" id="contractEmail" required>
                        </div>

                        <div class="form-field">
                            <label class="form-label">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ (ì„ íƒ)</label>
                            <input type="text" class="form-input" id="contractBusiness" placeholder="000-00-00000">
                        </div>
                    </div>

                    <div class="form-group" style="margin-top: 30px;">
                        <h3 style="color: var(--primary); margin-bottom: 15px;">ğŸ“‹ ê³„ì•½ ì¡°ê±´</h3>
                        
                        <div class="form-field">
                            <label class="form-label">ê³„ì•½ ì‹œì‘ì¼ *</label>
                            <input type="date" class="form-input" id="contractStartDate" required>
                        </div>

                        <div class="form-field">
                            <label class="form-label">ê³„ì•½ ì¢…ë£Œì¼ *</label>
                            <input type="date" class="form-input" id="contractEndDate" required>
                        </div>

                        <div class="form-field">
                            <label class="form-label">ê³„ì•½ê¸ˆì•¡ ì•ˆë‚´</label>
                            <div style="padding: 15px; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border-left: 4px solid var(--primary);">
                                <p style="color: var(--text-primary); margin-bottom: 8px;">
                                    <strong>ì¼ë‹¹: 1ë§Œì› ~ 50ë§Œì›</strong>
                                </p>
                                <p style="color: var(--text-secondary); font-size: 13px;">
                                    â€» ì—…ë¬´ì— ë”°ë¼ ì§€ê¸‰ë¹„ìš©ì´ ë‹¤ë¥´ê²Œ ì§€ê¸‰ë©ë‹ˆë‹¤
                                </p>
                            </div>
                        </div>

                        <div class="form-field">
                            <label class="form-label">ì§€ê¸‰ì¼ ì•ˆë‚´</label>
                            <div style="padding: 15px; background: rgba(251, 191, 36, 0.1); border-radius: 8px; border-left: 4px solid var(--secondary);">
                                <p style="color: var(--text-primary); margin-bottom: 8px;">
                                    <strong>ì—…ë¬´ ì™„ë£Œ í›„ 1ê°œì›” ì´ë‚´ ì§€ê¸‰</strong>
                                </p>
                                <p style="color: var(--text-secondary); font-size: 13px;">
                                    â€» ì‚¬ì—…ì†Œë“ì„¸ 3.3% ì›ì²œì§•ìˆ˜ í›„ ì§€ê¸‰
                                </p>
                            </div>
                        </div>

                        <div class="form-field">
                            <label class="form-label">íŠ¹ì´ì‚¬í•­ (ì„ íƒ)</label>
                            <textarea class="form-input" id="contractNotes" rows="3" 
                                placeholder="ì¶”ê°€ ê³„ì•½ ì¡°ê±´ì´ë‚˜ íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                        </div>
                    </div>

                    <div class="form-group" style="margin-top: 30px;">
                        <h3 style="color: var(--primary); margin-bottom: 15px;">âœï¸ ì „ì ì„œëª…</h3>
                        
                        <div style="margin-bottom: 20px;">
                            <label class="form-label">ëŒ€í‘œ ì„œëª… (ë°•ì§€í˜„)</label>
                            <div style="border: 2px solid var(--border); border-radius: 8px; background: white; position: relative;">
                                <canvas id="signatureCEO" width="600" height="200" 
                                    style="display: block; width: 100%; cursor: crosshair; touch-action: none;"></canvas>
                            </div>
                            <button class="btn" onclick="clearSignature('CEO')" style="margin-top: 10px; background: var(--danger);">
                                ğŸ—‘ï¸ ì„œëª… ì§€ìš°ê¸°
                            </button>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <label class="form-label">í”„ë¦¬ëœì„œ ì„œëª…</label>
                            <div style="border: 2px solid var(--border); border-radius: 8px; background: white; position: relative;">
                                <canvas id="signatureFreelancer" width="600" height="200" 
                                    style="display: block; width: 100%; cursor: crosshair; touch-action: none;"></canvas>
                            </div>
                            <button class="btn" onclick="clearSignature('Freelancer')" style="margin-top: 10px; background: var(--danger);">
                                ğŸ—‘ï¸ ì„œëª… ì§€ìš°ê¸°
                            </button>
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 30px;">
                        <button class="btn btn-primary" onclick="previewContract()" style="flex: 1;">
                            ğŸ‘ï¸ ë¯¸ë¦¬ë³´ê¸°
                        </button>
                        <button class="btn btn-primary" onclick="downloadContractPDF()" style="flex: 1;">
                            ğŸ“¥ PDF ë‹¤ìš´ë¡œë“œ
                        </button>
                    </div>
                    <p style="text-align: center; margin-top: 15px; color: var(--text-secondary); font-size: 14px;">
                        ğŸ’¡ ì„œëª… í›„ PDF ë‹¤ìš´ë¡œë“œ â†’ ì¹´í†¡/ì´ë©”ì¼ë¡œ ê³µìœ í•˜ì„¸ìš”
                    </p>
                </div>

                <!-- ê³„ì•½ì„œ ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ -->
                <div id="contractPreviewModal" style="display: none; position: fixed; top: 0; left: 0; 
                    width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; 
                    overflow: auto; padding: 20px;">
                    <div style="max-width: 800px; margin: 0 auto; background: white; 
                        border-radius: 15px; padding: 30px; position: relative; color: #333;">
                        <button onclick="closePreview()" 
                            style="position: absolute; top: 15px; right: 15px; 
                            background: #dc3545; color: white; border: none; 
                            border-radius: 50%; width: 40px; height: 40px; 
                            font-size: 20px; cursor: pointer;">âœ•</button>
                        
                        <div id="contractPreviewContent"></div>
                        
                        <div style="margin-top: 30px; text-align: center;">
                            <button class="btn btn-primary" onclick="closePreview()" style="padding: 12px 40px; font-size: 16px;">
                                ë‹«ê¸°
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    <!-- í”Œë¡œíŒ… í•˜ì/ì¥ë¹„ ì¶”ê°€ ë²„íŠ¼ -->
    <button id="floatingAddBtn" class="floating-btn" onclick="handleFloatingBtnClick()" style="display: none;">
        â•
    </button>

    <!-- ë¡œë”© -->
    <div id="loading" class="loading">
        <div class="spinner"></div>
        <p>ì²˜ë¦¬ ì¤‘...</p>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <!-- Drive í”„ë¡œì íŠ¸ ëª©ë¡ ëª¨ë‹¬ -->
    <div id="driveProjectsModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 10000; overflow-y: auto;">
        <div style="max-width: 600px; margin: 50px auto; background: var(--bg-dark); border-radius: 12px; padding: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="color: var(--primary);">ğŸ“‚ Drive í”„ë¡œì íŠ¸ ëª©ë¡</h2>
                <button onclick="closeDriveProjectsModal()" style="background: none; border: none; color: white; font-size: 24px; cursor: pointer;">âœ•</button>
            </div>
            <div id="driveProjectsList" style="max-height: 60vh; overflow-y: auto;">
                <!-- í”„ë¡œì íŠ¸ ëª©ë¡ì´ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script>
        // ==================== ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ====================
        // Google Sheets ê³µê°œ URL (CSV í˜•ì‹)
        // ì‚¬ìš© ë°©ë²•: Google Sheets â†’ íŒŒì¼ â†’ ê³µìœ  â†’ ì›¹ì— ê²Œì‹œ â†’ CSV í˜•ì‹ ì„ íƒ
        const GOOGLE_SHEETS_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS4Tz0-NgXyWR36c9hkZ4ko0ll4g-oj5YGHZysuH0c1Mngr4Ev9-VgiryTHHcMd2Zq5NuOmOI6dMZeh/pub?output=csv';
        
        // ë¡œê·¸ì¸ í™•ì¸
        function checkLoginStatus() {
            const loginData = localStorage.getItem('dhLoginData');
            
            if (loginData) {
                try {
                    const data = JSON.parse(loginData);
                    const now = new Date().getTime();
                    
                    // 90ì¼ = 90 * 24 * 60 * 60 * 1000
                    if (now - data.loginTime < 90 * 24 * 60 * 60 * 1000) {
                        // ë¡œê·¸ì¸ ìœ íš¨
                        hideLoginScreen();
                        return true;
                    } else {
                        // ì„¸ì…˜ ë§Œë£Œ
                        localStorage.removeItem('dhLoginData');
                    }
                } catch (e) {
                    localStorage.removeItem('dhLoginData');
                }
            }
            
            // ë¡œê·¸ì¸ í•„ìš”
            showLoginScreen();
            return false;
        }
        
        // ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
        function showLoginScreen() {
            document.getElementById('loginOverlay').classList.remove('hidden');
            document.getElementById('logoutBtn').style.display = 'none';
            document.getElementById('accessCodeInput').focus();
        }
        
        // ë¡œê·¸ì¸ í™”ë©´ ìˆ¨ê¹€
        function hideLoginScreen() {
            document.getElementById('loginOverlay').classList.add('hidden');
            document.getElementById('logoutBtn').style.display = 'block';
        }
        
        // Google Sheetsì—ì„œ ì•¡ì„¸ìŠ¤ ì½”ë“œ ë° PIN í™•ì¸
        async function verifyAccessCode(code, pin) {
            try {
                // Google Sheets CSV ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const response = await fetch(GOOGLE_SHEETS_CSV_URL);
                
                if (!response.ok) {
                    throw new Error('ì„œë²„ ì—°ê²° ì‹¤íŒ¨');
                }
                
                const csvText = await response.text();
                const lines = csvText.split('\n');
                
                // CSV íŒŒì‹± (ì²« ì¤„ì€ í—¤ë”ì´ë¯€ë¡œ ê±´ë„ˆëœ€)
                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (!line) continue;
                    
                    // CSV í˜•ì‹: ì•¡ì„¸ìŠ¤ì½”ë“œ,ì´ë¦„,ì†Œì†,ìƒíƒœ,PIN
                    const columns = line.split(',');
                    const accessCode = columns[0]?.trim();
                    const status = columns[3]?.trim();
                    const storedPin = columns[4]?.trim();
                    
                    // ì½”ë“œ ì¼ì¹˜ ë° í™œì„± ìƒíƒœ ë° PIN í™•ì¸
                    if (accessCode === code && status === 'í™œì„±' && storedPin === pin) {
                        return {
                            success: true,
                            name: columns[1]?.trim(),
                            team: columns[2]?.trim()
                        };
                    }
                }
                
                return { success: false, message: 'ì´ë¦„ ë˜ëŠ” PINì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤' };
                
            } catch (error) {
                console.error('ì•¡ì„¸ìŠ¤ ì½”ë“œ í™•ì¸ ì˜¤ë¥˜:', error);
                
                // ì˜¤í”„ë¼ì¸ì´ê±°ë‚˜ ì‹œíŠ¸ ì ‘ê·¼ ë¶ˆê°€ ì‹œ - ë§ˆì§€ë§‰ ë¡œê·¸ì¸ ì •ë³´ í™•ì¸
                const lastLogin = localStorage.getItem('dhLoginData');
                if (lastLogin) {
                    try {
                        const data = JSON.parse(lastLogin);
                        if (data.code === code && data.pin === pin) {
                            return { 
                                success: true, 
                                name: data.name, 
                                team: data.team,
                                offline: true 
                            };
                        }
                    } catch (e) {}
                }
                
                return { 
                    success: false, 
                    message: 'ì„œë²„ ì—°ê²° ì‹¤íŒ¨. ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”.' 
                };
            }
        }
        
        // ë¡œê·¸ì¸ ì²˜ë¦¬
        async function handleLogin() {
            const codeInput = document.getElementById('accessCodeInput');
            const pinInput = document.getElementById('pinInput');
            const errorDiv = document.getElementById('loginError');
            const loginBtn = document.getElementById('loginBtn');
            const code = codeInput.value.trim();
            const pin = pinInput.value.trim();
            
            // ì…ë ¥ê°’ í™•ì¸
            if (!code) {
                errorDiv.textContent = 'ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”';
                errorDiv.classList.add('show');
                return;
            }
            
            if (!pin) {
                errorDiv.textContent = 'PINì„ ì…ë ¥í•˜ì„¸ìš”';
                errorDiv.classList.add('show');
                return;
            }
            
            if (pin.length !== 4) {
                errorDiv.textContent = 'PINì€ 4ìë¦¬ ìˆ«ìì…ë‹ˆë‹¤';
                errorDiv.classList.add('show');
                return;
            }
            
            // ë¡œë”© ìƒíƒœ
            loginBtn.disabled = true;
            loginBtn.textContent = 'í™•ì¸ ì¤‘...';
            errorDiv.classList.remove('show');
            
            // ì•¡ì„¸ìŠ¤ ì½”ë“œ ë° PIN í™•ì¸
            const result = await verifyAccessCode(code, pin);
            
            if (result.success) {
                // ë¡œê·¸ì¸ ì •ë³´ ì €ì¥
                const loginData = {
                    code: code,
                    pin: pin,
                    name: result.name,
                    team: result.team,
                    loginTime: new Date().getTime()
                };
                localStorage.setItem('dhLoginData', JSON.stringify(loginData));
                
                // ë¡œê·¸ì¸ ì„±ê³µ
                if (result.offline) {
                    showToast('âœ“ ì˜¤í”„ë¼ì¸ ëª¨ë“œë¡œ ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤', 'info');
                } else {
                    showToast('âœ“ ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                }
                
                hideLoginScreen();
                codeInput.value = '';
                pinInput.value = '';
                
            } else {
                // ë¡œê·¸ì¸ ì‹¤íŒ¨
                errorDiv.textContent = result.message;
                errorDiv.classList.add('show');
                loginBtn.disabled = false;
                loginBtn.textContent = 'ë¡œê·¸ì¸';
            }
        }
        
        // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
        function handleLogout() {
            if (confirm('ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                localStorage.removeItem('dhLoginData');
                showLoginScreen();
                showToast('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤', 'info');
            }
        }
        
        // Enter í‚¤ë¡œ ë¡œê·¸ì¸
        document.addEventListener('DOMContentLoaded', () => {
            const codeInput = document.getElementById('accessCodeInput');
            const pinInput = document.getElementById('pinInput');
            
            if (codeInput) {
                codeInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        pinInput.focus(); // PIN ì…ë ¥ í•„ë“œë¡œ ì´ë™
                    }
                });
            }
            
            if (pinInput) {
                pinInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        handleLogin();
                    }
                });
            }
            
            // í˜ì´ì§€ ë¡œë“œ ì‹œ ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
            checkLoginStatus();
        });
        // ==================== ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ë ====================

        // ==================== ë¹„í™œì„± ì‹œ ìë™ ë¡œê·¸ì•„ì›ƒ ====================
        async function checkEmployeeStatus() {
            const loginData = localStorage.getItem('dhLoginData');
            if (!loginData) return;
            
            try {
                const data = JSON.parse(loginData);
                
                // Google Sheetsì—ì„œ ì§ì› ìƒíƒœ í™•ì¸
                const response = await fetch(GOOGLE_SHEETS_CSV_URL);
                if (!response.ok) return;
                
                const csvText = await response.text();
                const rows = csvText.split('\n').slice(1); // í—¤ë” ì œì™¸
                
                // í˜„ì¬ ë¡œê·¸ì¸í•œ ì§ì› ì°¾ê¸°
                let isActive = false;
                for (const row of rows) {
                    const cols = row.split(',').map(col => col.trim().replace(/"/g, ''));
                    if (cols.length >= 5) {
                        const [accessCode, name, team, status, storedPin] = cols;
                        
                        // ì½”ë“œì™€ PINì´ ì¼ì¹˜í•˜ëŠ” ì§ì› ì°¾ê¸°
                        if (accessCode === data.code && storedPin === data.pin) {
                            if (status === 'í™œì„±') {
                                isActive = true;
                            }
                            break;
                        }
                    }
                }
                
                // ë¹„í™œì„± ìƒíƒœë©´ ê°•ì œ ë¡œê·¸ì•„ì›ƒ
                if (!isActive) {
                    localStorage.removeItem('dhLoginData');
                    showLoginScreen();
                    showToast('âš ï¸ ê³„ì •ì´ ë¹„í™œì„±í™”ë˜ì–´ ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤', 'warning');
                }
                
            } catch (error) {
                console.error('ì§ì› ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);
            }
        }
        
        // ì•± ì‹œì‘ ì‹œ & 30ì´ˆë§ˆë‹¤ ìƒíƒœ ì²´í¬
        document.addEventListener('DOMContentLoaded', () => {
            checkEmployeeStatus();
            setInterval(checkEmployeeStatus, 30000); // 30ì´ˆë§ˆë‹¤
        });
        // ==================== ë¹„í™œì„± ì‹œ ìë™ ë¡œê·¸ì•„ì›ƒ ë ====================

        // ==================== ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬ (í¬ë¡œìŠ¤ í”Œë«í¼ ì•ˆì •ì„±) ====================
        window.addEventListener('error', (event) => {
            console.error('ì „ì—­ ì˜¤ë¥˜:', event.error);
            
            // ì‚¬ìš©ìì—ê²Œ ì¹œì ˆí•œ ë©”ì‹œì§€ í‘œì‹œ
            if (event.error && event.error.message) {
                const errorMsg = event.error.message.toLowerCase();
                
                // ë©”ëª¨ë¦¬ ì˜¤ë¥˜ (iOSì—ì„œ í”í•¨)
                if (errorMsg.includes('memory') || errorMsg.includes('quota')) {
                    showToast('âš ï¸ ë©”ëª¨ë¦¬ ë¶€ì¡±. ì‚¬ì§„ì„ ì••ì¶•í•˜ì—¬ ì¬ì‹œë„í•©ë‹ˆë‹¤.', 'warning');
                }
                // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜
                else if (errorMsg.includes('network') || errorMsg.includes('fetch')) {
                    showToast('ğŸ“¶ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜. ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.', 'error');
                }
            }
            
            // ì—ëŸ¬ ë¡œê·¸ (ê°œë°œìš©)
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.log('ì—ëŸ¬ ìƒì„¸:', {
                    message: event.error?.message,
                    stack: event.error?.stack,
                    filename: event.filename,
                    lineno: event.lineno
                });
            }
        });
        
        // Promise rejection í•¸ë“¤ëŸ¬
        window.addEventListener('unhandledrejection', (event) => {
            console.error('ì²˜ë¦¬ë˜ì§€ ì•Šì€ Promise ê±°ë¶€:', event.reason);
            
            // ë„¤íŠ¸ì›Œí¬ ê´€ë ¨ ì—ëŸ¬ëŠ” ì¡°ìš©íˆ ì²˜ë¦¬
            if (event.reason && event.reason.message && 
                event.reason.message.includes('NetworkError')) {
                event.preventDefault();
                showToast('ğŸ“¶ ì¼ì‹œì ì¸ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ì…ë‹ˆë‹¤.', 'warning');
            }
        });
        
        // ==================== ë””ë°”ì´ìŠ¤ ë° ë¸Œë¼ìš°ì € ê°ì§€ ====================
        const deviceInfo = {
            isIOS: /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream,
            isAndroid: /Android/.test(navigator.userAgent),
            isSafari: /^((?!chrome|android).)*safari/i.test(navigator.userAgent),
            isChrome: /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor),
            isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),
            version: navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/) || []
        };
        
        // iOS ë²„ì „ í™•ì¸
        deviceInfo.iOSVersion = deviceInfo.isIOS && deviceInfo.version.length > 1 
            ? parseInt(deviceInfo.version[1]) 
            : 0;
        
        console.log('ë””ë°”ì´ìŠ¤ ì •ë³´:', deviceInfo);
        
        // ë””ë°”ì´ìŠ¤ë³„ ê²½ê³  í‘œì‹œ
        if (deviceInfo.isIOS && deviceInfo.iOSVersion < 13) {
            alert('âš ï¸ iOS 13 ì´ìƒ ê¶Œì¥\nì¼ë¶€ ê¸°ëŠ¥ì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
        }
        
        // ==================== ì˜¨ë¼ì¸/ì˜¤í”„ë¼ì¸ ìƒíƒœ ê´€ë¦¬ ====================
        let isOnline = navigator.onLine;
        let pendingSyncProjects = []; // ë™ê¸°í™” ëŒ€ê¸° í”„ë¡œì íŠ¸
        
        // Service WorkerëŠ” í™˜ê²½ ì œì•½ìœ¼ë¡œ ì œê±°
        // localStorageë¥¼ ì‚¬ìš©í•œ ë°ì´í„° ì €ì¥ìœ¼ë¡œ ëŒ€ì²´
        
        // ì˜¨ë¼ì¸/ì˜¤í”„ë¼ì¸ ìƒíƒœ ê°ì§€
        window.addEventListener('online', () => {
            isOnline = true;
            updateOnlineStatus();
            showToast('âœ… ì˜¨ë¼ì¸ ì—°ê²°ë¨', 'success');
            
            // ë™ê¸°í™” ëŒ€ê¸° ì¤‘ì¸ í”„ë¡œì íŠ¸ í™•ì¸
            loadPendingSyncProjects();
            if (pendingSyncProjects.length > 0) {
                setTimeout(() => {
                    if (confirm(`ë™ê¸°í™” ëŒ€ê¸° ì¤‘ì¸ í”„ë¡œì íŠ¸ê°€ ${pendingSyncProjects.length}ê±´ ìˆìŠµë‹ˆë‹¤.\nì§€ê¸ˆ ë“œë¼ì´ë¸Œì— ì—…ë¡œë“œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                        syncPendingProjects();
                    }
                }, 1000);
            }
        });
        
        window.addEventListener('offline', () => {
            isOnline = false;
            updateOnlineStatus();
            showToast('ğŸ“¶ ì˜¤í”„ë¼ì¸ ëª¨ë“œ - ì‘ì—… ë‚´ìš©ì€ ë¡œì»¬ì— ì €ì¥ë©ë‹ˆë‹¤', 'warning');
        });
        
        // ì˜¨ë¼ì¸ ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateOnlineStatus() {
            const statusIndicator = document.getElementById('onlineStatus');
            if (statusIndicator) {
                if (isOnline) {
                    statusIndicator.innerHTML = 'ğŸŸ¢ ì˜¨ë¼ì¸';
                    statusIndicator.style.color = '#10b981';
                } else {
                    statusIndicator.innerHTML = 'ğŸ”´ ì˜¤í”„ë¼ì¸';
                    statusIndicator.style.color = '#ef4444';
                }
            }
        }
        
        // localStorage ê¸°ë°˜ ë™ê¸°í™” ëŒ€ê¸° ê´€ë¦¬
        function loadPendingSyncProjects() {
            try {
                const saved = localStorage.getItem('pendingSyncProjects');
                if (saved) {
                    pendingSyncProjects = JSON.parse(saved);
                    updateSyncBadge();
                }
            } catch (error) {
                console.error('ë™ê¸°í™” ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
                pendingSyncProjects = [];
            }
        }
        
        function savePendingSyncProjects() {
            try {
                localStorage.setItem('pendingSyncProjects', JSON.stringify(pendingSyncProjects));
                updateSyncBadge();
            } catch (error) {
                console.error('ë™ê¸°í™” ëª©ë¡ ì €ì¥ ì‹¤íŒ¨:', error);
            }
        }
        
        function addToPendingSync(projectData) {
            projectData.syncTimestamp = Date.now();
            pendingSyncProjects.push(projectData);
            savePendingSyncProjects();
            
            // ë™ê¸°í™” ë²„íŠ¼ í‘œì‹œ
            const syncBtn = document.getElementById('syncBtn');
            if (syncBtn) syncBtn.style.display = 'block';
        }
        
        function removePendingSyncProject(index) {
            pendingSyncProjects.splice(index, 1);
            savePendingSyncProjects();
        }
        
        // ë™ê¸°í™” ë±ƒì§€ ì—…ë°ì´íŠ¸
        function updateSyncBadge() {
            const badge = document.getElementById('syncBadge');
            if (badge) {
                if (pendingSyncProjects.length > 0) {
                    badge.textContent = pendingSyncProjects.length;
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            }
        }
        
        // ëŒ€ê¸° ì¤‘ì¸ í”„ë¡œì íŠ¸ ë™ê¸°í™”
        window.syncPendingProjects = async function() {
            if (!isOnline) {
                showToast('âŒ ì¸í„°ë„· ì—°ê²°ì´ í•„ìš”í•©ë‹ˆë‹¤', 'error');
                return;
            }
            
            if (pendingSyncProjects.length === 0) {
                showToast('âœ… ë™ê¸°í™”í•  í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤', 'success');
                return;
            }
            
            showLoading('ë™ê¸°í™” ì¤‘...');
            
            let successCount = 0;
            let failCount = 0;
            
            for (let i = pendingSyncProjects.length - 1; i >= 0; i--) {
                try {
                    const project = pendingSyncProjects[i];
                    await uploadProjectToDrive(project);
                    removePendingSyncProject(i);
                    successCount++;
                } catch (error) {
                    console.error('ë™ê¸°í™” ì‹¤íŒ¨:', error);
                    failCount++;
                }
            }
            
            hideLoading();
            
            if (failCount === 0) {
                showToast(`âœ… ëª¨ë“  í”„ë¡œì íŠ¸(${successCount}ê±´)ê°€ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤`, 'success');
            } else {
                showToast(`âš ï¸ ${successCount}ê±´ ì„±ê³µ, ${failCount}ê±´ ì‹¤íŒ¨`, 'warning');
            }
            
            // ë™ê¸°í™” ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            if (pendingSyncProjects.length === 0) {
                const syncBtn = document.getElementById('syncBtn');
                if (syncBtn) syncBtn.style.display = 'none';
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', () => {
            loadPendingSyncProjects();
            updateOnlineStatus();
        });
        
        // ==================== Google ë¡œê·¸ì¸ ë¹„í™œì„±í™” (ë³´ì•ˆ) ====================
        // âš ï¸ API í‚¤ê°€ GitHubì— ë…¸ì¶œë˜ì–´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤
        // ë‹¤ì‹œ ì‚¬ìš©í•˜ë ¤ë©´ ìƒˆë¡œìš´ Client IDë¥¼ ë°œê¸‰ë°›ì•„ ì„¤ì •í•˜ì„¸ìš”
        
        let GOOGLE_CLIENT_ID = localStorage.getItem('google_client_id') || '';
        const REDIRECT_URI = window.location.origin + window.location.pathname;
        const SCOPES = 'https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/spreadsheets';
        
        let accessToken = null;
        let currentUser = null;
        
        const GOOGLE_DRIVE_DISABLED = true; // Google Drive ê¸°ëŠ¥ ë¹„í™œì„±í™”
        
        // ì„¤ì • ì €ì¥
        function saveGoogleClientId(clientId) {
            GOOGLE_CLIENT_ID = clientId;
            localStorage.setItem('google_client_id', clientId);
            showToast('âœ… Client ID ì €ì¥ ì™„ë£Œ');
        }
        
        // Client ID ì„¤ì • í† ê¸€
        window.toggleClientIdSetup = function() {
            const setup = document.getElementById('clientIdSetup');
            if (setup.style.display === 'none') {
                setup.style.display = 'block';
                document.getElementById('clientIdInput').value = GOOGLE_CLIENT_ID;
            } else {
                setup.style.display = 'none';
            }
        }
        
        // Client ID ì €ì¥
        window.saveClientId = function() {
            const clientId = document.getElementById('clientIdInput').value.trim();
            if (!clientId) {
                showToast('âŒ Client IDë¥¼ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }
            
            if (!clientId.includes('.apps.googleusercontent.com')) {
                showToast('âŒ ì˜¬ë°”ë¥¸ Client ID í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤');
                return;
            }
            
            saveGoogleClientId(clientId);
            toggleClientIdSetup();
        }
        
        // Google Drive ì¹´ë“œ í† ê¸€
        window.toggleGoogleDrive = function() {
            const card = document.getElementById('googleDriveCard');
            if (card.style.display === 'none') {
                card.style.display = 'block';
                showToast('ğŸ’¡ íŒ€ ê³µìœ ê°€ í•„ìš”í•˜ë©´ Client IDë¥¼ ì„¤ì •í•˜ì„¸ìš”');
            } else {
                card.style.display = 'none';
            }
        }

        // ==================== í”„ë¡œì íŠ¸ ëª©ë¡ ê´€ë¦¬ ====================
        let projects = []; // ëª¨ë“  í”„ë¡œì íŠ¸ ëª©ë¡
        let currentProjectId = null; // í˜„ì¬ ì‘ì—… ì¤‘ì¸ í”„ë¡œì íŠ¸ ID

        // í”„ë¡œì íŠ¸ í…œí”Œë¦¿
        function createNewProject() {
            return {
                id: Date.now(),
                apartmentName: '',
                dong: '',
                ho: '',
                inspectionDate: new Date().toISOString().split('T')[0],
                customerName: '',
                customerPhone: '',
                author: '', // âœ… ì ê²€ ì‘ì„±ì ì¶”ê°€
                floorplan: null,
                defects: [],
                equipment: [],
                airQuality: [],
                createdAt: new Date().toISOString(),
                isUploaded: false,
                // âœ… í”„ë¡œì íŠ¸ë³„ ID ì¹´ìš´í„° ì¶”ê°€
                lastDefectId: 0,
                lastEquipmentId: 0,
                lastAirQualityId: 0
            };
        }

        // í˜„ì¬ í”„ë¡œì íŠ¸ ê°€ì ¸ì˜¤ê¸°
        function getCurrentProject() {
            if (projects.length === 0) {
                const newProject = createNewProject();
                projects.push(newProject);
                currentProjectId = newProject.id;
            }
            return projects.find(p => p.id === currentProjectId) || projects[0];
        }

        // âœ… projectDataë¥¼ Proxyë¡œ ë³€ê²½ - í•­ìƒ í˜„ì¬ í”„ë¡œì íŠ¸ë¥¼ ì°¸ì¡°
        const projectData = new Proxy({}, {
            get(target, prop) {
                const project = getCurrentProject();
                return project[prop];
            },
            set(target, prop, value) {
                const project = getCurrentProject();
                project[prop] = value;
                return true;
            }
        });

        // âœ… ID ì¹´ìš´í„°ë¥¼ í”„ë¡œì íŠ¸ë³„ë¡œ ê´€ë¦¬í•˜ë„ë¡ ë³€ê²½
        // ì´ì œ ê° í”„ë¡œì íŠ¸ê°€ ë…ë¦½ì ì¸ ID ì²´ê³„ë¥¼ ê°€ì§
        // let defectIdCounter = 1; // ì œê±°ë¨
        // let equipmentIdCounter = 1; // ì œê±°ë¨  
        // let airQualityIdCounter = 1; // ì œê±°ë¨
        let cameraStream = null;
        let currentPhotoTarget = null;

        // ==================== Google API ì´ˆê¸°í™” ====================
        function gapiLoaded() {
            gapi.load('client', initializeGapiClient);
        }

        // ==================== OAuth2 íŒì—… ë¡œê·¸ì¸ ====================
        window.handleGoogleSignIn = async function() {
            // Client ID í™•ì¸
            if (!GOOGLE_CLIENT_ID) {
                showToast('âŒ Client IDë¥¼ ë¨¼ì € ì„¤ì •í•˜ì„¸ìš” (âš™ï¸ ë²„íŠ¼)');
                toggleClientIdSetup();
                return;
            }
            
            console.log('ğŸ”µ OAuth2 íŒì—… ë¡œê·¸ì¸ ì‹œì‘...');
            
            const authUrl = 'https://accounts.google.com/o/oauth2/v2/auth?' + new URLSearchParams({
                client_id: GOOGLE_CLIENT_ID,
                redirect_uri: REDIRECT_URI,
                response_type: 'token',
                scope: SCOPES,
                prompt: 'consent'
            });
            
            // íŒì—…ìœ¼ë¡œ ë¡œê·¸ì¸
            const width = 500;
            const height = 600;
            const left = (screen.width - width) / 2;
            const top = (screen.height - height) / 2;
            
            const popup = window.open(
                authUrl,
                'Google Login',
                `width=${width},height=${height},left=${left},top=${top}`
            );
            
            if (!popup) {
                showToast('âŒ íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤');
                return;
            }
        }
        
        // ë©”ì‹œì§€ ìˆ˜ì‹  (íŒì—…ì—ì„œ í† í° ì „ë‹¬)
        window.addEventListener('message', async (event) => {
            if (event.origin !== window.location.origin) return;
            
            if (event.data.type === 'GOOGLE_AUTH') {
                const token = event.data.accessToken;
                if (token) {
                    accessToken = token;
                    localStorage.setItem('google_access_token', accessToken);
                    console.log('âœ… í† í° ì €ì¥ ì™„ë£Œ');
                    
                    // ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                    try {
                        const response = await fetch('https://www.googleapis.com/oauth2/v1/userinfo?access_token=' + accessToken);
                        if (!response.ok) throw new Error('Failed');
                        
                        currentUser = await response.json();
                        console.log('âœ… ë¡œê·¸ì¸ ì„±ê³µ:', currentUser.email);
                        
                        updateSignInStatus(true);
                        showToast('âœ… ' + currentUser.email + ' ë¡œê·¸ì¸ ì„±ê³µ!');
                        
                    } catch (error) {
                        console.error('âŒ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
                        showToast('âŒ ë¡œê·¸ì¸ ì˜¤ë¥˜');
                        accessToken = null;
                        localStorage.removeItem('google_access_token');
                    }
                }
            }
        });
        
        // URLì—ì„œ í† í° ì¶”ì¶œ (ë¦¬ë‹¤ì´ë ‰íŠ¸ ì½œë°±)
        function checkUrlForToken() {
            const hash = window.location.hash.substring(1);
            const params = new URLSearchParams(hash);
            const token = params.get('access_token');
            
            if (token && window.opener) {
                // ë¶€ëª¨ ì°½ìœ¼ë¡œ í† í° ì „ë‹¬
                window.opener.postMessage({
                    type: 'GOOGLE_AUTH',
                    accessToken: token
                }, window.location.origin);
                window.close();
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ í† í° ì²´í¬
        checkUrlForToken();
        
        // ì €ì¥ëœ í† í°ìœ¼ë¡œ ìë™ ë¡œê·¸ì¸
        async function checkIfSignedIn() {
            const token = localStorage.getItem('google_access_token');
            if (token) {
                accessToken = token;
                
                try {
                    const response = await fetch('https://www.googleapis.com/oauth2/v1/userinfo?access_token=' + accessToken);
                    if (!response.ok) throw new Error('Token expired');
                    
                    currentUser = await response.json();
                    updateSignInStatus(true);
                    console.log('âœ… ìë™ ë¡œê·¸ì¸:', currentUser.email);
                } catch (error) {
                    console.log('âŒ í† í° ë§Œë£Œ');
                    accessToken = null;
                    localStorage.removeItem('google_access_token');
                }
            }
        }

        window.handleGoogleSignOut = function() {
            if (accessToken) {
                // Google OAuth2 í† í° í•´ì§€
                fetch('https://accounts.google.com/o/oauth2/revoke?token=' + accessToken);
                
                accessToken = null;
                currentUser = null;
                localStorage.removeItem('google_access_token');
                updateSignInStatus(false);
                showToast('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤');
            }
        }

        function updateSignInStatus(isSignedIn) {
            try {
                if (isSignedIn) {
                    const notSignedIn = document.getElementById('notSignedIn');
                    const signedIn = document.getElementById('signedIn');
                    const userEmail = document.getElementById('userEmail');
                    const signInBtn = document.getElementById('signInBtn');
                    const signOutBtn = document.getElementById('signOutBtn');
                    const cloudActionsCard = document.getElementById('cloudActionsCard');
                    
                    if (notSignedIn) notSignedIn.style.display = 'none';
                    if (signedIn) signedIn.style.display = 'block';
                    if (userEmail) userEmail.textContent = currentUser?.email || 'ì‚¬ìš©ì';
                    if (signInBtn) signInBtn.style.display = 'none';
                    if (signOutBtn) signOutBtn.style.display = 'block';
                    if (cloudActionsCard) cloudActionsCard.style.display = 'block';
                } else {
                    const notSignedIn = document.getElementById('notSignedIn');
                    const signedIn = document.getElementById('signedIn');
                    const signInBtn = document.getElementById('signInBtn');
                    const signOutBtn = document.getElementById('signOutBtn');
                    const cloudActionsCard = document.getElementById('cloudActionsCard');
                    
                    if (notSignedIn) notSignedIn.style.display = 'block';
                    if (signedIn) signedIn.style.display = 'none';
                    if (signInBtn) signInBtn.style.display = 'block';
                    if (signOutBtn) signOutBtn.style.display = 'none';
                    if (cloudActionsCard) cloudActionsCard.style.display = 'none';
                }
                console.log('âœ… UI ì—…ë°ì´íŠ¸ ì™„ë£Œ:', isSignedIn ? 'ë¡œê·¸ì¸' : 'ë¡œê·¸ì•„ì›ƒ');
            } catch (e) {
                console.error('UI ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', e);
            }
        }

        // ==================== Drive í´ë” ê´€ë¦¬ ====================
        async function getOrCreateAppFolder() {
            try {
                // "ë”í™ˆì ê²€" í´ë” ì°¾ê¸°
                const response = await gapi.client.drive.files.list({
                    q: "name='ë”í™ˆì ê²€' and mimeType='application/vnd.google-apps.folder' and trashed=false",
                    fields: 'files(id, name)',
                    spaces: 'drive'
                });

                if (response.result.files && response.result.files.length > 0) {
                    return response.result.files[0].id;
                }

                // í´ë”ê°€ ì—†ìœ¼ë©´ ìƒì„±
                const folderMetadata = {
                    name: 'ë”í™ˆì ê²€',
                    mimeType: 'application/vnd.google-apps.folder'
                };

                const folder = await gapi.client.drive.files.create({
                    resource: folderMetadata,
                    fields: 'id'
                });

                return folder.result.id;
            } catch (error) {
                console.error('í´ë” ìƒì„±/ì°¾ê¸° ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // ==================== Drive ì €ì¥ ====================
        

        // ==================== Drive ë¶ˆëŸ¬ì˜¤ê¸° ====================
                async function createProjectFolder(appFolderId, projectName) {
            try {
                const folderMetadata = {
                    name: projectName,
                    mimeType: 'application/vnd.google-apps.folder',
                    parents: [appFolderId]
                };

                const folder = await gapi.client.drive.files.create({
                    resource: folderMetadata,
                    fields: 'id, name'
                });

                return folder.result.id;
            } catch (error) {
                console.error('í”„ë¡œì íŠ¸ í´ë” ìƒì„± ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // í•˜ìì‚¬ì§„ í´ë” ìƒì„±

        async function createPhotosFolder(projectFolderId) {
            try {
                const folderMetadata = {
                    name: 'í•˜ìì‚¬ì§„',
                    mimeType: 'application/vnd.google-apps.folder',
                    parents: [projectFolderId]
                };

                const folder = await gapi.client.drive.files.create({
                    resource: folderMetadata,
                    fields: 'id'
                });

                return folder.result.id;
            } catch (error) {
                console.error('ì‚¬ì§„ í´ë” ìƒì„± ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // Base64 ì´ë¯¸ì§€ë¥¼ Blobìœ¼ë¡œ ë³€í™˜

        function base64ToBlob(base64, mimeType) {
            const byteString = atob(base64.split(',')[1]);
            const ab = new ArrayBuffer(byteString.length);
            const ia = new Uint8Array(ab);
            for (let i = 0; i < byteString.length; i++) {
                ia[i] = byteString.charCodeAt(i);
            }
            return new Blob([ab], { type: mimeType });
        }

        async function uploadPhoto(photosFolderId, photoData, fileName) {
            try {
                const blob = base64ToBlob(photoData, 'image/jpeg');
                
                const form = new FormData();
                form.append('metadata', new Blob([JSON.stringify({
                    name: fileName,
                    mimeType: 'image/jpeg',
                    parents: [photosFolderId]
                })], { type: 'application/json' }));
                form.append('file', blob);

                const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + accessToken
                    },
                    body: form
                });

                if (!response.ok) {
                    throw new Error('ì‚¬ì§„ ì—…ë¡œë“œ ì‹¤íŒ¨');
                }

                const result = await response.json();
                return result.id;
            } catch (error) {
                console.error('ì‚¬ì§„ ì—…ë¡œë“œ ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // Google Sheets ìƒì„± (í•˜ì ë¦¬ìŠ¤íŠ¸)

        async function createDefectSpreadsheet(projectFolderId, projectName, defects) {
            try {
                // ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ìƒì„±
                const spreadsheetBody = {
                    properties: {
                        title: `${projectName}_í•˜ìì ê²€_ë¦¬ìŠ¤íŠ¸`
                    },
                    sheets: [{
                        properties: {
                            title: 'í•˜ìëª©ë¡'
                        }
                    }]
                };

                const createResponse = await gapi.client.sheets.spreadsheets.create({
                    resource: spreadsheetBody
                });

                const spreadsheetId = createResponse.result.spreadsheetId;

                // ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ í”„ë¡œì íŠ¸ í´ë”ë¡œ ì´ë™
                await gapi.client.drive.files.update({
                    fileId: spreadsheetId,
                    addParents: projectFolderId,
                    fields: 'id, parents'
                });

                // ë°ì´í„° ì…ë ¥ ì¤€ë¹„
                const headers = [['No', 'ê³µê°„', 'ìœ„ì¹˜', 'í•˜ìì¢…ë¥˜', 'ìƒì„¸ì„¤ëª…']];
                const rows = defects.map((defect, index) => {
                    // ìƒì„¸ì„¤ëª…ë§Œ ì‚¬ìš© (ì´ë¯¸ ëª¨ë“  ì •ë³´ í¬í•¨)
                    const description = defect.description || '';
                    
                    return [
                        index + 1,
                        defect.spaces.join(', '),
                        defect.locations.join(', '),
                        defect.types.join(', '),
                        description || '-'
                    ];
                });

                const allData = [...headers, ...rows];

                // ë°ì´í„° ì…ë ¥
                await gapi.client.sheets.spreadsheets.values.update({
                    spreadsheetId: spreadsheetId,
                    range: 'A1',
                    valueInputOption: 'RAW',
                    resource: {
                        values: allData
                    }
                });

                // í—¤ë” ìŠ¤íƒ€ì¼ ì ìš©
                await gapi.client.sheets.spreadsheets.batchUpdate({
                    spreadsheetId: spreadsheetId,
                    resource: {
                        requests: [
                            // í—¤ë” ë°°ê²½ìƒ‰ ë° ê¸€ììƒ‰
                            {
                                repeatCell: {
                                    range: {
                                        sheetId: 0,
                                        startRowIndex: 0,
                                        endRowIndex: 1
                                    },
                                    cell: {
                                        userEnteredFormat: {
                                            backgroundColor: {
                                                red: 0.06,
                                                green: 0.73,
                                                blue: 0.51
                                            },
                                            textFormat: {
                                                foregroundColor: {
                                                    red: 1,
                                                    green: 1,
                                                    blue: 1
                                                },
                                                bold: true
                                            }
                                        }
                                    },
                                    fields: 'userEnteredFormat(backgroundColor,textFormat)'
                                }
                            },
                            // ì»¬ëŸ¼ ë„ˆë¹„ ì¡°ì •
                            {
                                updateDimensionProperties: {
                                    range: {
                                        sheetId: 0,
                                        dimension: 'COLUMNS',
                                        startIndex: 0,
                                        endIndex: 1
                                    },
                                    properties: {
                                        pixelSize: 50
                                    },
                                    fields: 'pixelSize'
                                }
                            },
                            {
                                updateDimensionProperties: {
                                    range: {
                                        sheetId: 0,
                                        dimension: 'COLUMNS',
                                        startIndex: 1,
                                        endIndex: 2
                                    },
                                    properties: {
                                        pixelSize: 100
                                    },
                                    fields: 'pixelSize'
                                }
                            },
                            {
                                updateDimensionProperties: {
                                    range: {
                                        sheetId: 0,
                                        dimension: 'COLUMNS',
                                        startIndex: 2,
                                        endIndex: 3
                                    },
                                    properties: {
                                        pixelSize: 150
                                    },
                                    fields: 'pixelSize'
                                }
                            },
                            {
                                updateDimensionProperties: {
                                    range: {
                                        sheetId: 0,
                                        dimension: 'COLUMNS',
                                        startIndex: 3,
                                        endIndex: 4
                                    },
                                    properties: {
                                        pixelSize: 150
                                    },
                                    fields: 'pixelSize'
                                }
                            },
                            {
                                updateDimensionProperties: {
                                    range: {
                                        sheetId: 0,
                                        dimension: 'COLUMNS',
                                        startIndex: 4,
                                        endIndex: 5
                                    },
                                    properties: {
                                        pixelSize: 300
                                    },
                                    fields: 'pixelSize'
                                }
                            }
                        ]
                    }
                });

                return spreadsheetId;
            } catch (error) {
                console.error('ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // í”„ë¡œì íŠ¸ ì •ë³´ JSON ì—…ë¡œë“œ

        async function uploadProjectInfo(projectFolderId, projectData) {
            try {
                const projectInfo = {
                    apartmentName: projectData.apartmentName,
                    dong: projectData.dong,
                    ho: projectData.ho,
                    inspectionDate: projectData.inspectionDate,
                    customerName: projectData.customerName,
                    customerPhone: projectData.customerPhone,
                    uploadedAt: new Date().toISOString(),
                    uploadedBy: currentUser?.email
                };

                const blob = new Blob([JSON.stringify(projectInfo, null, 2)], { type: 'application/json' });

                const form = new FormData();
                form.append('metadata', new Blob([JSON.stringify({
                    name: 'í”„ë¡œì íŠ¸_ì •ë³´.json',
                    mimeType: 'application/json',
                    parents: [projectFolderId]
                })], { type: 'application/json' }));
                form.append('file', blob);

                const response = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + accessToken
                    },
                    body: form
                });

                if (!response.ok) {
                    throw new Error('í”„ë¡œì íŠ¸ ì •ë³´ ì—…ë¡œë“œ ì‹¤íŒ¨');
                }

                return true;
            } catch (error) {
                console.error('í”„ë¡œì íŠ¸ ì •ë³´ ì—…ë¡œë“œ ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // ë©”ì¸ ì—…ë¡œë“œ í•¨ìˆ˜

        window.uploadProjectToDrive = async function(projectToUpload = null) {
            // projectToUploadê°€ ìˆìœ¼ë©´ ê·¸ê²ƒ ì‚¬ìš© (ë™ê¸°í™”ìš©), ì—†ìœ¼ë©´ í˜„ì¬ í”„ë¡œì íŠ¸
            const project = projectToUpload || getCurrentProject();
            
            // ì˜¤í”„ë¼ì¸ ì²´í¬
            if (!isOnline) {
                // ì˜¤í”„ë¼ì¸ì¼ ë•Œ ë¡œì»¬ ì €ì¥
                try {
                    addToPendingSync(project);
                    showToast('ğŸ“¶ ì˜¤í”„ë¼ì¸ - í”„ë¡œì íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜¨ë¼ì¸ ì—°ê²° ì‹œ ë™ê¸°í™”í•˜ì„¸ìš”.', 'warning');
                    return;
                } catch (error) {
                    alert('ë¡œì»¬ ì €ì¥ ì‹¤íŒ¨: ' + error.message);
                    return;
                }
            }
            
            if (!accessToken) {
                alert('ë¨¼ì € Google ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”');
                return;
            }

            // í•„ìˆ˜ ì •ë³´ í™•ì¸
            if (!project.apartmentName || !project.dong || !project.ho) {
                alert('í”„ë¡œì íŠ¸ ì •ë³´(ì•„íŒŒíŠ¸ëª…, ë™, í˜¸)ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }

            if (project.defects.length === 0) {
                alert('ìµœì†Œ 1ê°œ ì´ìƒì˜ í•˜ìë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”');
                return;
            }

            // projectToUploadê°€ ìˆìœ¼ë©´ ë™ê¸°í™” ì¤‘ì´ë¯€ë¡œ confirm ìŠ¤í‚µ
            if (!projectToUpload && !confirm(`"${project.apartmentName} ${project.dong} ${project.ho}"ë¥¼ Google Driveì— ì—…ë¡œë“œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }

            showLoading();

            try {
                // 1. ì•± ë£¨íŠ¸ í´ë” ê°€ì ¸ì˜¤ê¸°/ìƒì„±
                const appFolderId = await getOrCreateAppFolder();
                
                // 2. í”„ë¡œì íŠ¸ í´ë” ìƒì„±
                const projectName = `${project.inspectionDate}_${project.apartmentName}_${project.dong}_${project.ho}`;
                const projectFolderId = await createProjectFolder(appFolderId, projectName);
                
                // 3. í•˜ìì‚¬ì§„ í´ë” ìƒì„±
                const photosFolderId = await createPhotosFolder(projectFolderId);
                
                // 4. ì‚¬ì§„ ì—…ë¡œë“œ (ì°ì€ ìˆœì„œëŒ€ë¡œ 1.jpg, 2.jpg...)
                let photoIndex = 1;
                const totalPhotos = project.defects.reduce((sum, defect) => {
                    if (!defect.photos) return sum;
                    return sum + defect.photos.filter(p => p !== null).length;
                }, 0);
                
                for (const defect of project.defects) {
                    if (defect.photos && defect.photos.length > 0) {
                        for (const photo of defect.photos) {
                            if (photo !== null) {
                                await uploadPhoto(photosFolderId, photo, `${photoIndex}.jpg`);
                                photoIndex++;
                            }
                        }
                    }
                }
                
                // 5. í•˜ì ë¦¬ìŠ¤íŠ¸ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ìƒì„±
                await createDefectSpreadsheet(projectFolderId, projectName, project.defects);
                
                // 6. í”„ë¡œì íŠ¸ ì •ë³´ JSON ì—…ë¡œë“œ
                await uploadProjectInfo(projectFolderId, project);
                
                // 7. í”„ë¡œì íŠ¸ ìƒíƒœ ì—…ë°ì´íŠ¸
                project.isUploaded = true;
                project.uploadedAt = new Date().toISOString();
                project.driveFolderId = projectFolderId;
                
                // 8. ë¡œì»¬ ì €ì¥
                saveProjectsToLocalStorage();
                renderProjectList();
                
                hideLoading();
                showToast(`âœ… ì—…ë¡œë“œ ì™„ë£Œ! (ì‚¬ì§„ ${totalPhotos}ì¥)`);
                
                // ë™ê¸°í™” ì¤‘ì´ ì•„ë‹ ë•Œë§Œ alert í‘œì‹œ
                if (!projectToUpload) {
                    alert(`âœ… ì—…ë¡œë“œ ì™„ë£Œ!\n\ní”„ë¡œì íŠ¸: ${projectName}\nì‚¬ì§„: ${totalPhotos}ì¥\ní•˜ì: ${project.defects.length}ê°œ\n\nGoogle Driveì—ì„œ í™•ì¸í•˜ì„¸ìš”!`);
                }
                
            } catch (error) {
                console.error('ì—…ë¡œë“œ ì˜¤ë¥˜:', error);
                hideLoading();
                alert('ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n' + error.message);
            }
        }

        // ==================== Drive ë¶ˆëŸ¬ì˜¤ê¸° (ì‚­ì œ ì˜ˆì •) ====================


        window.loadFromDrive = async function() {
            if (!accessToken) {
                alert('ë¨¼ì € Google ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”');
                return;
            }

            if (!projectData.apartmentName || !projectData.dong || !projectData.ho) {
                alert('ë¶ˆëŸ¬ì˜¬ í”„ë¡œì íŠ¸ ì •ë³´(ì•„íŒŒíŠ¸ëª…, ë™, í˜¸)ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }

            showLoading();

            try {
                const folderId = await getOrCreateAppFolder();
                const fileName = `${projectData.apartmentName}_${projectData.dong}ë™_${projectData.ho}í˜¸.json`;

                // íŒŒì¼ ê²€ìƒ‰
                const response = await gapi.client.drive.files.list({
                    q: `name='${fileName}' and '${folderId}' in parents and trashed=false`,
                    fields: 'files(id, name)',
                    spaces: 'drive'
                });

                if (!response.result.files || response.result.files.length === 0) {
                    hideLoading();
                    alert('í•´ë‹¹ í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }

                const fileId = response.result.files[0].id;

                // íŒŒì¼ ë‚´ìš© ë‹¤ìš´ë¡œë“œ
                const fileResponse = await fetch(`https://www.googleapis.com/drive/v3/files/${fileId}?alt=media`, {
                    headers: {
                        'Authorization': 'Bearer ' + accessToken
                    }
                });

                if (!fileResponse.ok) {
                    throw new Error('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨');
                }

                const data = await fileResponse.json();

                // í˜„ì¬ í”„ë¡œì íŠ¸ì— ë°ì´í„° ë¡œë“œ
                const project = getCurrentProject();
                project.apartmentName = data.apartmentName || '';
                project.dong = data.dong || '';
                project.ho = data.ho || '';
                project.inspectionDate = data.inspectionDate || '';
                project.customerName = data.customerName || '';
                project.customerPhone = data.customerPhone || '';
                project.author = data.author || ''; // âœ… ì‘ì„±ì ì¶”ê°€
                project.floorplan = data.floorplan || null;
                project.defects = data.defects || [];
                project.equipment = data.equipment || [];
                project.airQuality = data.airQuality || [];

                // ID ì¹´ìš´í„° ì—…ë°ì´íŠ¸
                if (project.defects.length > 0) {
                    defectIdCounter = Math.max(...project.defects.map(d => d.id)) + 1;
                }
                if (project.equipment && project.equipment.length > 0) {
                    equipmentIdCounter = Math.max(...project.equipment.map(e => e.id)) + 1;
                }
                if (project.airQuality.length > 0) {
                    airQualityIdCounter = Math.max(...project.airQuality.map(a => a.id)) + 1;
                }

                // UI ì—…ë°ì´íŠ¸
                renderAll();
                saveProjectsToLocalStorage();

                hideLoading();
                showToast('âœ… Driveì—ì„œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!');
            } catch (error) {
                console.error('Drive ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
                hideLoading();
                alert('ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ==================== Drive í”„ë¡œì íŠ¸ ëª©ë¡ ====================
        window.showDriveProjects = async function() {
            if (!accessToken) {
                alert('ë¨¼ì € Google ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”');
                return;
            }

            showLoading();

            try {
                const folderId = await getOrCreateAppFolder();

                // í´ë” ë‚´ ëª¨ë“  JSON íŒŒì¼ ê²€ìƒ‰
                const response = await gapi.client.drive.files.list({
                    q: `'${folderId}' in parents and mimeType='application/json' and trashed=false`,
                    fields: 'files(id, name, modifiedTime)',
                    orderBy: 'modifiedTime desc',
                    spaces: 'drive'
                });

                const files = response.result.files || [];

                hideLoading();

                if (files.length === 0) {
                    alert('ì €ì¥ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }

                // ëª¨ë‹¬ì— ëª©ë¡ í‘œì‹œ
                const listContainer = document.getElementById('driveProjectsList');
                listContainer.innerHTML = files.map(file => `
                    <div style="background: var(--card-bg); border: 1px solid var(--border); border-radius: 8px; padding: 15px; margin-bottom: 10px; cursor: pointer; transition: all 0.3s;" 
                         onclick="loadDriveProjectById('${file.id}')"
                         onmouseover="this.style.background='rgba(16, 185, 129, 0.1)'"
                         onmouseout="this.style.background='var(--card-bg)'">
                        <div style="font-weight: bold; margin-bottom: 5px;">ğŸ“„ ${file.name.replace('.json', '')}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">
                            ë§ˆì§€ë§‰ ìˆ˜ì •: ${new Date(file.modifiedTime).toLocaleString('ko-KR')}
                        </div>
                    </div>
                `).join('');

                document.getElementById('driveProjectsModal').style.display = 'block';
            } catch (error) {
                console.error('í”„ë¡œì íŠ¸ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
                hideLoading();
                alert('ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        window.loadDriveProjectById = async function(fileId) {
            showLoading();
            closeDriveProjectsModal();

            try {
                // íŒŒì¼ ë‚´ìš© ë‹¤ìš´ë¡œë“œ
                const response = await fetch(`https://www.googleapis.com/drive/v3/files/${fileId}?alt=media`, {
                    headers: {
                        'Authorization': 'Bearer ' + accessToken
                    }
                });

                if (!response.ok) {
                    throw new Error('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨');
                }

                const data = await response.json();

                // í˜„ì¬ í”„ë¡œì íŠ¸ì— ë°ì´í„° ë¡œë“œ
                const project = getCurrentProject();
                project.apartmentName = data.apartmentName || '';
                project.dong = data.dong || '';
                project.ho = data.ho || '';
                project.inspectionDate = data.inspectionDate || '';
                project.customerName = data.customerName || '';
                project.customerPhone = data.customerPhone || '';
                project.author = data.author || ''; // âœ… ì‘ì„±ì ì¶”ê°€
                project.floorplan = data.floorplan || null;
                project.defects = data.defects || [];
                project.equipment = data.equipment || [];
                project.airQuality = data.airQuality || [];

                // ID ì¹´ìš´í„° ì—…ë°ì´íŠ¸
                if (project.defects.length > 0) {
                    defectIdCounter = Math.max(...project.defects.map(d => d.id)) + 1;
                }
                if (project.equipment && project.equipment.length > 0) {
                    equipmentIdCounter = Math.max(...project.equipment.map(e => e.id)) + 1;
                }
                if (project.airQuality.length > 0) {
                    airQualityIdCounter = Math.max(...project.airQuality.map(a => a.id)) + 1;
                }

                // UI ì—…ë°ì´íŠ¸
                renderAll();
                saveProjectsToLocalStorage();

                hideLoading();
                showToast('âœ… í”„ë¡œì íŠ¸ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!');
            } catch (error) {
                console.error('í”„ë¡œì íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
                hideLoading();
                alert('ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        window.closeDriveProjectsModal = function() {
            document.getElementById('driveProjectsModal').style.display = 'none';
        }

        // ==================== í”„ë¡œì íŠ¸ ëª©ë¡ ê´€ë¦¬ í•¨ìˆ˜ ====================
        
        // í”„ë¡œì íŠ¸ ëª©ë¡ ë Œë”ë§
        function renderProjectList() {
            const listContainer = document.getElementById('projectList');
            
            if (projects.length === 0) {
                listContainer.innerHTML = '<div style="text-align: center; padding: 20px; opacity: 0.7;">í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤. "ìƒˆ í”„ë¡œì íŠ¸"ë¥¼ ì¶”ê°€í•˜ì„¸ìš”.</div>';
                return;
            }

            listContainer.innerHTML = projects.map((project, index) => {
                const isActive = project.id === currentProjectId;
                const projectName = project.apartmentName && project.dong && project.ho 
                    ? `${project.apartmentName} ${project.dong} ${project.ho}`
                    : `í”„ë¡œì íŠ¸ ${index + 1} (ì •ë³´ ë¯¸ì…ë ¥)`;
                
                const uploadStatus = project.isUploaded 
                    ? '<span style="color: #10b981;">âœ… ì—…ë¡œë“œ ì™„ë£Œ</span>' 
                    : '<span style="color: #fbbf24;">â³ ì‘ì—…ì¤‘</span>';
                
                const authorInfo = project.author 
                    ? `ì‘ì„±ì: ${project.author} | ` 
                    : ''; // âœ… ì‘ì„±ì ì •ë³´ ì¶”ê°€

                return `
                    <div onclick="switchProject(${project.id})" 
                         style="background: ${isActive ? 'rgba(255,255,255,0.3)' : 'rgba(255,255,255,0.1)'}; 
                                padding: 12px; 
                                border-radius: 6px; 
                                margin-bottom: 8px; 
                                cursor: pointer;
                                border: ${isActive ? '2px solid white' : '2px solid transparent'};
                                transition: all 0.3s;"
                         onmouseover="if(!${isActive}) this.style.background='rgba(255,255,255,0.2)'"
                         onmouseout="if(!${isActive}) this.style.background='rgba(255,255,255,0.1)'">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="flex: 1;">
                                <div style="font-weight: bold; margin-bottom: 4px;">
                                    ${isActive ? 'â–¶ ' : ''}${projectName}
                                </div>
                                <div style="font-size: 11px; opacity: 0.8;">
                                    ${authorInfo}í•˜ì: ${project.defects.length}ê°œ | 
                                    ì¥ë¹„: ${project.equipment ? project.equipment.length : 0}ê°œ | 
                                    ê³µê¸°ì§ˆ: ${project.airQuality.length}ê°œ
                                </div>
                            </div>
                            <div style="font-size: 12px;">
                                ${uploadStatus}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ìƒˆ í”„ë¡œì íŠ¸ ì¶”ê°€
        window.addNewProject = function() {
            const newProject = createNewProject();
            projects.push(newProject);
            currentProjectId = newProject.id;
            
            console.log('â• ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±:', {
                newProjectId: newProject.id,
                totalProjects: projects.length,
                hasFloorplan: !!newProject.floorplan
            });
            
            // UI ìƒˆë¡œê³ ì¹¨
            renderProjectList();
            loadProjectToUI();
            updateProgress();
            
            showToast('âœ¨ ìƒˆ í”„ë¡œì íŠ¸ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥
            saveProjectsToLocalStorage();
        }

        // í”„ë¡œì íŠ¸ ì „í™˜
        window.switchProject = function(projectId) {
            if (projectId === currentProjectId) return;
            
            console.log('ğŸ”„ í”„ë¡œì íŠ¸ ì „í™˜:', {
                from: currentProjectId,
                to: projectId
            });
            
            // í˜„ì¬ í”„ë¡œì íŠ¸ UI ë°ì´í„° ì €ì¥
            saveCurrentProjectFromUI();
            
            // í”„ë¡œì íŠ¸ ì „í™˜ (Proxyê°€ ìë™ìœ¼ë¡œ ìƒˆ í”„ë¡œì íŠ¸ ì°¸ì¡°)
            currentProjectId = projectId;
            
            console.log('ğŸ“‚ ì „í™˜ í›„ í”„ë¡œì íŠ¸:', {
                id: projectId,
                hasFloorplan: !!getCurrentProject().floorplan
            });
            
            // ìƒˆ í”„ë¡œì íŠ¸ UI ë¡œë“œ
            loadProjectToUI();
            renderProjectList();
            updateProgress();
            
            showToast('ğŸ“‚ í”„ë¡œì íŠ¸ê°€ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤');
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥
            saveProjectsToLocalStorage();
        }

        // í˜„ì¬ í”„ë¡œì íŠ¸ ì‚­ì œ
        window.deleteCurrentProject = function() {
            if (projects.length <= 1) {
                alert('âŒ ë§ˆì§€ë§‰ í”„ë¡œì íŠ¸ëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                return;
            }

            const project = getCurrentProject();
            const projectName = project.apartmentName && project.dong && project.ho 
                ? `${project.apartmentName} ${project.dong} ${project.ho}`
                : 'í˜„ì¬ í”„ë¡œì íŠ¸';

            if (!confirm(`"${projectName}"ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nâš ï¸ ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)) {
                return;
            }

            // í”„ë¡œì íŠ¸ ì‚­ì œ
            projects = projects.filter(p => p.id !== currentProjectId);
            
            // ì²« ë²ˆì§¸ í”„ë¡œì íŠ¸ë¡œ ì „í™˜
            currentProjectId = projects[0].id;
            
            // UI ì—…ë°ì´íŠ¸
            loadProjectToUI();
            renderProjectList();
            updateProgress();
            
            showToast('ğŸ—‘ï¸ í”„ë¡œì íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥
            saveProjectsToLocalStorage();
        }

        // UIì—ì„œ í˜„ì¬ í”„ë¡œì íŠ¸ë¡œ ë°ì´í„° ì €ì¥
        function saveCurrentProjectFromUI() {
            const project = getCurrentProject();
            
            project.apartmentName = document.getElementById('apartmentName').value;
            project.dong = document.getElementById('dong').value;
            project.ho = document.getElementById('ho').value;
            project.inspectionDate = document.getElementById('inspectionDate').value;
            project.customerName = document.getElementById('customerName').value;
            project.customerPhone = document.getElementById('customerPhone').value;
            project.author = document.getElementById('author').value; // âœ… ì‘ì„±ì ì €ì¥
            
            // floorplan, defects, equipment, airQualityëŠ” ì´ë¯¸ projectData ì°¸ì¡°ë¡œ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ë¨
        }

        // í”„ë¡œì íŠ¸ ë°ì´í„°ë¥¼ UIì— ë¡œë“œ
        function loadProjectToUI() {
            const project = getCurrentProject();
            
            document.getElementById('apartmentName').value = project.apartmentName || '';
            document.getElementById('dong').value = project.dong || '';
            document.getElementById('ho').value = project.ho || '';
            document.getElementById('inspectionDate').value = project.inspectionDate || '';
            document.getElementById('customerName').value = project.customerName || '';
            document.getElementById('customerPhone').value = project.customerPhone || '';
            document.getElementById('author').value = project.author || ''; // âœ… ì‘ì„±ì ë¡œë“œ
            
            // í‰ë©´ë„ í‘œì‹œ - displayFloorplan() í•¨ìˆ˜ ì‚¬ìš©
            displayFloorplan();
            
            // í•˜ì, ì¥ë¹„, ê³µê¸°ì§ˆ ëª©ë¡ ë Œë”ë§
            renderDefects();
            renderEquipment();
            renderAirQuality();
        }

        // ==================== ìë™ ì €ì¥ ìµœì í™” ====================
        let saveTimer = null;
        let isSaving = false;
        
        // Debounced ì €ì¥ (í…ìŠ¤íŠ¸ ì…ë ¥ ë“± ë¹ˆë²ˆí•œ ë³€ê²½ìš©)
        function saveWithDebounce(delay = 1000) {
            // ê¸°ì¡´ íƒ€ì´ë¨¸ ì·¨ì†Œ
            if (saveTimer) {
                clearTimeout(saveTimer);
            }
            
            // ìƒˆ íƒ€ì´ë¨¸ ì„¤ì •
            saveTimer = setTimeout(() => {
                saveProjectsToLocalStorage();
                saveTimer = null;
            }, delay);
        }
        
        // ì¦‰ì‹œ ì €ì¥ (ì¤‘ìš”í•œ ì‘ì—…ìš©)
        function saveImmediately() {
            // Debounce íƒ€ì´ë¨¸ ì·¨ì†Œ
            if (saveTimer) {
                clearTimeout(saveTimer);
                saveTimer = null;
            }
            
            // ì¦‰ì‹œ ì €ì¥
            saveProjectsToLocalStorage();
        }
        
        // í˜ì´ì§€ ì¢…ë£Œì‹œ pending ì €ì¥ ì²˜ë¦¬
        window.addEventListener('beforeunload', (e) => {
            if (saveTimer) {
                // pending ì €ì¥ì´ ìˆìœ¼ë©´ ì¦‰ì‹œ ì‹¤í–‰
                clearTimeout(saveTimer);
                saveTimer = null;
                
                // ë™ê¸°ì ìœ¼ë¡œ ì„¸ì…˜ìŠ¤í† ë¦¬ì§€ì— ì„ì‹œ ì €ì¥
                try {
                    const backupData = {
                        projects: projects,
                        currentProjectId: currentProjectId,
                        timestamp: new Date().toISOString()
                    };
                    sessionStorage.setItem('thehomein_temp_backup', JSON.stringify(backupData));
                    console.log('ğŸ“¦ ì¢…ë£Œ ì „ ì„ì‹œ ë°±ì—… ì™„ë£Œ');
                } catch (error) {
                    console.error('ì„ì‹œ ë°±ì—… ì‹¤íŒ¨:', error);
                }
            }
        });
        
        // í”„ë¡œì íŠ¸ ëª©ë¡ì„ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ (ê¸°ì¡´ í•¨ìˆ˜ ìˆ˜ì •)
        async function saveProjectsToLocalStorage() {
            // ì¤‘ë³µ ì €ì¥ ë°©ì§€
            if (isSaving) {
                console.log('â³ ì €ì¥ ì¤‘... ê±´ë„ˆëœ€');
                return;
            }
            
            isSaving = true;
            
            try {
                console.log('ğŸ’¾ ì €ì¥ ì‹œì‘:', {
                    totalProjects: projects.length,
                    currentProjectId: currentProjectId,
                    projects: projects.map(p => ({
                        id: p.id,
                        name: `${p.apartmentName} ${p.dong} ${p.ho}`.trim() || '(ì´ë¦„ì—†ìŒ)',
                        hasFloorplan: !!p.floorplan,
                        floorplanSize: p.floorplan ? p.floorplan.length : 0
                    }))
                });
                
                // í”„ë¡œì íŠ¸ ëª©ë¡ ì €ì¥
                await saveToIndexedDB('projects_list', { projects, currentProjectId });
                
                // âœ… í˜„ì¬ ì‘ì—… ì¤‘ì¸ í”„ë¡œì íŠ¸ë„ ë³„ë„ë¡œ ì €ì¥ (ìƒˆë¡œê³ ì¹¨ ì‹œ ë³µêµ¬ìš©)
                const currentProject = projects.find(p => p.id === currentProjectId);
                if (currentProject) {
                    await saveToIndexedDB('thehomein_current', currentProject);
                    console.log('âœ… í˜„ì¬ í”„ë¡œì íŠ¸ ì €ì¥ ì™„ë£Œ');
                }
                
                console.log('âœ… í”„ë¡œì íŠ¸ ëª©ë¡ ì €ì¥ ì™„ë£Œ');
            } catch (e) {
                console.error('í”„ë¡œì íŠ¸ ëª©ë¡ ì €ì¥ ì‹¤íŒ¨:', e);
                
                // âœ… ì‚¬ìš©ì ì•Œë¦¼ ì¶”ê°€
                if (e.name === 'QuotaExceededError') {
                    // ì €ì¥ ê³µê°„ ë¶€ì¡±
                    showToast('âš ï¸ ì €ì¥ ê³µê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤! ë¶ˆí•„ìš”í•œ ì‚¬ì§„ì„ ì‚­ì œí•´ì£¼ì„¸ìš”', 'error');
                    
                    // ê³µê°„ ì‚¬ìš©ëŸ‰ ì²´í¬ (ê°€ëŠ¥í•œ ê²½ìš°)
                    if (navigator.storage && navigator.storage.estimate) {
                        const estimate = await navigator.storage.estimate();
                        const usedMB = Math.round(estimate.usage / 1024 / 1024);
                        const quotaMB = Math.round(estimate.quota / 1024 / 1024);
                        console.log(`ğŸ“Š ì €ì¥ê³µê°„: ${usedMB}MB / ${quotaMB}MB ì‚¬ìš© ì¤‘`);
                    }
                } else if (e.name === 'InvalidStateError' || e.name === 'TransactionInactiveError') {
                    // íŠ¸ëœì­ì…˜ ì˜¤ë¥˜
                    showToast('âš ï¸ ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ! ìë™ìœ¼ë¡œ ë‹¤ì‹œ ì‹œë„í•©ë‹ˆë‹¤', 'warning');
                    
                    // 1ì´ˆ í›„ ì¬ì‹œë„
                    setTimeout(async () => {
                        try {
                            await saveToIndexedDB('projects_list', { projects, currentProjectId });
                            showToast('âœ… ì¬ì‹œë„ ì„±ê³µ! ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                        } catch (retryError) {
                            showToast('âŒ ì €ì¥ ì‹¤íŒ¨! ì•±ì„ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”', 'error');
                        }
                    }, 1000);
                } else {
                    // ê¸°íƒ€ ì˜¤ë¥˜
                    showToast('âš ï¸ ì €ì¥ ì‹¤íŒ¨! ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”', 'error');
                }
                
                // ì„ì‹œ ë°±ì—… (ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€)
                try {
                    const backupData = {
                        projects: projects,
                        currentProjectId: currentProjectId,
                        timestamp: new Date().toISOString()
                    };
                    sessionStorage.setItem('thehomein_temp_backup', JSON.stringify(backupData));
                    console.log('ğŸ“¦ ì„ì‹œ ë°±ì—… ì™„ë£Œ (ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€)');
                } catch (backupError) {
                    console.error('ì„ì‹œ ë°±ì—…ë„ ì‹¤íŒ¨:', backupError);
                }
            } finally {
                isSaving = false;
            }
        }

        // í”„ë¡œì íŠ¸ ëª©ë¡ì„ IndexedDBì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadProjectsFromLocalStorage() {
            try {
                const saved = await loadFromIndexedDB('projects_list');
                
                if (saved && saved.projects) {
                    projects = saved.projects;
                    currentProjectId = saved.currentProjectId;
                    
                    console.log('âœ… í”„ë¡œì íŠ¸ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ:', projects.length + 'ê°œ');
                    
                    // âœ… í˜„ì¬ í”„ë¡œì íŠ¸ì˜ ë°ì´í„°ë¥¼ UIì— ë°˜ì˜
                    const currentProject = getCurrentProject();
                    if (currentProject) {
                        document.getElementById('apartmentName').value = currentProject.apartmentName || '';
                        document.getElementById('dong').value = currentProject.dong || '';
                        document.getElementById('ho').value = currentProject.ho || '';
                        document.getElementById('inspectionDate').value = currentProject.inspectionDate || '';
                        document.getElementById('customerName').value = currentProject.customerName || '';
                        document.getElementById('customerPhone').value = currentProject.customerPhone || '';
                        document.getElementById('author').value = currentProject.author || '';
                        
                        // âœ… ID ì¹´ìš´í„° ì´ˆê¸°í™” ì œê±° (ì´ì œ í”„ë¡œì íŠ¸ë³„ë¡œ ê´€ë¦¬ë¨)
                        // ê¸°ì¡´ ì½”ë“œ ì œê±°ë¨ - í”„ë¡œì íŠ¸ë³„ lastDefectId, lastEquipmentId, lastAirQualityId ì‚¬ìš©
                        
                        // ë Œë”ë§
                        displayFloorplan();
                        renderDefects();
                        renderEquipment();
                        renderAirQuality();
                    }
                } else {
                    // âœ… IndexedDB ì‹¤íŒ¨ ì‹œ ì„ì‹œ ë°±ì—… í™•ì¸
                    const tempBackup = sessionStorage.getItem('thehomein_temp_backup');
                    if (tempBackup) {
                        try {
                            const backupData = JSON.parse(tempBackup);
                            projects = backupData.projects;
                            currentProjectId = backupData.currentProjectId;
                            
                            console.log('ğŸ“¦ ì„ì‹œ ë°±ì—…ì—ì„œ ë³µêµ¬:', projects.length + 'ê°œ');
                            showToast('ğŸ“¦ ì„ì‹œ ë°±ì—…ì—ì„œ ë°ì´í„°ë¥¼ ë³µêµ¬í–ˆìŠµë‹ˆë‹¤', 'info');
                            
                            // ë³µêµ¬ í›„ ë‹¤ì‹œ ì €ì¥ ì‹œë„
                            saveProjectsToLocalStorage();
                        } catch (backupError) {
                            console.error('ì„ì‹œ ë°±ì—… ë³µêµ¬ ì‹¤íŒ¨:', backupError);
                            // ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
                            const newProject = createNewProject();
                            projects.push(newProject);
                            currentProjectId = newProject.id;
                        }
                    } else {
                        // ì²« ì‹¤í–‰ ì‹œ ë¹ˆ í”„ë¡œì íŠ¸ ìƒì„±
                        const newProject = createNewProject();
                        projects.push(newProject);
                        currentProjectId = newProject.id;
                        console.log('âœ… ìƒˆ í”„ë¡œì íŠ¸ ìƒì„± ì™„ë£Œ');
                    }
                }
                
                renderProjectList();
            } catch (e) {
                console.error('í”„ë¡œì íŠ¸ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:', e);
                
                // âœ… ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ì ì•Œë¦¼
                showToast('âš ï¸ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨! ì„ì‹œ ë°±ì—…ì„ í™•ì¸í•©ë‹ˆë‹¤', 'warning');
                
                // ì„ì‹œ ë°±ì—… ì‹œë„
                const tempBackup = sessionStorage.getItem('thehomein_temp_backup');
                if (tempBackup) {
                    try {
                        const backupData = JSON.parse(tempBackup);
                        projects = backupData.projects;
                        currentProjectId = backupData.currentProjectId;
                        showToast('âœ… ì„ì‹œ ë°±ì—…ì—ì„œ ë³µêµ¬ ì„±ê³µ!', 'success');
                    } catch (backupError) {
                        // ì‹¤íŒ¨ ì‹œ ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
                        const newProject = createNewProject();
                        projects.push(newProject);
                        currentProjectId = newProject.id;
                        showToast('ğŸ“ ìƒˆ í”„ë¡œì íŠ¸ë¡œ ì‹œì‘í•©ë‹ˆë‹¤', 'info');
                    }
                } else {
                    // ì‹¤íŒ¨ ì‹œ ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
                    const newProject = createNewProject();
                    projects.push(newProject);
                    currentProjectId = newProject.id;
                }
                renderProjectList();
            }
        }

        // ==================== ì´ˆê¸°í™” ====================
        // Google API ë¡œë“œ
        if (typeof gapi !== 'undefined') {
            gapiLoaded();
        }
        if (typeof google !== 'undefined') {
            gisLoaded();
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', async function() {
        
        // IndexedDB ì´ˆê¸°í™”
        try {
            await initDB();
            console.log('IndexedDB ì´ˆê¸°í™” ì™„ë£Œ');
        } catch (e) {
            console.error('IndexedDB ì´ˆê¸°í™” ì‹¤íŒ¨:', e);
        }
        
        
        // ìë™ ë¡œê·¸ì¸ ì²´í¬
        checkIfSignedIn();
        
        // í”„ë¡œì íŠ¸ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° (UI ë°˜ì˜ í¬í•¨)
        await loadProjectsFromLocalStorage();
        
        // ì €ì¥ëœ í”„ë¡œì íŠ¸ ëª©ë¡ ë Œë”ë§
        await renderSavedList();
        
        // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
        updateProgress();
            
            // ì ê²€ì¼ì ê¸°ë³¸ê°’ ì„¤ì • (ì €ì¥ëœ ê°’ì´ ì—†ì„ ë•Œë§Œ)
            if (!document.getElementById('inspectionDate').value) {
                document.getElementById('inspectionDate').valueAsDate = new Date();
            }
            
            console.log('âœ… ì•± ì´ˆê¸°í™” ì™„ë£Œ');
        });

        // íƒ­ ì „í™˜
        window.switchTab = function(tabName, evt) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            
            if (evt && evt.target) {
                evt.target.classList.add('active');
            }
            document.getElementById(tabName).classList.add('active');
            
            // í•˜ìì ê²€ ë˜ëŠ” ì¥ë¹„ì ê²€ íƒ­ì—ì„œë§Œ í”Œë¡œíŒ… ë²„íŠ¼ í‘œì‹œ
            const floatingBtn = document.getElementById('floatingAddBtn');
            if (tabName === 'defects' || tabName === 'equipment') {
                floatingBtn.style.display = 'flex';
            } else {
                floatingBtn.style.display = 'none';
            }
            
            updateProgress();
        }

        // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
        function updateProgress() {
            let progress = 0;
            const weights = {
                project: 20,
                floorplan: 15,
                defects: 25,
                equipment: 20,
                airquality: 20
            };

            if (projectData.apartmentName && projectData.dong && projectData.ho) {
                progress += weights.project;
            }

            if (projectData.floorplan) {
                progress += weights.floorplan;
            }

            if (projectData.defects.length > 0) {
                progress += weights.defects;
            }

            if (projectData.equipment && projectData.equipment.length > 0) {
                progress += weights.equipment;
            }

            if (projectData.airQuality.length > 0) {
                progress += weights.airquality;
            }

            document.getElementById('progressBar').style.width = progress + '%';
        }

        // Toast ë©”ì‹œì§€
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        // ë¡œë”© í‘œì‹œ
        function showLoading() {
            document.getElementById('loading').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loading').classList.remove('active');
        }

        // ==================== í”„ë¡œì íŠ¸ ì •ë³´ ====================
        window.saveProject = function() {
            const newApartmentName = document.getElementById('apartmentName').value;
            const newDong = document.getElementById('dong').value;
            const newHo = document.getElementById('ho').value;
            
            const isNewProject = (
                projectData.apartmentName !== newApartmentName ||
                projectData.dong !== newDong ||
                projectData.ho !== newHo
            ) && (projectData.apartmentName || projectData.dong || projectData.ho);

            if (isNewProject && (projectData.defects.length > 0 || projectData.floorplan || projectData.airQuality.some(r => r.radon || r.formaldehyde || r.vocs))) {
                if (confirm('ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\ní˜„ì¬ í•˜ì ì ê²€ ë° ê³µê¸°ì§ˆ ë°ì´í„°ê°€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.\n(ì´ì „ í”„ë¡œì íŠ¸ëŠ” "ë°ì´í„°" íƒ­ì—ì„œ ì €ì¥í•˜ì„¸ìš”)')) {
                    projectData.defects = [];
                    projectData.floorplan = null;
                    projectData.equipment = [];
                    projectData.airQuality = [
                        { id: 1, name: 'ê±°ì‹¤', radon: '', formaldehyde: '', vocs: '' },
                        { id: 2, name: 'ì¹¨ì‹¤1', radon: '', formaldehyde: '', vocs: '' },
                        { id: 3, name: 'ì¹¨ì‹¤2', radon: '', formaldehyde: '', vocs: '' },
                        { id: 4, name: 'ì¹¨ì‹¤3', radon: '', formaldehyde: '', vocs: '' },
                        { id: 5, name: 'ê³µìš©ìš•ì‹¤', radon: '', formaldehyde: '', vocs: '' },
                        { id: 6, name: 'ë¶€ë¶€ìš•ì‹¤', radon: '', formaldehyde: '', vocs: '' }
                    ];
                    // í”„ë¡œì íŠ¸ë³„ ì¹´ìš´í„° ì´ˆê¸°í™”
                    const project = getCurrentProject();
                    project.lastAirQualityId = 6;
                    
                    renderDefects();
                    renderEquipment();
                    renderAirQuality();
                    displayFloorplan();
                    showToast('ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤');
                } else {
                    return;
                }
            }

            projectData.apartmentName = newApartmentName;
            projectData.dong = newDong;
            projectData.ho = newHo;
            projectData.inspectionDate = document.getElementById('inspectionDate').value;
            projectData.customerName = document.getElementById('customerName').value;
            projectData.customerPhone = document.getElementById('customerPhone').value;

            saveProjectsToLocalStorage();
            updateProgress();
            showToast('í”„ë¡œì íŠ¸ ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
        }

        // ==================== í‰ë©´ë„ ê´€ë¦¬ ====================
        window.openFloorplanCamera = function() {
            currentPhotoTarget = 'floorplan';
            openCamera();
        }

        window.openFloorplanGallery = async function() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (file) {
                    const compressed = await compressImage(file);
                    const project = getCurrentProject(); // âœ… í˜„ì¬ í”„ë¡œì íŠ¸ ê°€ì ¸ì˜¤ê¸°
                    
                    console.log('ğŸ”µ í‰ë©´ë„ ì €ì¥ ì „:', {
                        projectId: project.id,
                        projectName: `${project.apartmentName} ${project.dong} ${project.ho}`,
                        currentProjectId: currentProjectId,
                        hasFloorplan: !!project.floorplan
                    });
                    
                    project.floorplan = compressed; // âœ… í˜„ì¬ í”„ë¡œì íŠ¸ì— ì €ì¥
                    
                    console.log('ğŸŸ¢ í‰ë©´ë„ ì €ì¥ í›„:', {
                        projectId: project.id,
                        hasFloorplan: !!project.floorplan,
                        totalProjects: projects.length
                    });
                    
                    displayFloorplan();
                    saveProjectsToLocalStorage(); // âœ… í”„ë¡œì íŠ¸ ë°°ì—´ ì €ì¥
                    updateProgress();
                    showToast('í‰ë©´ë„ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
                }
            };
            input.click();
        }

        function displayFloorplan() {
            const preview = document.getElementById('floorplanPreview');
            const placeholder = document.getElementById('floorplanPlaceholder');
            const project = getCurrentProject(); // âœ… í˜„ì¬ í”„ë¡œì íŠ¸ ê°€ì ¸ì˜¤ê¸°
            
            console.log('ğŸ–¼ï¸ displayFloorplan í˜¸ì¶œ:', {
                projectId: project.id,
                hasFloorplan: !!project.floorplan,
                floorplanLength: project.floorplan ? project.floorplan.length : 0
            });
            
            if (project.floorplan) {
                preview.src = project.floorplan;
                preview.style.display = 'block';
                placeholder.style.display = 'none';
            } else {
                preview.src = '';
                preview.style.display = 'none';
                placeholder.style.display = 'block';
            }
        }

        window.deleteFloorplan = function() {
            if (confirm('í‰ë©´ë„ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                const project = getCurrentProject(); // âœ… í˜„ì¬ í”„ë¡œì íŠ¸ ê°€ì ¸ì˜¤ê¸°
                project.floorplan = null; // âœ… í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œ ì‚­ì œ
                displayFloorplan();
                saveProjectsToLocalStorage(); // âœ… í”„ë¡œì íŠ¸ ë°°ì—´ ì €ì¥
                updateProgress();
                showToast('í‰ë©´ë„ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
            }
        }

        // ==================== í•˜ì ì ê²€ ====================
        window.handleFloatingBtnClick = function() {
            const activeSection = document.querySelector('.section.active');
            if (activeSection.id === 'defects') {
                addDefect();
            } else if (activeSection.id === 'equipment') {
                addEquipment();
            }
        }

        function addDefect() {
            // âœ… ê¸°ì¡´ í•˜ì ì¤‘ ì‚¬ì§„ì´ 2ì¥ ë¯¸ë§Œì¸ ê²ƒì´ ìˆëŠ”ì§€ í™•ì¸
            if (projectData.defects.length > 0) {
                const lastDefect = projectData.defects[projectData.defects.length - 1];
                
                // ì‚¬ì§„ ê²€ì¦ (í•„ìˆ˜ 2ì¥)
                if (!lastDefect.photos || lastDefect.photos.length < 2) {
                    alert('âš ï¸ ë°”ë¡œ ì´ì „ í•˜ìì˜ ì‚¬ì§„ì„ 2ì¥ ëª¨ë‘ ì´¬ì˜í•´ì£¼ì„¸ìš”!\n\nğŸ“· í•„ìˆ˜: ì›ê²½(ë©€ë¦¬ì„œ) + ê·¼ì ‘(ê°€ê¹Œì´ì„œ) ì‚¬ì§„');
                    // í•´ë‹¹ í•˜ìë¡œ ìŠ¤í¬ë¡¤
                    setTimeout(() => {
                        const defectsList = document.getElementById('defectsList');
                        if (defectsList.lastElementChild) {
                            defectsList.lastElementChild.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }, 100);
                    return;
                }
            }
            
            // âœ… í”„ë¡œì íŠ¸ë³„ ID ì¹´ìš´í„° ì‚¬ìš©
            const project = getCurrentProject();
            
            // ê¸°ì¡´ ìµœëŒ€ ID í™•ì¸ (í˜¸í™˜ì„± ë³´ì¥)
            const maxExistingId = project.defects.length > 0 
                ? Math.max(...project.defects.map(d => d.id))
                : 0;
            
            // í”„ë¡œì íŠ¸ë³„ ì¹´ìš´í„° ì—…ë°ì´íŠ¸
            project.lastDefectId = Math.max(
                project.lastDefectId || 0,
                maxExistingId
            ) + 1;
            
            // âœ… ëª¨ë“  ê²€ì¦ í†µê³¼ â†’ ìƒˆ í•˜ì ì¶”ê°€
            const newDefect = {
                id: project.lastDefectId,
                spaces: [],      // ë°°ì—´ë¡œ ë³€ê²½
                locations: [],   // ë°°ì—´ë¡œ ë³€ê²½
                types: [],       // ë°°ì—´ë¡œ ë³€ê²½
                detailLocation: '',
                description: '',
                photos: [],
                status: 'pending'
            };
            projectData.defects.push(newDefect);
            renderDefects();
            saveImmediately(); // âœ… ì¤‘ìš”: ì¦‰ì‹œ ì €ì¥
            updateProgress();
            showToast('âœ… ìƒˆ í•˜ìê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
            
            // ìƒˆë¡œ ì¶”ê°€ëœ í•˜ìë¡œ ìŠ¤í¬ë¡¤
            setTimeout(() => {
                const defectsList = document.getElementById('defectsList');
                if (defectsList.lastElementChild) {
                    defectsList.lastElementChild.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }, 100);
        }

        function renderDefects() {
            const container = document.getElementById('defectsList');
            
            if (projectData.defects.length === 0) {
                container.innerHTML = '<div class="card" style="text-align: center; color: var(--text-secondary);">ë“±ë¡ëœ í•˜ìê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                return;
            }

            container.innerHTML = projectData.defects.map((defect, index) => {
                // ë°°ì—´ì´ ì—†ìœ¼ë©´ ì´ˆê¸°í™”
                if (!defect.spaces) defect.spaces = [];
                if (!defect.locations) defect.locations = [];
                if (!defect.types) defect.types = [];
                
                return `
                <div class="defect-card">
                    <div class="defect-header">
                        <span class="defect-number">í•˜ì ${index + 1}</span>
                        <select class="defect-status ${defect.status === 'completed' ? 'status-completed' : 'status-pending'}" 
                                onchange="updateDefectStatus(${defect.id}, this.value)">
                            <option value="pending" ${defect.status === 'pending' ? 'selected' : ''}>ë¯¸ì™„ë£Œ</option>
                            <option value="completed" ${defect.status === 'completed' ? 'selected' : ''}>ì™„ë£Œ</option>
                        </select>
                    </div>

                    <div class="form-field">
                        <label class="form-label">ğŸ“· ì‚¬ì§„ ì´¬ì˜/ì²¨ë¶€ (í•„ìˆ˜ 2ì¥: ë©€ë¦¬ì„œ â†’ ê°€ê¹Œì´ì„œ)</label>
                        
                        ${!defect.photos[0] && !defect.photos[1] ? `
                            <div style="text-align: center; padding: 12px; background: rgba(16, 185, 129, 0.1); border: 2px dashed var(--primary); border-radius: 12px;">
                                <div style="font-size: 30px; margin-bottom: 6px;">ğŸ“·</div>
                                <div style="font-size: 14px; font-weight: bold; color: var(--primary); margin-bottom: 8px;">
                                    ì›ê²½ ì‚¬ì§„ ì´¬ì˜/ì²¨ë¶€
                                </div>
                                <div style="display: flex; gap: 8px; justify-content: center;">
                                    <button class="btn btn-primary" onclick="startDefectPhotoSequence(${defect.id})" style="flex: 1; max-width: 150px; padding: 10px; font-size: 13px;">
                                        ğŸ“· ì´¬ì˜
                                    </button>
                                    <button class="btn btn-primary" onclick="uploadDefectPhotoFromGallery(${defect.id}, 'far')" style="flex: 1; max-width: 150px; padding: 10px; font-size: 13px;">
                                        ğŸ–¼ï¸ ê°¤ëŸ¬ë¦¬
                                    </button>
                                </div>
                            </div>
                        ` : defect.photos[0] && !defect.photos[1] ? `
                            <div style="margin-bottom: 10px;">
                                <div style="position: relative; width: 100%;">
                                    <img src="${defect.photos[0]}" alt="ë©€ë¦¬ì„œ" style="width: 100%; height: 220px; object-fit: cover; border-radius: 8px; border: 2px solid var(--primary);">
                                    <div style="position: absolute; bottom: 6px; left: 6px; background: rgba(16, 185, 129, 0.95); color: white; padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: bold;">
                                        âœ“ ì›ê²½ ì‚¬ì§„
                                    </div>
                                </div>
                            </div>
                            <div style="text-align: center; padding: 12px; background: rgba(251, 191, 36, 0.1); border: 2px dashed var(--secondary); border-radius: 12px;">
                                <div style="font-size: 30px; margin-bottom: 6px;">ğŸ“·</div>
                                <div style="font-size: 14px; font-weight: bold; color: var(--secondary); margin-bottom: 8px;">
                                    ê·¼ê²½ ì‚¬ì§„ ì´¬ì˜/ì²¨ë¶€
                                </div>
                                <div style="display: flex; gap: 8px; justify-content: center;">
                                    <button class="btn btn-secondary" onclick="continueDefectPhotoSequence(${defect.id})" style="flex: 1; max-width: 150px; padding: 10px; font-size: 13px;">
                                        ğŸ“· ì´¬ì˜
                                    </button>
                                    <button class="btn btn-secondary" onclick="uploadDefectPhotoFromGallery(${defect.id}, 'close')" style="flex: 1; max-width: 150px; padding: 10px; font-size: 13px;">
                                        ğŸ–¼ï¸ ê°¤ëŸ¬ë¦¬
                                    </button>
                                </div>
                            </div>
                        ` : `
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                                <!-- ì›ê²½ ì‚¬ì§„ -->
                                <div>
                                    ${defect.photos[0] ? `
                                        <div style="position: relative; margin-bottom: 4px;">
                                            <img src="${defect.photos[0]}" alt="ë©€ë¦¬ì„œ" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px 8px 0 0; border: 2px solid var(--primary); border-bottom: none;">
                                            <div style="position: absolute; top: 6px; left: 6px; background: rgba(16, 185, 129, 0.95); color: white; padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: bold;">
                                                âœ“ ì›ê²½ ì‚¬ì§„
                                            </div>
                                        </div>
                                        <div style="display: flex; border: 2px solid var(--primary); border-top: none; border-radius: 0 0 8px 8px; overflow: hidden;">
                                            <button class="btn" onclick="retakeDefectPhoto(${defect.id}, 0, 'far')" style="flex: 1; border-radius: 0; border: none; padding: 8px; font-size: 11px; background: #f3f4f6; color: #374151;">
                                                ğŸ”„ ì¬ì´¬ì˜
                                            </button>
                                            <button class="btn" onclick="reattachDefectPhoto(${defect.id}, 0, 'far')" style="flex: 1; border-radius: 0; border: none; border-left: 1px solid #ddd; padding: 8px; font-size: 11px; background: #f3f4f6; color: #374151;">
                                                ğŸ–¼ï¸ ì¬ì²¨ë¶€
                                            </button>
                                            <button class="btn" onclick="deleteDefectPhoto(${defect.id}, 0)" style="flex: 1; border-radius: 0; border: none; border-left: 1px solid #ddd; padding: 8px; font-size: 11px; background: #fee2e2; color: #dc2626;">
                                                ğŸ—‘ï¸ ì‚­ì œ
                                            </button>
                                        </div>
                                    ` : `
                                        <div style="border: 2px dashed var(--primary); border-radius: 8px; overflow: hidden;">
                                            <div style="height: 200px; background: #f8f9fa; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px;">
                                                <div style="font-size: 32px; opacity: 0.3;">ğŸ“·</div>
                                                <div style="font-size: 12px; font-weight: bold; color: var(--primary);">ì›ê²½ ì‚¬ì§„</div>
                                            </div>
                                            <div style="display: flex; border-top: 2px dashed var(--primary);">
                                                <button class="btn btn-primary" onclick="retakeDefectPhoto(${defect.id}, 0, 'far')" style="flex: 1; border-radius: 0; border: none; padding: 8px; font-size: 11px;">
                                                    ğŸ“· ì´¬ì˜
                                                </button>
                                                <button class="btn btn-primary" onclick="reattachDefectPhoto(${defect.id}, 0, 'far')" style="flex: 1; border-radius: 0; border: none; border-left: 1px solid #ddd; padding: 8px; font-size: 11px;">
                                                    ğŸ–¼ï¸ ê°¤ëŸ¬ë¦¬
                                                </button>
                                            </div>
                                        </div>
                                    `}
                                </div>
                                
                                <!-- ê·¼ê²½ ì‚¬ì§„ -->
                                <div>
                                    ${defect.photos[1] ? `
                                        <div style="position: relative; margin-bottom: 4px;">
                                            <img src="${defect.photos[1]}" alt="ê°€ê¹Œì´ì„œ" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px 8px 0 0; border: 2px solid var(--secondary); border-bottom: none;">
                                            <div style="position: absolute; top: 6px; left: 6px; background: rgba(251, 191, 36, 0.95); color: white; padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: bold;">
                                                âœ“ ê·¼ê²½ ì‚¬ì§„
                                            </div>
                                        </div>
                                        <div style="display: flex; border: 2px solid var(--secondary); border-top: none; border-radius: 0 0 8px 8px; overflow: hidden;">
                                            <button class="btn" onclick="retakeDefectPhoto(${defect.id}, 1, 'close')" style="flex: 1; border-radius: 0; border: none; padding: 8px; font-size: 11px; background: #fef3c7; color: #92400e;">
                                                ğŸ”„ ì¬ì´¬ì˜
                                            </button>
                                            <button class="btn" onclick="reattachDefectPhoto(${defect.id}, 1, 'close')" style="flex: 1; border-radius: 0; border: none; border-left: 1px solid #ddd; padding: 8px; font-size: 11px; background: #fef3c7; color: #92400e;">
                                                ğŸ–¼ï¸ ì¬ì²¨ë¶€
                                            </button>
                                            <button class="btn" onclick="deleteDefectPhoto(${defect.id}, 1)" style="flex: 1; border-radius: 0; border: none; border-left: 1px solid #ddd; padding: 8px; font-size: 11px; background: #fee2e2; color: #dc2626;">
                                                ğŸ—‘ï¸ ì‚­ì œ
                                            </button>
                                        </div>
                                    ` : `
                                        <div style="border: 2px dashed var(--secondary); border-radius: 8px; overflow: hidden;">
                                            <div style="height: 200px; background: #fef3c7; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px;">
                                                <div style="font-size: 32px; opacity: 0.3;">ğŸ“·</div>
                                                <div style="font-size: 12px; font-weight: bold; color: var(--secondary);">ê·¼ê²½ ì‚¬ì§„</div>
                                            </div>
                                            <div style="display: flex; border-top: 2px dashed var(--secondary);">
                                                <button class="btn btn-secondary" onclick="retakeDefectPhoto(${defect.id}, 1, 'close')" style="flex: 1; border-radius: 0; border: none; padding: 8px; font-size: 11px;">
                                                    ğŸ“· ì´¬ì˜
                                                </button>
                                                <button class="btn btn-secondary" onclick="reattachDefectPhoto(${defect.id}, 1, 'close')" style="flex: 1; border-radius: 0; border: none; border-left: 1px solid #ddd; padding: 8px; font-size: 11px;">
                                                    ğŸ–¼ï¸ ê°¤ëŸ¬ë¦¬
                                                </button>
                                            </div>
                                        </div>
                                    `}
                                </div>
                            </div>
                        `}
                    </div>

                    <div class="form-field">
                        <label class="form-label">ê³µê°„ ì„ íƒ (ìµœëŒ€ 4ê°œ)</label>
                        <div class="selected-count">${defect.spaces.length}/4 ì„ íƒë¨</div>
                        <div class="touch-button-grid">
                            ${getSpaceButtons().map(space => `
                                <button type="button" class="touch-btn ${defect.spaces.includes(space) ? 'selected' : ''}" 
                                        ${defect.spaces.length >= 4 && !defect.spaces.includes(space) ? 'disabled' : ''}
                                        onclick="toggleDefectSelection(${defect.id}, 'spaces', '${space}')">
                                    ${space}
                                </button>
                            `).join('')}
                        </div>
                        
                        <!-- ì»¤ìŠ¤í…€ ê³µê°„ ì…ë ¥ (ìˆ¨ê¹€ ì²˜ë¦¬) -->
                        <details style="margin-top: 8px;">
                            <summary style="cursor: pointer; font-size: 13px; color: var(--text-secondary); padding: 6px 0;">
                                + ì§ì ‘ ì…ë ¥
                            </summary>
                            <div style="margin-top: 8px;">
                                <input type="text" 
                                       id="customSpace${defect.id}" 
                                       class="form-input" 
                                       value=""
                                       placeholder="ì˜ˆ: ì„œì¬, ë‹¤ìš©ë„ì‹¤ ì…ë ¥ í›„ ì—”í„°" 
                                       style="width: 100%; font-size: 14px; margin-bottom: 4px;"
                                       onkeydown="if(event.key==='Enter' && !event.isComposing){event.preventDefault();addCustomSpace(${defect.id});}"
                                       onchange="addCustomSpace(${defect.id})">
                                <div style="font-size: 11px; color: var(--text-secondary);">
                                    ğŸ’¡ ì…ë ¥ í›„ ì—”í„° ë˜ëŠ” ë‹¤ë¥¸ ê³³ í´ë¦­
                                </div>
                            </div>
                        </details>
                    </div>

                    <div class="form-field">
                        <label class="form-label">ìœ„ì¹˜ ì„ íƒ (ìµœëŒ€ 4ê°œ)</label>
                        <div class="selected-count">${defect.locations.length}/4 ì„ íƒë¨</div>
                        <div class="touch-button-grid">
                            ${['ë²½','ë°”ë‹¥','ì²œì¥','ë„ë°°','ê°€êµ¬','ì°½','ë¬¸','ì§','í‹€','ë§ˆê°íŒ','ìˆ˜ì „','íƒ€ì¼','ë„ì¥','ì¤„ëˆˆ','ì½”í‚¹'].map(location => `
                                <button type="button" class="touch-btn ${defect.locations.includes(location) ? 'selected' : ''}" 
                                        ${defect.locations.length >= 4 && !defect.locations.includes(location) ? 'disabled' : ''}
                                        onclick="toggleDefectSelection(${defect.id}, 'locations', '${location}')">
                                    ${location}
                                </button>
                            `).join('')}
                        </div>
                    </div>

                    <div class="form-field">
                        <label class="form-label">ğŸ“ ìƒì„¸ìœ„ì¹˜ (ì„ íƒì‚¬í•­)</label>
                        <input type="text" class="form-input" value="${defect.detailLocation || ''}" 
                               onchange="updateDefect(${defect.id}, 'detailLocation', this.value)" 
                               placeholder="ì˜ˆ: ê±°ì‹¤ ì°½ë¬¸ ìš°ì¸¡ í•˜ë‹¨, ì£¼ë°© ì‹±í¬ëŒ€ ì¢Œì¸¡ ë²½ ë“±">
                        <div style="font-size: 11px; color: var(--text-secondary); margin-top: 4px;">
                            ğŸ’¡ ìœ„ì¹˜ë¥¼ ë” êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…í•˜ê³  ì‹¶ì„ ë•Œ ì…ë ¥í•˜ì„¸ìš”
                        </div>
                    </div>

                    <div class="form-field">
                        <label class="form-label">í•˜ìë‚´ìš© ì„ íƒ (ìµœëŒ€ 4ê°œ)</label>
                        <div class="selected-count">${defect.types.length}/4 ì„ íƒë¨</div>
                        
                        <!-- ìƒë‹¨ ê·¸ë£¹: í•˜ì ìœ í˜• -->
                        <div style="margin-bottom: 8px;">
                            <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">
                                í•˜ì ìœ í˜•
                            </div>
                            <div class="touch-button-grid">
                                ${['ìœ ê²©','í‹ˆìƒˆ','ë‹¨ì°¨','íŒŒì†','ê¸í˜','ì°í˜','ë“¤ëœ¸','ì˜¤ì—¼','ë§ˆê°','ê³ ì •','ìˆ˜í‰/ìˆ˜ì§'].map(type => `
                                    <button type="button" class="touch-btn ${defect.types.includes(type) ? 'selected' : ''}" 
                                            ${defect.types.length >= 4 && !defect.types.includes(type) ? 'disabled' : ''}
                                            onclick="toggleDefectSelection(${defect.id}, 'types', '${type}')">
                                        ${type}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                        
                        <!-- êµ¬ë¶„ì„  -->
                        <div style="border-top: 1px solid var(--border); margin: 12px 0;"></div>
                        
                        <!-- í•˜ë‹¨ ê·¸ë£¹: ìƒíƒœ/ì •ë„ -->
                        <div>
                            <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 600;">
                                ìƒíƒœ / ì •ë„
                            </div>
                            <div class="touch-button-grid">
                                ${['ì „ì²´','ë‹¤ìˆ˜','ì‘ë™','ë¶ˆëŸ‰','ë¯¸ì‹œê³µ','ì˜¤ì‹œê³µ'].map(type => `
                                    <button type="button" class="touch-btn ${defect.types.includes(type) ? 'selected' : ''}" 
                                            ${defect.types.length >= 4 && !defect.types.includes(type) ? 'disabled' : ''}
                                            onclick="toggleDefectSelection(${defect.id}, 'types', '${type}')">
                                        ${type}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <div class="form-field">
                        <label class="form-label">ìƒì„¸ì„¤ëª… (ìë™ ìƒì„±)</label>
                        <textarea class="form-input" rows="3" 
                                  readonly
                                  style="background: rgba(16, 185, 129, 0.05); cursor: default;"
                                  placeholder="ê³µê°„, ìœ„ì¹˜, í•˜ìë‚´ìš©ì„ ì„ íƒí•˜ë©´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤">${defect.description || ''}</textarea>
                        <div style="font-size: 11px; color: var(--text-secondary); margin-top: 5px;">
                            ğŸ’¡ ê³µê°„, ìœ„ì¹˜, í•˜ìë‚´ìš©, ìƒì„¸ìœ„ì¹˜ë¥¼ ì„ íƒí•˜ë©´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤
                        </div>
                    </div>

                    <button class="btn btn-danger" onclick="deleteDefect(${defect.id})">
                        ğŸ—‘ï¸ í•˜ì ì‚­ì œ
                    </button>
                </div>
            `;
            }).join('');
        }

        window.startDefectPhotoSequence = function(defectId) {
            currentPhotoTarget = { defectId: defectId, step: 'far' };
            openCamera();
        }

        window.continueDefectPhotoSequence = function(defectId) {
            currentPhotoTarget = { defectId: defectId, step: 'close' };
            openCamera();
        }

        window.retakeDefectPhotos = function(defectId) {
            if (confirm('ì‚¬ì§„ì„ ë‹¤ì‹œ ì´¬ì˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ê¸°ì¡´ ì‚¬ì§„ 2ì¥ì´ ì‚­ì œë©ë‹ˆë‹¤)')) {
                const defect = projectData.defects.find(d => d.id === defectId);
                if (defect) {
                    defect.photos = [];
                    renderDefects();
                    saveProjectsToLocalStorage();
                    showToast('ì‚¬ì§„ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì´¬ì˜í•´ì£¼ì„¸ìš”.');
                }
            }
        }

        // ê°œë³„ ì‚¬ì§„ ì¬ì´¬ì˜
        window.retakeDefectPhoto = function(defectId, photoIndex, photoType) {
            currentPhotoTarget = { defectId: defectId, photoIndex: photoIndex, photoType: photoType };
            openCamera();
        }

        // ê°œë³„ ì‚¬ì§„ ì¬ì²¨ë¶€ (ê°¤ëŸ¬ë¦¬)
        window.reattachDefectPhoto = function(defectId, photoIndex, photoType) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = async function(e) {
                const file = e.target.files[0];
                if (!file) return;

                try {
                    showToast('ì‚¬ì§„ì„ ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤...');
                    
                    // ì´ë¯¸ì§€ ì••ì¶•
                    const compressedImage = await compressImage(file, 1920, 0.85);
                    
                    const defect = projectData.defects.find(d => d.id === defectId);
                    if (defect && defect.photos) {
                        defect.photos[photoIndex] = compressedImage;
                        renderDefects();
                        saveProjectsToLocalStorage();
                        updateProgress();
                        showToast(`${photoType === 'far' ? 'ì›ê²½' : 'ê·¼ê²½'} ì‚¬ì§„ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    }
                } catch (error) {
                    console.error('ì‚¬ì§„ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
                    showToast('ì‚¬ì§„ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            };
            input.click();
        }

        // ê°œë³„ ì‚¬ì§„ ì‚­ì œ
        window.deleteDefectPhoto = function(defectId, photoIndex) {
            const photoType = photoIndex === 0 ? 'ì›ê²½ ì‚¬ì§„' : 'ê·¼ê²½ ì‚¬ì§„';
            if (confirm(`${photoType}ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                const defect = projectData.defects.find(d => d.id === defectId);
                if (defect && defect.photos) {
                    // splice ëŒ€ì‹  nullë¡œ ì„¤ì •í•˜ì—¬ ì¸ë±ìŠ¤ ìœ ì§€
                    defect.photos[photoIndex] = null;
                    renderDefects();
                    saveProjectsToLocalStorage();
                    updateProgress();
                    showToast(`${photoType}ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
                }
            }
        }

        window.uploadDefectPhotoFromGallery = async function(defectId, step) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (file) {
                    const compressed = await compressImage(file);
                    const defect = projectData.defects.find(d => d.id === defectId);
                    if (defect) {
                        defect.photos.push(compressed);
                        
                        renderDefects();
                        saveProjectsToLocalStorage();
                        updateProgress();
                    }
                }
            };
            input.click();
        }

        // ==================== ì¥ë¹„ì ê²€ ====================
        function addEquipment() {
            // âœ… í”„ë¡œì íŠ¸ë³„ ID ì¹´ìš´í„° ì‚¬ìš©
            const project = getCurrentProject();
            
            // ê¸°ì¡´ ìµœëŒ€ ID í™•ì¸ (í˜¸í™˜ì„± ë³´ì¥)
            const maxExistingId = project.equipment && project.equipment.length > 0 
                ? Math.max(...project.equipment.map(e => e.id))
                : 0;
            
            // í”„ë¡œì íŠ¸ë³„ ì¹´ìš´í„° ì—…ë°ì´íŠ¸
            project.lastEquipmentId = Math.max(
                project.lastEquipmentId || 0,
                maxExistingId
            ) + 1;
            
            const newEquipment = {
                id: project.lastEquipmentId,
                spaces: [],      // ê³µê°„ ë°°ì—´ë¡œ ë³€ê²½ (ìµœëŒ€ 2ê°œ)
                inspection: '',  // ë¹ˆ ê°’ìœ¼ë¡œ ì‹œì‘
                photos: {        // ìœ„ì¹˜ë³„ ì‚¬ì§„ ê°ì²´
                    'ì¢Œì¸¡': null,
                    'ìš°ì¸¡': null,
                    'ë°”ë‹¥1': null,
                    'ë°”ë‹¥2': null
                }
            };
            projectData.equipment.push(newEquipment);
            renderEquipment();
            saveProjectsToLocalStorage();
            updateProgress();
            showToast('ìƒˆ ì¥ë¹„ì ê²€ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
            
            setTimeout(() => {
                const equipmentList = document.getElementById('equipmentList');
                if (equipmentList.lastElementChild) {
                    equipmentList.lastElementChild.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }, 100);
        }

        function renderEquipment() {
            const container = document.getElementById('equipmentList');
            
            // equipment ë°°ì—´ì´ ì—†ìœ¼ë©´ ì´ˆê¸°í™”
            if (!projectData.equipment) {
                projectData.equipment = [];
            }
            
            if (projectData.equipment.length === 0) {
                container.innerHTML = '<div class="card" style="text-align: center; color: var(--text-secondary);">ë“±ë¡ëœ ì¥ë¹„ì ê²€ì´ ì—†ìŠµë‹ˆë‹¤</div>';
                return;
            }

            container.innerHTML = projectData.equipment.map((item, index) => {
                // í•˜ìœ„ í˜¸í™˜ì„±: ê¸°ì¡´ spaceë¥¼ spaces ë°°ì—´ë¡œ ë³€í™˜
                if (!item.spaces && item.space) {
                    item.spaces = [item.space];
                    delete item.space;
                } else if (!item.spaces) {
                    item.spaces = [];
                }
                
                // í•˜ìœ„ í˜¸í™˜ì„±: ê¸°ì¡´ 4ê°œ êµ¬ì¡°ë¥¼ 4ê°œë¡œ ë³€í™˜
                if (!item.photos || item.photos['ì¢Œì¸¡ìƒë‹¨']) {
                    item.photos = {
                        'ì¢Œì¸¡': item.photos?.['ì¢Œì¸¡ìƒë‹¨'] || item.photos?.['ì¢Œì¸¡í•˜ë‹¨'] || null,
                        'ìš°ì¸¡': item.photos?.['ìš°ì¸¡ìƒë‹¨'] || item.photos?.['ìš°ì¸¡í•˜ë‹¨'] || null,
                        'ë°”ë‹¥1': item.photos?.['ë°”ë‹¥'] || null,
                        'ë°”ë‹¥2': null
                    };
                } else if (item.photos && item.photos['ë°”ë‹¥'] && !item.photos['ë°”ë‹¥1']) {
                    // ê¸°ì¡´ 'ë°”ë‹¥'ì„ 'ë°”ë‹¥1'ë¡œ ë³€í™˜
                    item.photos['ë°”ë‹¥1'] = item.photos['ë°”ë‹¥'];
                    delete item.photos['ë°”ë‹¥'];
                    if (!item.photos['ë°”ë‹¥2']) item.photos['ë°”ë‹¥2'] = null;
                }
                
                const locations = ['ì¢Œì¸¡', 'ìš°ì¸¡', 'ë°”ë‹¥1', 'ë°”ë‹¥2'];
                const locationColors = {
                    'ì¢Œì¸¡': '#3498db',
                    'ìš°ì¸¡': '#e74c3c',
                    'ë°”ë‹¥1': '#f39c12',
                    'ë°”ë‹¥2': '#f39c12'
                };
                const locationIcons = {
                    'ì¢Œì¸¡': 'â¬…ï¸',
                    'ìš°ì¸¡': 'â¡ï¸',
                    'ë°”ë‹¥1': 'â¬‡ï¸',
                    'ë°”ë‹¥2': 'â¬‡ï¸'
                };
                
                return `
                <div class="defect-card">
                    <div class="defect-header">
                        <span class="defect-number">NO ${index + 1}</span>
                        <button class="btn btn-danger" onclick="deleteEquipment(${item.id})" style="width: auto; padding: 8px 16px; font-size: 12px;">
                            ğŸ—‘ï¸ ì‚­ì œ
                        </button>
                    </div>

                    <div class="form-field">
                        <label class="form-label">ê³µê°„ ì„ íƒ (ìµœëŒ€ 2ê°œ)</label>
                        <div class="selected-count">${(item.spaces || []).length}/2 ì„ íƒë¨</div>
                        <div class="touch-button-grid">
                            ${['í˜„ê´€','ì•ˆë°©','ì¹¨ì‹¤1','ì¹¨ì‹¤2','ì¹¨ì‹¤3','ì¹¨ì‹¤4','ë³µë„','ê±°ì‹¤','ì£¼ë°©','íŒ¬íŠ¸ë¦¬','ì™¸ë¶€','ì•ŒíŒŒë£¸','ë°œì½”ë‹ˆ','ëŒ€í”¼ê³µê°„','ì‹¤ì™¸ê¸°ì‹¤','íŒŒìš°ë”ë£¸','ë“œë ˆìŠ¤ë£¸','ê³µìš©ìš•ì‹¤','ë¶€ë¶€ìš•ì‹¤'].map(space => {
                                const spaces = item.spaces || [];
                                const isSelected = spaces.includes(space);
                                const isDisabled = spaces.length >= 2 && !isSelected;
                                return `
                                <button type="button" class="touch-btn ${isSelected ? 'selected' : ''}" 
                                        ${isDisabled ? 'disabled' : ''}
                                        onclick="toggleEquipmentSpace(${item.id}, '${space}')">
                                    ${space}
                                </button>
                            `}).join('')}
                        </div>
                    </div>

                    <div class="form-field">
                        <label class="form-label">ì ê²€ê²°ê³¼</label>
                        <div class="touch-button-grid" style="margin-bottom: 10px;">
                            ${['ë²½ì²´ ìˆ˜ì§ë„ ë° ë°”ë‹¥ í‰í™œë„ ì–‘í˜¸','ë°°ìˆ˜ê²½ì‚¬(êµ¬ë°°)ìƒíƒœ ì–‘í˜¸','ë²½ì²´ìˆ˜ì§ ë° ë°”ë‹¥ìˆ˜í‰ / ë‹¨ì—´ì‹œê³µ ì–‘í˜¸','ë°”ë‹¥ ë‚œë°© ì—´í™”ìƒ ê²°ê³¼ ì˜¨ë„ ë¶„í¬ ì–‘í˜¸','ë°”ë‹¥ë¬¼ê³ ì„ í™•ì¸/ì´ìƒì—†ìŒ'].map(result => {
                                const escaped = result.replace(/'/g, '&apos;');
                                return `
                                <button type="button" class="touch-btn ${item.inspection === result ? 'selected' : ''}" 
                                        onclick="updateEquipmentInspection(${item.id}, '${escaped}')">
                                    ${result}
                                </button>
                            `}).join('')}
                        </div>
                        <input type="text" class="form-input" value="${item.inspection || ''}" 
                               onchange="updateEquipmentInspection(${item.id}, this.value)" 
                               placeholder="ë˜ëŠ” ì§ì ‘ ì…ë ¥">
                    </div>

                    <div class="form-field">
                        <label class="form-label">ğŸ“· ìœ„ì¹˜ë³„ ì‚¬ì§„ ì´¬ì˜/ì²¨ë¶€ (${Object.values(item.photos).filter(p => p).length}/4)</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                            ${locations.slice(0, 2).map(location => `
                                <div style="border: 2px solid ${locationColors[location]}; border-radius: 8px; overflow: hidden;">
                                    <div style="background: ${locationColors[location]}; color: white; padding: 10px; text-align: center; font-weight: bold; font-size: 15px;">
                                        ${locationIcons[location]} ${location}
                                    </div>
                                    ${item.photos[location] ? `
                                        <img src="${item.photos[location]}" style="width: 100%; height: 220px; object-fit: cover;">
                                        <div style="display: flex; border-top: 1px solid #ddd;">
                                            <button class="btn btn-secondary" onclick="openEquipmentLocationCamera(${item.id}, '${location}')" style="flex: 1; border-radius: 0; border: none; padding: 12px; font-size: 13px;">
                                                ğŸ”„
                                            </button>
                                            <button class="btn btn-secondary" onclick="openEquipmentLocationGallery(${item.id}, '${location}')" style="flex: 1; border-radius: 0; border: none; border-left: 1px solid #ddd; padding: 12px; font-size: 13px;">
                                                ğŸ–¼ï¸
                                            </button>
                                            <button class="btn btn-danger" onclick="deleteEquipmentLocationPhoto(${item.id}, '${location}')" style="flex: 1; border-radius: 0; border: none; border-left: 1px solid #ddd; padding: 12px; font-size: 13px;">
                                                ğŸ—‘ï¸
                                            </button>
                                        </div>
                                    ` : `
                                        <div style="height: 220px; background: #f8f9fa; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 12px;">
                                            <div style="font-size: 36px; opacity: 0.3;">ğŸ“·</div>
                                            <div style="display: flex; gap: 10px; width: 100%; padding: 0 12px;">
                                                <button class="btn btn-primary" onclick="openEquipmentLocationCamera(${item.id}, '${location}')" style="flex: 1; padding: 14px 10px; font-size: 14px; font-weight: bold;">
                                                    ğŸ“¸ ì´¬ì˜
                                                </button>
                                                <button class="btn btn-primary" onclick="openEquipmentLocationGallery(${item.id}, '${location}')" style="flex: 1; padding: 14px 10px; font-size: 14px; font-weight: bold;">
                                                    ğŸ–¼ï¸ ì²¨ë¶€
                                                </button>
                                            </div>
                                        </div>
                                    `}
                                </div>
                            `).join('')}
                        </div>
                        <!-- ë°”ë‹¥ ì‚¬ì§„ (2ì¹¸ ê·¸ë¦¬ë“œ) -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            ${locations.slice(2, 4).map(location => `
                                <div style="border: 2px solid ${locationColors[location]}; border-radius: 8px; overflow: hidden;">
                                    <div style="background: ${locationColors[location]}; color: white; padding: 8px; text-align: center; font-weight: bold; font-size: 13px;">
                                        ${locationIcons[location]} ${location}
                                    </div>
                                    ${item.photos[location] ? `
                                        <img src="${item.photos[location]}" style="width: 100%; height: 200px; object-fit: cover;">
                                        <div style="display: flex; border-top: 1px solid #ddd;">
                                            <button class="btn btn-secondary" onclick="openEquipmentLocationCamera(${item.id}, '${location}')" style="flex: 1; border-radius: 0; border: none; padding: 10px; font-size: 12px;">
                                                ğŸ”„
                                            </button>
                                            <button class="btn btn-secondary" onclick="openEquipmentLocationGallery(${item.id}, '${location}')" style="flex: 1; border-radius: 0; border: none; border-left: 1px solid #ddd; padding: 10px; font-size: 12px;">
                                                ğŸ–¼ï¸
                                            </button>
                                            <button class="btn btn-danger" onclick="deleteEquipmentLocationPhoto(${item.id}, '${location}')" style="flex: 1; border-radius: 0; border: none; border-left: 1px solid #ddd; padding: 10px; font-size: 12px;">
                                                ğŸ—‘ï¸
                                            </button>
                                        </div>
                                    ` : `
                                        <div style="height: 200px; background: #f8f9fa; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px;">
                                            <div style="font-size: 32px; opacity: 0.3;">ğŸ“·</div>
                                            <div style="display: flex; gap: 10px; width: 100%; padding: 0 12px;">
                                                <button class="btn btn-primary" onclick="openEquipmentLocationCamera(${item.id}, '${location}')" style="flex: 1; padding: 10px; font-size: 12px;">
                                                    ğŸ“¸ ì´¬ì˜
                                                </button>
                                                <button class="btn btn-primary" onclick="openEquipmentLocationGallery(${item.id}, '${location}')" style="flex: 1; padding: 10px; font-size: 12px;">
                                                    ğŸ–¼ï¸ ì²¨ë¶€
                                                </button>
                                            </div>
                                        </div>
                                    `}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            }).join('');
        }

        function updateEquipment(id, field, value) {
            const item = projectData.equipment.find(e => e.id === id);
            if (item) {
                item[field] = value;
                saveWithDebounce(); // âœ… í…ìŠ¤íŠ¸: ì§€ì—° ì €ì¥
            }
        }

        window.updateEquipmentInspection = function(id, value) {
            const item = projectData.equipment.find(e => e.id === id);
            if (item) {
                item.inspection = value;
                renderEquipment();
                saveWithDebounce(); // âœ… í…ìŠ¤íŠ¸: ì§€ì—° ì €ì¥
            }
        }

        window.toggleEquipmentSpace = function(id, space) {
            const item = projectData.equipment.find(e => e.id === id);
            if (!item) return;
            
            // spaces ë°°ì—´ ì´ˆê¸°í™” (í•˜ìœ„ í˜¸í™˜ì„±)
            if (!item.spaces) {
                item.spaces = item.space ? [item.space] : [];
                delete item.space; // ê¸°ì¡´ ë‹¨ì¼ space í•„ë“œ ì œê±°
            }
            
            const index = item.spaces.indexOf(space);
            if (index > -1) {
                // ì´ë¯¸ ì„ íƒë˜ì–´ ìˆìœ¼ë©´ ì œê±°
                item.spaces.splice(index, 1);
            } else {
                // ì„ íƒë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´ ì¶”ê°€ (ìµœëŒ€ 2ê°œê¹Œì§€)
                if (item.spaces.length < 2) {
                    item.spaces.push(space);
                } else {
                    showToast('ìµœëŒ€ 2ê°œê¹Œì§€ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤');
                    return;
                }
            }
            
            renderEquipment();
            saveWithDebounce(); // âœ… ì„ íƒ: ì§€ì—° ì €ì¥
        }

        window.openEquipmentLocationCamera = function(id, location) {
            currentPhotoTarget = { equipmentId: id, location: location };
            openCamera();
        }

        window.openEquipmentLocationGallery = async function(id, location) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (file) {
                    const compressed = await compressImage(file);
                    const item = projectData.equipment.find(e => e.id === id);
                    if (item) {
                        if (!item.photos) {
                            item.photos = {
                                'ì¢Œì¸¡ìƒë‹¨': null,
                                'ì¢Œì¸¡í•˜ë‹¨': null,
                                'ìš°ì¸¡ìƒë‹¨': null,
                                'ìš°ì¸¡í•˜ë‹¨': null
                            };
                        }
                        item.photos[location] = compressed;
                        renderEquipment();
                        saveProjectsToLocalStorage();
                        updateProgress();
                        showToast(`${location} ì‚¬ì§„ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤`);
                    }
                }
            };
            input.click();
        }

        window.deleteEquipmentLocationPhoto = function(id, location) {
            if (confirm(`${location} ì‚¬ì§„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                const item = projectData.equipment.find(e => e.id === id);
                if (item && item.photos) {
                    item.photos[location] = null;
                    renderEquipment();
                    saveProjectsToLocalStorage();
                    updateProgress();
                    showToast(`${location} ì‚¬ì§„ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤`);
                }
            }
        }

        window.deleteEquipment = function(id) {
            if (confirm('ì´ ì¥ë¹„ì ê²€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                projectData.equipment = projectData.equipment.filter(e => e.id !== id);
                renderEquipment();
                saveProjectsToLocalStorage();
                updateProgress();
                showToast('ì¥ë¹„ì ê²€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
            }
        }

        function openEquipmentCamera(id) {
            currentPhotoTarget = { equipmentId: id };
            openCamera();
        }

        async function openEquipmentGallery(id) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (file) {
                    const compressed = await compressImage(file);
                    const item = projectData.equipment.find(e => e.id === id);
                    if (item) {
                        item.photo = compressed;
                        renderEquipment();
                        saveProjectsToLocalStorage();
                        showToast('ì‚¬ì§„ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
                    }
                }
            };
            input.click();
        }

        function deleteEquipmentPhoto(id) {
            if (confirm('ì‚¬ì§„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                const item = projectData.equipment.find(e => e.id === id);
                if (item) {
                    item.photo = null;
                    renderEquipment();
                    saveProjectsToLocalStorage();
                    showToast('ì‚¬ì§„ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
                }
            }
        }

        // ==================== ê³µê¸°ì§ˆ ì¸¡ì • ====================
        function renderAirQuality() {
            const container = document.getElementById('airQualityList');
            
            if (projectData.airQuality.length === 0) {
                projectData.airQuality = [
                    { id: 1, name: 'ê±°ì‹¤', radon: '', formaldehyde: '', vocs: '' },
                    { id: 2, name: 'ì¹¨ì‹¤1', radon: '', formaldehyde: '', vocs: '' },
                    { id: 3, name: 'ì¹¨ì‹¤2', radon: '', formaldehyde: '', vocs: '' },
                    { id: 4, name: 'ì¹¨ì‹¤3', radon: '', formaldehyde: '', vocs: '' },
                    { id: 5, name: 'ê³µìš©ìš•ì‹¤', radon: '', formaldehyde: '', vocs: '' },
                    { id: 6, name: 'ë¶€ë¶€ìš•ì‹¤', radon: '', formaldehyde: '', vocs: '' }
                ];
                // í”„ë¡œì íŠ¸ë³„ ì¹´ìš´í„° ì„¤ì •
                const project = getCurrentProject();
                project.lastAirQualityId = 6;
            }

            container.innerHTML = projectData.airQuality.map((room) => `
                <div class="air-quality-card">
                    <div class="air-room-header">
                        <input type="text" 
                               class="air-room-name-input" 
                               value="${room.name}" 
                               onchange="updateAirRoomName(${room.id}, this.value)"
                               placeholder="ë°© ì´ë¦„">
                        <button class="air-room-delete" onclick="deleteAirRoom(${room.id})">Ã—</button>
                    </div>
                    <div class="air-inputs">
                        <div class="air-input-group">
                            <label>ë¼ëˆ</label>
                            <input type="number" 
                                   value="${room.radon}" 
                                   onchange="updateAirQualityValue(${room.id}, 'radon', this.value)"
                                   placeholder="0">
                            <span>Bq/mÂ³</span>
                        </div>
                        <div class="air-input-group">
                            <label>í¬ë¦„ì•Œë°íˆë“œ</label>
                            <input type="number" 
                                   step="0.001"
                                   value="${room.formaldehyde}" 
                                   onchange="updateAirQualityValue(${room.id}, 'formaldehyde', this.value)"
                                   placeholder="0.000">
                            <span>mg/mÂ³</span>
                        </div>
                        <div class="air-input-group">
                            <label>ì´VOCs</label>
                            <input type="number" 
                                   step="0.001"
                                   value="${room.vocs}" 
                                   onchange="updateAirQualityValue(${room.id}, 'vocs', this.value)"
                                   placeholder="0.000">
                            <span>mg/mÂ³</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        window.addAirQualityRoom = function() {
            // âœ… í”„ë¡œì íŠ¸ë³„ ID ì¹´ìš´í„° ì‚¬ìš©
            const project = getCurrentProject();
            
            // ê¸°ì¡´ ìµœëŒ€ ID í™•ì¸ (í˜¸í™˜ì„± ë³´ì¥)
            const maxExistingId = project.airQuality && project.airQuality.length > 0 
                ? Math.max(...project.airQuality.map(a => a.id))
                : 0;
            
            // í”„ë¡œì íŠ¸ë³„ ì¹´ìš´í„° ì—…ë°ì´íŠ¸
            project.lastAirQualityId = Math.max(
                project.lastAirQualityId || 0,
                maxExistingId
            ) + 1;
            
            const newRoom = {
                id: project.lastAirQualityId,
                name: `ë°©${projectData.airQuality.length + 1}`,
                radon: '',
                formaldehyde: '',
                vocs: ''
            };
            projectData.airQuality.push(newRoom);
            renderAirQuality();
            saveProjectsToLocalStorage();
            updateProgress();
            showToast('ë°©ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
        }

        window.deleteAirRoom = function(id) {
            if (projectData.airQuality.length <= 1) {
                alert('ìµœì†Œ 1ê°œì˜ ë°©ì€ ìˆì–´ì•¼ í•©ë‹ˆë‹¤');
                return;
            }
            if (confirm('ì´ ë°©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                projectData.airQuality = projectData.airQuality.filter(r => r.id !== id);
                renderAirQuality();
                saveProjectsToLocalStorage();
                updateProgress();
                showToast('ë°©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
            }
        }

        function updateAirRoomName(id, name) {
            const room = projectData.airQuality.find(r => r.id === id);
            if (room) {
                room.name = name;
                saveWithDebounce(); // âœ… í…ìŠ¤íŠ¸: ì§€ì—° ì €ì¥
            }
        }

        function updateAirQualityValue(id, field, value) {
            const room = projectData.airQuality.find(r => r.id === id);
            if (room) {
                // âœ… ì…ë ¥ê°’ ê²€ì¦
                const numValue = parseFloat(value);
                
                // ë¹ˆê°’ì€ í—ˆìš©
                if (value === '' || value === null) {
                    room[field] = value;
                    saveWithDebounce(); // âœ… ìˆ«ì ì…ë ¥: ì§€ì—° ì €ì¥
                    updateProgress();
                    return;
                }
                
                // ìŒìˆ˜ ì²´í¬
                if (numValue < 0) {
                    alert('âš ï¸ ìŒìˆ˜ëŠ” ì…ë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    renderAirQuality(); // ì›ë˜ ê°’ìœ¼ë¡œ ë³µì›
                    return;
                }
                
                // ë¹„í˜„ì‹¤ì  ê°’ ì²´í¬
                let maxValue = 1000;
                let fieldName = '';
                
                if (field === 'radon') {
                    maxValue = 500; // ë¼ëˆ ê¶Œê³ ê¸°ì¤€ì˜ ì•½ 3ë°°
                    fieldName = 'ë¼ëˆ';
                } else if (field === 'formaldehyde') {
                    maxValue = 2; // í¬ë¦„ì•Œë°íˆë“œ ê¶Œê³ ê¸°ì¤€ì˜ ì•½ 10ë°°
                    fieldName = 'í¬ë¦„ì•Œë°íˆë“œ';
                } else if (field === 'vocs') {
                    maxValue = 5; // VOCs ê¶Œê³ ê¸°ì¤€ì˜ ì•½ 10ë°°
                    fieldName = 'ì´íœ˜ë°œì„±ìœ ê¸°í™”í•©ë¬¼';
                }
                
                if (numValue > maxValue) {
                    if (!confirm(`âš ï¸ ${fieldName} ì¸¡ì •ê°’ì´ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤ (${numValue}).\n\nì •í™•íˆ ì…ë ¥í•˜ì…¨ë‚˜ìš”?\n\nê³„ì†í•˜ë ¤ë©´ "í™•ì¸"ì„ ëˆ„ë¥´ì„¸ìš”.`)) {
                        renderAirQuality(); // ì›ë˜ ê°’ìœ¼ë¡œ ë³µì›
                        return;
                    }
                }
                
                room[field] = value;
                saveWithDebounce(); // âœ… ìˆ«ì ì…ë ¥: ì§€ì—° ì €ì¥
                updateProgress();
            }
        }

        // ==================== ì¹´ë©”ë¼ ê¸°ëŠ¥ ====================
        async function openCamera() {
            try {
                // ì¹´ë©”ë¼ API ì§€ì› í™•ì¸
                if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                    throw new Error('ì´ ë¸Œë¼ìš°ì €ëŠ” ì¹´ë©”ë¼ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Chromeì´ë‚˜ Safarië¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
                }
                
                // ë””ë°”ì´ìŠ¤ë³„ ìµœì  ì¹´ë©”ë¼ ì„¤ì •
                let constraints = {
                    video: {
                        facingMode: 'environment'
                    },
                    audio: false
                };
                
                // ì•ˆë“œë¡œì´ë“œ: ê³ í•´ìƒë„
                if (deviceInfo.isAndroid) {
                    constraints.video.width = { ideal: 1920 };
                    constraints.video.height = { ideal: 1080 };
                }
                // iOS: ì¤‘ê°„ í•´ìƒë„ (ë°°í„°ë¦¬/ì„±ëŠ¥ ìµœì í™”)
                else if (deviceInfo.isIOS) {
                    constraints.video.width = { ideal: 1280 };
                    constraints.video.height = { ideal: 720 };
                }
                // ê¸°íƒ€ ë°ìŠ¤í¬í†±
                else {
                    constraints.video.width = { ideal: 1920 };
                    constraints.video.height = { ideal: 1080 };
                }
                
                cameraStream = await navigator.mediaDevices.getUserMedia(constraints);
                
                const video = document.getElementById('cameraPreview');
                video.srcObject = cameraStream;
                
                // iOS Safari í•„ìˆ˜ ì†ì„±
                video.setAttribute('playsinline', 'true');
                video.setAttribute('webkit-playsinline', 'true');
                video.setAttribute('autoplay', 'true');
                video.muted = true;
                
                // ë¹„ë””ì˜¤ ë¡œë“œ ë° ì¬ìƒ ëŒ€ê¸° (iOS í•„ìˆ˜)
                await new Promise((resolve) => {
                    video.onloadedmetadata = () => {
                        video.play()
                            .then(() => {
                                console.log('ì¹´ë©”ë¼ ìŠ¤íŠ¸ë¦¼ ì¬ìƒ ì„±ê³µ');
                                resolve();
                            })
                            .catch(err => {
                                console.warn('ë¹„ë””ì˜¤ ìë™ ì¬ìƒ ì‹¤íŒ¨:', err);
                                resolve(); // ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰
                            });
                    };
                    
                    // íƒ€ì„ì•„ì›ƒ (3ì´ˆ)
                    setTimeout(resolve, 3000);
                });
                
                // === ëª¨ë“  í”Œë«í¼ ê³µí†µ: ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ì°¨ë‹¨ ===
                video.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    return false;
                }, { passive: false });
                
                // === í„°ì¹˜ ì´ë²¤íŠ¸ ìµœì í™” (Android/iOS ëª¨ë‘) ===
                let touchStartTime = 0;
                let touchStartX = 0;
                let touchStartY = 0;
                
                // í•€ì¹˜ì¤Œ ë³€ìˆ˜ ì¶”ê°€
                let currentZoom = 1.0;
                window.currentZoom = 1.0; // ì „ì—­ ë³€ìˆ˜ë¡œë„ ì„¤ì • (capturePhotoì—ì„œ ì ‘ê·¼)
                let initialDistance = 0;
                let initialZoom = 1.0;
                const videoTrack = cameraStream.getVideoTracks()[0];
                const capabilities = videoTrack.getCapabilities();
                
                // ì¤Œ ë ˆë²¨ í‘œì‹œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
                const updateZoomDisplay = () => {
                    document.getElementById('zoomLevel').textContent = `ì¤Œ: ${currentZoom.toFixed(1)}x`;
                };
                
                // ==================== ì¤Œ ì ìš© í•¨ìˆ˜ (CSS ì¤Œë§Œ ì‚¬ìš©) ====================
                // í•˜ë“œì›¨ì–´ ì¤Œ ì œê±° - ë¹„ë™ê¸° ì²˜ë¦¬ë¡œ ì¸í•œ ë–¨ë¦¼ ë¬¸ì œ í•´ê²°
                const applyZoom = (zoom) => {
                    currentZoom = Math.max(1.0, Math.min(zoom, 5.0));
                    window.currentZoom = currentZoom; // ì „ì—­ ë³€ìˆ˜ ë™ê¸°í™”
                    
                    // CSS ì¤Œë§Œ ì‚¬ìš© (ë™ê¸°ì‹, ì•ˆì •ì )
                    video.style.transform = `scale(${currentZoom})`;
                    
                    updateZoomDisplay();
                };
                // ==================== ì¤Œ ì ìš© í•¨ìˆ˜ ë ====================
                
                // ë‘ í„°ì¹˜ í¬ì¸íŠ¸ ê°„ ê±°ë¦¬ ê³„ì‚°
                const getDistance = (touch1, touch2) => {
                    const dx = touch1.clientX - touch2.clientX;
                    const dy = touch1.clientY - touch2.clientY;
                    return Math.sqrt(dx * dx + dy * dy);
                };
                
                // í•€ì¹˜ì¤Œ ë²„íŠ¼ ì¶”ê°€
                window.adjustZoom = (delta) => {
                    applyZoom(currentZoom + delta);
                };
                
                // ì¤Œ ì´ˆê¸°í™” í•¨ìˆ˜ (ì‚¬ì§„ ì´¬ì˜ í›„ í˜¸ì¶œ)
                window.resetZoom = () => {
                    applyZoom(1.0);
                };
                
                // ==================== í„°ì¹˜ í¬ì¸íŠ¸ ë§ˆì»¤ ê¸°ëŠ¥ ====================
                // ë§ˆì»¤ ì €ì¥ ë°°ì—´
                const markers = [];
                
                // ë§ˆì»¤ ìº”ë²„ìŠ¤ ì„¤ì •
                const markerCanvas = document.getElementById('markerCanvas');
                const markerCtx = markerCanvas.getContext('2d');
                
                // ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ ë¹„ë””ì˜¤ì— ë§ì¶¤
                const resizeMarkerCanvas = () => {
                    const rect = video.getBoundingClientRect();
                    markerCanvas.width = rect.width;
                    markerCanvas.height = rect.height;
                    redrawMarkers();
                };
                
                // ë§ˆì»¤ ê·¸ë¦¬ê¸° í•¨ìˆ˜
                const drawMarker = (x, y) => {
                    markerCtx.strokeStyle = '#ef4444'; // ë¹¨ê°•ìƒ‰
                    markerCtx.lineWidth = 3;
                    markerCtx.beginPath();
                    markerCtx.arc(x, y, 30, 0, 2 * Math.PI);
                    markerCtx.stroke();
                    
                    // ì¤‘ì‹¬ì 
                    markerCtx.fillStyle = '#ef4444';
                    markerCtx.beginPath();
                    markerCtx.arc(x, y, 5, 0, 2 * Math.PI);
                    markerCtx.fill();
                };
                
                // ëª¨ë“  ë§ˆì»¤ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
                const redrawMarkers = () => {
                    markerCtx.clearRect(0, 0, markerCanvas.width, markerCanvas.height);
                    markers.forEach(marker => drawMarker(marker.x, marker.y));
                };
                
                // ë§ˆì»¤ ì´ˆê¸°í™” í•¨ìˆ˜
                window.clearMarkers = () => {
                    markers.length = 0;
                    markerCtx.clearRect(0, 0, markerCanvas.width, markerCanvas.height);
                };
                
                // ë§ˆì»¤ ë°°ì—´ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜ (capturePhotoì—ì„œ ì‚¬ìš©)
                window.getMarkers = () => {
                    return markers.map(m => ({
                        x: m.x / markerCanvas.width,
                        y: m.y / markerCanvas.height
                    }));
                };
                
                // ì´ˆê¸° ìº”ë²„ìŠ¤ í¬ê¸° ì„¤ì •
                setTimeout(resizeMarkerCanvas, 100);
                
                // í™”ë©´ íšŒì „/í¬ê¸° ë³€ê²½ ì‹œ ìº”ë²„ìŠ¤ í¬ê¸° ì¬ì¡°ì •
                window.addEventListener('resize', resizeMarkerCanvas);
                // ==================== í„°ì¹˜ í¬ì¸íŠ¸ ë§ˆì»¤ ê¸°ëŠ¥ ë ====================
                
                // ==================== í•€ì¹˜ì¤Œ throttling ë³€ìˆ˜ ====================
                let lastZoomTime = 0;
                const ZOOM_THROTTLE_MS = 16; // ì•½ 60fps (1000ms / 60 = 16.67ms)
                let baseZoom = 1.0; // í•€ì¹˜ ì‹œì‘ ì‹œì ì˜ ì¤Œ (ì ˆëŒ€ê°’ ê¸°ì¤€)
                // ==================== í•€ì¹˜ì¤Œ throttling ë³€ìˆ˜ ë ====================
                
                video.addEventListener('touchstart', (e) => {
                    touchStartTime = Date.now();
                    
                    if (e.touches.length === 2) {
                        // í•€ì¹˜ì¤Œ ì‹œì‘
                        e.preventDefault();
                        initialDistance = getDistance(e.touches[0], e.touches[1]);
                        baseZoom = currentZoom; // í˜„ì¬ ì¤Œì„ baseë¡œ ì €ì¥
                    } else if (e.touches.length === 1) {
                        touchStartX = e.touches[0].clientX;
                        touchStartY = e.touches[0].clientY;
                    }
                }, { passive: false });
                
                video.addEventListener('touchmove', (e) => {
                    if (e.touches.length === 2) {
                        // í•€ì¹˜ì¤Œ ë™ì‘
                        e.preventDefault();
                        
                        // ==================== throttling ì ìš© ====================
                        const now = Date.now();
                        if (now - lastZoomTime < ZOOM_THROTTLE_MS) {
                            return; // ë„ˆë¬´ ë¹ ë¥¸ í˜¸ì¶œì€ ë¬´ì‹œ
                        }
                        lastZoomTime = now;
                        // ==================== throttling ë ====================
                        
                        const currentDistance = getDistance(e.touches[0], e.touches[1]);
                        const scale = currentDistance / initialDistance;
                        
                        // ==================== ë¯¸ì„¸ ë³€í™” í•„í„°ë§ ====================
                        // scale ë³€í™”ê°€ 3% ë¯¸ë§Œì´ë©´ ë¬´ì‹œ (ë–¨ë¦¼ ë°©ì§€)
                        const changePercent = Math.abs(scale - 1.0);
                        if (changePercent < 0.03) {
                            return; // ë„ˆë¬´ ì‘ì€ ë³€í™”ëŠ” ë¬´ì‹œ
                        }
                        // ==================== ë¯¸ì„¸ ë³€í™” í•„í„°ë§ ë ====================
                        
                        // ==================== ì ˆëŒ€ê°’ ê¸°ì¤€ ì¤Œ ê³„ì‚° ====================
                        // baseZoom(ê³ ì •) * scale(ë³€í™”ìœ¨) = ì •í™•í•œ ëª©í‘œ ì¤Œ
                        const targetZoom = baseZoom * scale;
                        applyZoom(targetZoom);
                        // ==================== ì ˆëŒ€ê°’ ê¸°ì¤€ ì¤Œ ë ====================
                    } else if (e.touches.length === 1) {
                        // ë“œë˜ê·¸/ìŠ¤í¬ë¡¤ ì°¨ë‹¨
                        const moveX = Math.abs(e.touches[0].clientX - touchStartX);
                        const moveY = Math.abs(e.touches[0].clientY - touchStartY);
                        
                        if (moveX > 10 || moveY > 10) {
                            e.preventDefault();
                            e.stopPropagation();
                        }
                    }
                }, { passive: false });
                
                video.addEventListener('touchend', (e) => {
                    const touchDuration = Date.now() - touchStartTime;
                    
                    // ê¸¸ê²Œ ëˆ„ë¥´ê¸° ì°¨ë‹¨ (Google Lens ì‹¤í–‰ ë°©ì§€)
                    if (touchDuration > 500) {
                        e.preventDefault();
                        e.stopPropagation();
                        return;
                    }
                    
                    // ==================== í„°ì¹˜ í¬ì¸íŠ¸ ë§ˆì»¤ ì¶”ê°€ ====================
                    // ì§§ì€ íƒ­ + ì‹±ê¸€ í„°ì¹˜ + ë“œë˜ê·¸ ì•„ë‹˜ + ì¤Œ ì•ˆí•¨ = ë§ˆì»¤ ì¶”ê°€
                    if (e.changedTouches.length === 1 && touchDuration < 500 && currentZoom === 1.0) {
                        const touch = e.changedTouches[0];
                        const moveX = Math.abs(touch.clientX - touchStartX);
                        const moveY = Math.abs(touch.clientY - touchStartY);
                        
                        // ë“œë˜ê·¸ê°€ ì•„ë‹Œ ê²½ìš°ë§Œ ë§ˆì»¤ ì¶”ê°€ (ì´ë™ ê±°ë¦¬ 10px ë¯¸ë§Œ)
                        if (moveX < 10 && moveY < 10) {
                            const rect = video.getBoundingClientRect();
                            const x = touch.clientX - rect.left;
                            const y = touch.clientY - rect.top;
                            
                            // ë§ˆì»¤ ì¶”ê°€ (ìµœëŒ€ 10ê°œê¹Œì§€)
                            if (markers.length < 10) {
                                markers.push({ x, y });
                                drawMarker(x, y);
                            }
                        }
                    }
                    // ==================== í„°ì¹˜ í¬ì¸íŠ¸ ë§ˆì»¤ ì¶”ê°€ ë ====================
                }, { passive: false });
                
                // ë”ë¸” íƒ­ ì¤Œ ë°©ì§€
                let lastTap = 0;
                video.addEventListener('touchend', (e) => {
                    const currentTime = new Date().getTime();
                    const tapLength = currentTime - lastTap;
                    
                    if (tapLength < 500 && tapLength > 0) {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                    lastTap = currentTime;
                }, { passive: false });
                
                // ë“œë˜ê·¸ ë°©ì§€
                video.addEventListener('dragstart', (e) => {
                    e.preventDefault();
                    return false;
                });
                
                // iOS íŠ¹ë³„ ì²˜ë¦¬
                if (deviceInfo.isIOS) {
                    video.style.webkitUserSelect = 'none';
                    video.style.webkitTouchCallout = 'none';
                }
                
                // ëª¨ë‹¬ í‘œì‹œ
                document.getElementById('cameraModal').classList.add('active');
                
                // ì„±ê³µ ì‹œ ë©”ì‹œì§€ ì—†ìŒ
                
            } catch (error) {
                console.error('ì¹´ë©”ë¼ ì˜¤ë¥˜:', error);
                
                // ë””ë°”ì´ìŠ¤ë³„ ìƒì„¸ ì—ëŸ¬ ë©”ì‹œì§€
                let errorMessage = 'ì¹´ë©”ë¼ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n';
                
                if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {
                    errorMessage += 'ğŸ“± ì¹´ë©”ë¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.\n\n';
                    
                    if (deviceInfo.isIOS) {
                        errorMessage += '[iOS ì„¤ì • ë°©ë²•]\n';
                        errorMessage += '1. ì„¤ì • > Safari > ì¹´ë©”ë¼\n';
                        errorMessage += '2. "í—ˆìš©" ì„ íƒ\n';
                        errorMessage += '3. Safari ì¬ì‹œì‘\n\n';
                        errorMessage += 'ë˜ëŠ” "ğŸ“ ê°¤ëŸ¬ë¦¬"ë¡œ ì‚¬ì§„ ì—…ë¡œë“œ';
                    } else if (deviceInfo.isAndroid) {
                        errorMessage += '[Android ì„¤ì • ë°©ë²•]\n';
                        errorMessage += '1. ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ ì™¼ìª½ ğŸ”’ í´ë¦­\n';
                        errorMessage += '2. "ì¹´ë©”ë¼" ê¶Œí•œ í—ˆìš©\n';
                        errorMessage += '3. í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨\n\n';
                        errorMessage += 'ë˜ëŠ” "ğŸ“ ê°¤ëŸ¬ë¦¬"ë¡œ ì‚¬ì§„ ì—…ë¡œë“œ';
                    } else {
                        errorMessage += 'ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì˜ ğŸ”’ë¥¼ í´ë¦­í•˜ì—¬\n';
                        errorMessage += 'ì¹´ë©”ë¼ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.';
                    }
                    
                } else if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {
                    errorMessage += 'ì¹´ë©”ë¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n';
                    errorMessage += '"ğŸ“ ê°¤ëŸ¬ë¦¬" ë²„íŠ¼ìœ¼ë¡œ\n';
                    errorMessage += 'ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.';
                    
                } else if (error.name === 'NotReadableError' || error.name === 'TrackStartError') {
                    errorMessage += 'ì¹´ë©”ë¼ê°€ ë‹¤ë¥¸ ì•±ì—ì„œ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤.\n\n';
                    errorMessage += '[í•´ê²° ë°©ë²•]\n';
                    errorMessage += '1. ë‹¤ë¥¸ ì¹´ë©”ë¼ ì•± ì¢…ë£Œ\n';
                    errorMessage += '2. í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ (ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨)\n';
                    errorMessage += '3. "ğŸ“ ê°¤ëŸ¬ë¦¬" ë²„íŠ¼ ì‚¬ìš©';
                    
                } else if (error.name === 'OverconstrainedError') {
                    errorMessage += 'ì´ ê¸°ê¸°ëŠ” ìš”ì²­í•œ ì¹´ë©”ë¼ ì„¤ì •ì„\n';
                    errorMessage += 'ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\n';
                    errorMessage += '"ğŸ“ ê°¤ëŸ¬ë¦¬"ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.';
                    
                } else {
                    errorMessage += 'ì˜¤ë¥˜: ' + error.message + '\n\n';
                    errorMessage += '"ğŸ“ ê°¤ëŸ¬ë¦¬" ë²„íŠ¼ìœ¼ë¡œ\n';
                    errorMessage += 'ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.';
                }
                
                alert(errorMessage);
            }
        }

        window.closeCameraModal = function() {
            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
                cameraStream = null;
            }
            
            // ë§ˆì»¤ ì´ˆê¸°í™”
            if (window.clearMarkers) {
                window.clearMarkers();
            }
            
            document.getElementById('cameraModal').classList.remove('active');
            currentPhotoTarget = null;
        }

        // ==================== ì´ë¯¸ì§€ ì••ì¶• í•¨ìˆ˜ (í†µí•©) ====================
        // ==================== ì´ë¯¸ì§€ ì••ì¶• (í¬ë¡œìŠ¤ í”Œë«í¼ ìµœì í™”) ====================
        async function compressImage(input, maxWidth = 1920, quality = 0.85) {
            return new Promise((resolve, reject) => {
                try {
                    // ë””ë°”ì´ìŠ¤ë³„ ìµœì  ì„¤ì •
                    if (deviceInfo.isIOS) {
                        maxWidth = Math.min(maxWidth, 1280); // iOS ë©”ëª¨ë¦¬ ìµœì í™”
                        quality = Math.min(quality, 0.8); // ìš©ëŸ‰ ì ˆì•½
                    }
                    
                    // File ê°ì²´ ì²˜ë¦¬
                    if (input instanceof File) {
                        // iOS HEIC ì´ë¯¸ì§€ ì²˜ë¦¬
                        if (input.type === 'image/heic' || input.type === 'image/heif') {
                            console.warn('HEIC í˜•ì‹ ê°ì§€ - JPEGë¡œ ë³€í™˜ ì‹œë„');
                        }
                        
                        const reader = new FileReader();
                        
                        reader.onerror = () => {
                            console.error('íŒŒì¼ ì½ê¸° ì‹¤íŒ¨');
                            reject(new Error('ì´ë¯¸ì§€ íŒŒì¼ì„ ì½ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'));
                        };
                        
                        reader.onload = (e) => {
                            const img = new Image();
                            
                            img.onerror = () => {
                                console.error('ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨');
                                reject(new Error('ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'));
                            };
                            
                            img.onload = () => {
                                try {
                                    const canvas = document.createElement('canvas');
                                    let width = img.width;
                                    let height = img.height;
                                    
                                    // ìµœëŒ€ ë„ˆë¹„ ì œí•œ
                                    if (width > maxWidth) {
                                        height = (height * maxWidth) / width;
                                        width = maxWidth;
                                    }
                                    
                                    // iOS: ìµœëŒ€ í”½ì…€ ì œí•œ (ë©”ëª¨ë¦¬ ì˜¤ë²„í”Œë¡œìš° ë°©ì§€)
                                    const maxPixels = deviceInfo.isIOS ? 4096 * 4096 : 8192 * 8192;
                                    if (width * height > maxPixels) {
                                        const scale = Math.sqrt(maxPixels / (width * height));
                                        width = Math.floor(width * scale);
                                        height = Math.floor(height * scale);
                                    }
                                    
                                    canvas.width = width;
                                    canvas.height = height;
                                    
                                    const ctx = canvas.getContext('2d', {
                                        alpha: false,
                                        willReadFrequently: false
                                    });
                                    
                                    // ë°°ê²½ì„ í°ìƒ‰ìœ¼ë¡œ (íˆ¬ëª… PNG ì²˜ë¦¬)
                                    ctx.fillStyle = '#FFFFFF';
                                    ctx.fillRect(0, 0, width, height);
                                    
                                    // ì´ë¯¸ì§€ ê·¸ë¦¬ê¸° (ì•ˆí‹°ì•¨ë¦¬ì–´ì‹± ìµœì í™”)
                                    ctx.imageSmoothingEnabled = true;
                                    ctx.imageSmoothingQuality = 'high';
                                    ctx.drawImage(img, 0, 0, width, height);
                                    
                                    // JPEG ë³€í™˜
                                    const result = canvas.toDataURL('image/jpeg', quality);
                                    
                                    // ë©”ëª¨ë¦¬ ì •ë¦¬
                                    canvas.width = 0;
                                    canvas.height = 0;
                                    
                                    resolve(result);
                                } catch (err) {
                                    console.error('Canvas ì²˜ë¦¬ ì‹¤íŒ¨:', err);
                                    reject(new Error('ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'));
                                }
                            };
                            
                            img.src = e.target.result;
                        };
                        
                        reader.readAsDataURL(input);
                    }
                    // DataURL ë¬¸ìì—´ ì²˜ë¦¬
                    else if (typeof input === 'string') {
                        const img = new Image();
                        
                        img.onerror = () => {
                            console.error('ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨');
                            reject(new Error('ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'));
                        };
                        
                        img.onload = () => {
                            try {
                                const canvas = document.createElement('canvas');
                                let width = img.width;
                                let height = img.height;
                                
                                // ìµœëŒ€ ë„ˆë¹„ ì œí•œ
                                if (width > maxWidth) {
                                    height = (height * maxWidth) / width;
                                    width = maxWidth;
                                }
                                
                                // iOS ë©”ëª¨ë¦¬ ì œí•œ
                                const maxPixels = deviceInfo.isIOS ? 4096 * 4096 : 8192 * 8192;
                                if (width * height > maxPixels) {
                                    const scale = Math.sqrt(maxPixels / (width * height));
                                    width = Math.floor(width * scale);
                                    height = Math.floor(height * scale);
                                }
                                
                                canvas.width = width;
                                canvas.height = height;
                                
                                const ctx = canvas.getContext('2d', {
                                    alpha: false,
                                    willReadFrequently: false
                                });
                                
                                ctx.fillStyle = '#FFFFFF';
                                ctx.fillRect(0, 0, width, height);
                                ctx.imageSmoothingEnabled = true;
                                ctx.imageSmoothingQuality = 'high';
                                ctx.drawImage(img, 0, 0, width, height);
                                
                                const result = canvas.toDataURL('image/jpeg', quality);
                                
                                // ë©”ëª¨ë¦¬ ì •ë¦¬
                                canvas.width = 0;
                                canvas.height = 0;
                                
                                resolve(result);
                            } catch (err) {
                                console.error('Canvas ì²˜ë¦¬ ì‹¤íŒ¨:', err);
                                reject(new Error('ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'));
                            }
                        };
                        
                        // CORS ì´ìŠˆ ë°©ì§€
                        img.crossOrigin = 'anonymous';
                        img.src = input;
                    } else {
                        reject(new Error('ì§€ì›í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ í˜•ì‹ì…ë‹ˆë‹¤.'));
                    }
                } catch (err) {
                    console.error('ì´ë¯¸ì§€ ì••ì¶• ì˜¤ë¥˜:', err);
                    reject(err);
                }
            });
        }

        window.capturePhoto = async function() {
            // ì´ë²¤íŠ¸ ì „íŒŒ ë°©ì§€
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            const video = document.getElementById('cameraPreview');
            const canvas = document.createElement('canvas');
            
            // ==================== ì¤Œ ì ìš©ëœ ì˜ì—­ í¬ë¡­ ====================
            // currentZoom ê°’ ê°€ì ¸ì˜¤ê¸° (ì¹´ë©”ë¼ ëª¨ë‹¬ì—ì„œ ì„¤ì •ëœ ê°’)
            const zoomLevel = window.currentZoom || 1.0;
            
            if (zoomLevel > 1.0) {
                // ì¤Œì´ ì ìš©ëœ ê²½ìš°: ì¤‘ì•™ ì˜ì—­ë§Œ í¬ë¡­
                const cropWidth = video.videoWidth / zoomLevel;
                const cropHeight = video.videoHeight / zoomLevel;
                const cropX = (video.videoWidth - cropWidth) / 2;
                const cropY = (video.videoHeight - cropHeight) / 2;
                
                // ìº”ë²„ìŠ¤ í¬ê¸°ëŠ” ì›ë³¸ í¬ê¸°ë¡œ ì„¤ì • (í™”ì§ˆ ìœ ì§€)
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                
                const ctx = canvas.getContext('2d');
                // í¬ë¡­ëœ ì˜ì—­ì„ ì „ì²´ ìº”ë²„ìŠ¤ì— í™•ëŒ€í•˜ì—¬ ê·¸ë¦¬ê¸°
                ctx.drawImage(
                    video,
                    cropX, cropY, cropWidth, cropHeight, // ì†ŒìŠ¤ ì˜ì—­ (í¬ë¡­)
                    0, 0, canvas.width, canvas.height     // ëª©ì ì§€ ì˜ì—­ (ì „ì²´)
                );
            } else {
                // ì¤Œì´ ì—†ëŠ” ê²½ìš°: ì „ì²´ ì˜ì—­ ìº¡ì²˜
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(video, 0, 0);
            }
            // ==================== ì¤Œ ì ìš©ëœ ì˜ì—­ í¬ë¡­ ë ====================
            
            // ==================== ë§ˆì»¤ ì˜¤ë²„ë ˆì´ ê·¸ë¦¬ê¸° ====================
            const ctx = canvas.getContext('2d');
            const markerCanvas = document.getElementById('markerCanvas');
            const markers = window.getMarkers ? window.getMarkers() : [];
            
            if (markers.length > 0) {
                // ë§ˆì»¤ë¥¼ ë¹„ë””ì˜¤ í•´ìƒë„ì— ë§ê²Œ ê·¸ë¦¬ê¸°
                markers.forEach(marker => {
                    const x = marker.x * canvas.width;
                    const y = marker.y * canvas.height;
                    const radius = 30 * (canvas.width / markerCanvas.width);
                    
                    // ì›í˜• ë§ˆì»¤
                    ctx.strokeStyle = '#ef4444';
                    ctx.lineWidth = 3 * (canvas.width / markerCanvas.width);
                    ctx.beginPath();
                    ctx.arc(x, y, radius, 0, 2 * Math.PI);
                    ctx.stroke();
                    
                    // ì¤‘ì‹¬ì 
                    ctx.fillStyle = '#ef4444';
                    ctx.beginPath();
                    ctx.arc(x, y, 5 * (canvas.width / markerCanvas.width), 0, 2 * Math.PI);
                    ctx.fill();
                });
                
                // ë§ˆì»¤ ì´ˆê¸°í™”
                if (window.clearMarkers) {
                    window.clearMarkers();
                }
            }
            // ==================== ë§ˆì»¤ ì˜¤ë²„ë ˆì´ ê·¸ë¦¬ê¸° ë ====================
            
            // ì›ë³¸ ì´ë¯¸ì§€
            const originalImage = canvas.toDataURL('image/jpeg', 0.95);
            
            // ì´ë¯¸ì§€ ì••ì¶• (1920px, í’ˆì§ˆ 85%)
            const imageData = await compressImage(originalImage, 1920, 0.85);
            
            if (currentPhotoTarget === 'floorplan') {
                const project = getCurrentProject(); // âœ… í˜„ì¬ í”„ë¡œì íŠ¸ ê°€ì ¸ì˜¤ê¸°
                project.floorplan = imageData; // âœ… í˜„ì¬ í”„ë¡œì íŠ¸ì— ì €ì¥
                displayFloorplan();
                showToast('í‰ë©´ë„ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤');
            } else if (currentPhotoTarget && typeof currentPhotoTarget === 'object') {
                if (currentPhotoTarget.defectId) {
                    // í•˜ìì ê²€ ì‚¬ì§„
                    const defect = projectData.defects.find(d => d.id === currentPhotoTarget.defectId);
                    if (defect) {
                        // ê°œë³„ ì‚¬ì§„ êµì²´ (ì¬ì´¬ì˜)
                        if (currentPhotoTarget.photoIndex !== undefined) {
                            defect.photos[currentPhotoTarget.photoIndex] = imageData;
                            const photoName = currentPhotoTarget.photoType === 'far' ? 'ì›ê²½' : 'ê·¼ê²½';
                            showToast(`âœ“ ${photoName} ì‚¬ì§„ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                        } else {
                            // ì¼ë°˜ ì´¬ì˜ (ìƒˆë¡œ ì¶”ê°€)
                            defect.photos.push(imageData);
                        }
                        
                        renderDefects();
                    }
                } else if (currentPhotoTarget.equipmentId) {
                    // ì¥ë¹„ì ê²€ ì‚¬ì§„
                    const equipment = projectData.equipment.find(e => e.id === currentPhotoTarget.equipmentId);
                    if (equipment) {
                        if (currentPhotoTarget.location) {
                            // ìœ„ì¹˜ë³„ ì‚¬ì§„
                            if (!equipment.photos) {
                                equipment.photos = {
                                    'ì¢Œì¸¡ìƒë‹¨': null,
                                    'ì¢Œì¸¡í•˜ë‹¨': null,
                                    'ìš°ì¸¡ìƒë‹¨': null,
                                    'ìš°ì¸¡í•˜ë‹¨': null
                                };
                            }
                            equipment.photos[currentPhotoTarget.location] = imageData;
                        } else {
                            // êµ¬ ë²„ì „ í˜¸í™˜ì„±
                            equipment.photo = imageData;
                        }
                        renderEquipment();
                    }
                }
            }
            
            saveImmediately(); // âœ… ì‚¬ì§„: ì¦‰ì‹œ ì €ì¥
            updateProgress();
            
            // ì¤Œ ì´ˆê¸°í™” (ë‹¤ìŒ ì´¬ì˜ì„ ìœ„í•´)
            if (typeof window.resetZoom === 'function') {
                window.resetZoom();
            }
            
            closeCameraModal();
        }

        function updateDefect(id, field, value) {
            const defect = projectData.defects.find(d => d.id === id);
            if (defect) {
                defect[field] = value;
                
                // ìƒì„¸ìœ„ì¹˜ ë³€ê²½ ì‹œ ìë™ ì„¤ëª… ì¬ìƒì„±
                if (field === 'detailLocation') {
                    generateAutoDescription(id);
                    renderDefects();
                }
                
                saveWithDebounce(); // âœ… í…ìŠ¤íŠ¸ ì…ë ¥: ì§€ì—° ì €ì¥
            }
        }

        window.toggleDefectSelection = function(id, field, value) {
            const defect = projectData.defects.find(d => d.id === id);
            if (!defect) return;
            
            // ë°°ì—´ì´ ì—†ìœ¼ë©´ ì´ˆê¸°í™”
            if (!defect[field]) defect[field] = [];
            
            const index = defect[field].indexOf(value);
            if (index > -1) {
                // ì´ë¯¸ ì„ íƒë˜ì–´ ìˆìœ¼ë©´ ì œê±°
                defect[field].splice(index, 1);
            } else {
                // ì„ íƒë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´ ì¶”ê°€ (ìµœëŒ€ 4ê°œê¹Œì§€)
                if (defect[field].length < 4) {
                    defect[field].push(value);
                } else {
                    showToast('ìµœëŒ€ 4ê°œê¹Œì§€ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤');
                    return;
                }
            }
            
            // ì„ íƒ í›„ ìƒì„¸ì„¤ëª… ìë™ ìƒì„±
            generateAutoDescription(id);
            
            renderDefects();
            saveWithDebounce(); // âœ… ì²´í¬ë°•ìŠ¤: ì§€ì—° ì €ì¥
        }

        // ==================== ì»¤ìŠ¤í…€ ê³µê°„ ê´€ë¦¬ ====================
        function getSpaceButtons() {
            const defaultSpaces = ['í˜„ê´€','ì•ˆë°©','ì¹¨ì‹¤1','ì¹¨ì‹¤2','ì¹¨ì‹¤3','ì¹¨ì‹¤4','ë³µë„','ê±°ì‹¤','ì£¼ë°©','íŒ¬íŠ¸ë¦¬','ì™¸ë¶€','ì•ŒíŒŒë£¸','ë°œì½”ë‹ˆ','ëŒ€í”¼ê³µê°„','ì‹¤ì™¸ê¸°ì‹¤','íŒŒìš°ë”ë£¸','ë“œë ˆìŠ¤ë£¸','ê³µìš©ìš•ì‹¤','ë¶€ë¶€ìš•ì‹¤'];
            
            // í”„ë¡œì íŠ¸ë³„ ì»¤ìŠ¤í…€ ê³µê°„ ê°€ì ¸ì˜¤ê¸°
            if (!projectData.customSpaces) {
                projectData.customSpaces = [];
            }
            
            return [...defaultSpaces, ...projectData.customSpaces];
        }

        window.addCustomSpace = function(defectId) {
            const input = document.getElementById(`customSpace${defectId}`);
            const spaceName = input.value.trim();
            
            if (!spaceName) {
                showToast('ê³µê°„ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // í”„ë¡œì íŠ¸ì— customSpaces ë°°ì—´ ì´ˆê¸°í™”
            if (!projectData.customSpaces) {
                projectData.customSpaces = [];
            }
            
            // ê¸°ì¡´ ê³µê°„ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
            const allSpaces = getSpaceButtons();
            
            // ì¤‘ë³µ ì²´í¬
            if (allSpaces.includes(spaceName)) {
                showToast('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê³µê°„ì…ë‹ˆë‹¤');
                input.value = '';
                return;
            }
            
            // í”„ë¡œì íŠ¸ì— ì»¤ìŠ¤í…€ ê³µê°„ ì €ì¥
            projectData.customSpaces.push(spaceName);
            
            // í˜„ì¬ í•˜ìì— ìë™ ì„ íƒ
            const defect = projectData.defects.find(d => d.id === defectId);
            if (defect && defect.spaces.length < 4) {
                defect.spaces.push(spaceName);
                generateAutoDescription(defectId);
            } else if (defect && defect.spaces.length >= 4) {
                showToast('âš ï¸ ê³µê°„ì€ ìµœëŒ€ 4ê°œê¹Œì§€ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤');
            }
            
            saveImmediately();
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™” ë° ì¬ë Œë”ë§
            input.value = '';
            renderDefects();
            showToast(`âœ… "${spaceName}" ê³µê°„ ì¶”ê°€ë¨`);
        }

        function generateAutoDescription(id) {
            const defect = projectData.defects.find(d => d.id === id);
            if (!defect) return;
            
            // ë°°ì—´ì´ ì—†ìœ¼ë©´ ì´ˆê¸°í™”
            if (!defect.spaces) defect.spaces = [];
            if (!defect.locations) defect.locations = [];
            if (!defect.types) defect.types = [];
            
            // ì„ íƒëœ í•­ëª©ì´ ìˆì„ ë•Œë§Œ ìë™ ìƒì„±
            if (defect.spaces.length > 0 || defect.locations.length > 0 || defect.types.length > 0 || defect.detailLocation) {
                let description = '';
                
                // 1. ê³µê°„ (ì–´ë””?)
                if (defect.spaces.length > 0) {
                    description += defect.spaces.join(', ');
                }
                
                // 2. ìœ„ì¹˜ (ë¬´ì—‡?) - í•œê¸€ ë¬¸ë²•ì— ë§ê²Œ ì •ë ¬
                if (defect.locations.length > 0) {
                    if (description) description += ' ';
                    description += sortLocationsForKorean(defect.locations);
                }
                
                // 3. ìƒì„¸ìœ„ì¹˜ (êµ¬ì²´ì ìœ¼ë¡œ ì–´ë””?)
                if (defect.detailLocation) {
                    if (description) description += ' ';
                    description += defect.detailLocation;
                }
                
                // 4. í•˜ìë‚´ìš© (ì–´ë–¤ ë¬¸ì œ?)
                if (defect.types.length > 0) {
                    if (description) description += ' ';
                    description += defect.types.join(', ');
                }
                
                defect.description = description;
            }
        }
        
        // í•œê¸€ ë¬¸ë²•ì— ë§ê²Œ ìœ„ì¹˜ë¥¼ ì •ë ¬í•˜ëŠ” í•¨ìˆ˜
        function sortLocationsForKorean(locations) {
            // ìš°ì„ ìˆœìœ„ ì •ì˜ (í•œê¸€ ë¬¸ë²•ì— ìì—°ìŠ¤ëŸ¬ìš´ ìˆœì„œ)
            const priority = {
                'ì°½': 1,
                'ë¬¸': 2,
                'ë²½': 3,
                'ë°”ë‹¥': 4,
                'ì²œì¥': 5,
                'ë„ë°°': 6,
                'ê°€êµ¬': 7,
                'ì§': 8,
                'í‹€': 9,
                'ë§ˆê°íŒ': 10,
                'ìˆ˜ì „': 11,
                'íƒ€ì¼': 12,
                'ë„ì¥': 13,
                'ì¤„ëˆˆ': 14,
                'ì½”í‚¹': 15
            };
            
            // ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ì •ë ¬
            const sorted = [...locations].sort((a, b) => {
                const priorityA = priority[a] || 999;
                const priorityB = priority[b] || 999;
                return priorityA - priorityB;
            });
            
            return sorted.join(' / ');
        }

        function updateDefectStatus(id, status) {
            const defect = projectData.defects.find(d => d.id === id);
            if (defect) {
                defect.status = status;
                renderDefects();
                saveProjectsToLocalStorage();
                showToast(status === 'completed' ? 'í•˜ìê°€ ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤' : 'í•˜ìê°€ ë¯¸ì™„ë£Œ ìƒíƒœë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤');
            }
        }

        window.deleteDefect = function(id) {
            if (confirm('ì´ í•˜ìë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                projectData.defects = projectData.defects.filter(d => d.id !== id);
                renderDefects();
                saveImmediately(); // âœ… ì¤‘ìš”: ì¦‰ì‹œ ì €ì¥
                updateProgress();
                showToast('í•˜ìê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
            }
        }

        // ==================== ì—‘ì…€ ë‹¤ìš´ë¡œë“œ (ì‹œê³µì‚¬ ì œì¶œìš©) ====================
        // ==================== ëª¨ë“  ìë£Œ ë‹¤ìš´ë¡œë“œ (PDF + ì—‘ì…€ + ì‚¬ì§„ ZIP) ====================
        window.downloadAllData = async function() {
            // âœ… 1. í”„ë¡œì íŠ¸ ì •ë³´ ê²€ì¦
            if (!projectData.apartmentName || !projectData.dong || !projectData.ho) {
                alert('í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // âœ… ì ê²€ì¼ì í•„ìˆ˜ í™•ì¸
            if (!projectData.inspectionDate) {
                alert('âš ï¸ ì ê²€ì¼ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // âœ… 2. í•˜ì ë‚´ì—­ í™•ì¸
            if (!projectData.defects || projectData.defects.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  í•˜ì ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            // âœ… 3. ì‚¬ì§„ ëˆ„ë½ í™•ì¸ (2ì¥ ë¯¸ë§Œ)
            const defectsWithIncompletePhotos = projectData.defects.filter(d => {
                if (!d.photos) return true;
                const validPhotos = d.photos.filter(p => p !== null);
                return validPhotos.length < 2;
            });
            if (defectsWithIncompletePhotos.length > 0) {
                const photoDetails = defectsWithIncompletePhotos.map((d, idx) => {
                    const defectIndex = projectData.defects.indexOf(d) + 1;
                    const photoCount = d.photos ? d.photos.filter(p => p !== null).length : 0;
                    return `í•˜ì ${defectIndex}ë²ˆ: ì‚¬ì§„ ${photoCount}ì¥`;
                }).join('\n');
                
                if (!confirm(`âš ï¸ ì‚¬ì§„ì´ 2ì¥ ë¯¸ë§Œì¸ í•˜ìê°€ ${defectsWithIncompletePhotos.length}ê±´ ìˆìŠµë‹ˆë‹¤.\n\n${photoDetails}\n\nğŸ“· ê¶Œì¥: ì›ê²½ + ê·¼ì ‘ ì‚¬ì§„ 2ì¥\n\nì‹œê³µì‚¬ ì œì¶œ ì‹œ ì¦ê±° ìë£Œê°€ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nê³„ì† ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    return;
                }
            }
            
            showLoading();
            showToast('ğŸ“¦ ëª¨ë“  ìë£Œ ì¤€ë¹„ ì¤‘...');
            
            try {
                const zip = new JSZip();
                const projectName = `${projectData.apartmentName}_${projectData.dong}_${projectData.ho}`;
                const authorName = projectData.author ? `_${projectData.author}` : ''; // âœ… ì‘ì„±ì ë³€ìˆ˜ í•œ ë²ˆë§Œ ì„ ì–¸
                let photoCount = 0;
                
                // ========== 1. PDF íŒŒì¼ ìƒì„± ==========
                showToast('ğŸ“„ PDF ë³´ê³ ì„œ ìƒì„± ì¤‘...');
                
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                const pageWidth = 210;
                const pageHeight = 297;

                // PDF í˜ì´ì§€ë“¤ ìƒì„±
                const firstPageHTML = window.createSummaryFirstPage();
                await window.addHTMLPageToPDF(doc, firstPageHTML, pageWidth, pageHeight);

                // 2í˜ì´ì§€~: í•˜ì ëª©ë¡ë§Œ (18ê°œì”©ìœ¼ë¡œ ì¡°ì •)
                if (projectData.defects.length > 15) {
                    const itemsPerPage = 18;
                    for (let i = 15; i < projectData.defects.length; i += itemsPerPage) {
                        doc.addPage();
                        const listPageHTML = window.createDefectListPage(i, itemsPerPage);
                        await window.addHTMLPageToPDF(doc, listPageHTML, pageWidth, pageHeight);
                    }
                }

                // í•˜ì ìƒì„¸ ì‚¬ì§„ í˜ì´ì§€ (3ê°œì”©, ì‚¬ì§„ 2ì¥ì”©)
                if (projectData.defects.length > 0) {
                    const defectsWithPhotos = projectData.defects.filter(d => d.photos && d.photos.length > 0);
                    
                    if (defectsWithPhotos.length > 0) {
                        for (let i = 0; i < defectsWithPhotos.length; i += 3) {
                            doc.addPage();
                            const batch = defectsWithPhotos.slice(i, i + 3);
                            const detailHTML = await window.createDefectDetailPage(batch, i);
                            await window.addHTMLPageToPDF(doc, detailHTML, pageWidth, pageHeight);
                        }
                    }
                }

                if (projectData.equipment && projectData.equipment.length > 0) {
                    const equipmentWithPhotos = projectData.equipment.filter(e => {
                        if (e.photos && typeof e.photos === 'object') {
                            return Object.values(e.photos).some(photo => photo !== null);
                        }
                        return e.photo;
                    });
                    
                    if (equipmentWithPhotos.length > 0) {
                        for (let i = 0; i < equipmentWithPhotos.length; i += 2) {
                            doc.addPage();
                            const batch = equipmentWithPhotos.slice(i, i + 2);
                            const equipmentHTML = await window.createEquipmentPage(batch, i);
                            await window.addHTMLPageToPDF(doc, equipmentHTML, pageWidth, pageHeight);
                        }
                    }
                }

                const airQualityWithData = projectData.airQuality.filter(room => 
                    room.radon || room.formaldehyde || room.vocs
                );
                if (airQualityWithData.length > 0) {
                    doc.addPage();
                    const airQualityHTML = window.createAirQualityDetailPage();
                    await window.addHTMLPageToPDF(doc, airQualityHTML, pageWidth, pageHeight);
                }

                // ê²¬ì ì„œ í˜ì´ì§€ ì¶”ê°€ (ì‹¤ë‚´ê³µê¸°ì§ˆì¸¡ì •ê²°ê³¼ ë°”ë¡œ ë‹¤ìŒ)
                doc.addPage();
                const quotationPage = window.createQuotationPage();
                await window.addHTMLPageToPDF(doc, quotationPage, pageWidth, pageHeight);

                doc.addPage();
                const serviceGuidePage = window.createServiceGuidePage();
                await window.addHTMLPageToPDF(doc, serviceGuidePage, pageWidth, pageHeight);

                doc.addPage();
                const warrantyPage1 = window.createWarrantyGuidePage1();
                await window.addHTMLPageToPDF(doc, warrantyPage1, pageWidth, pageHeight);

                doc.addPage();
                const warrantyPage2 = window.createWarrantyGuidePage2();
                await window.addHTMLPageToPDF(doc, warrantyPage2, pageWidth, pageHeight);

                doc.addPage();
                const airQualityGuide = window.createAirQualityManagementGuidePage();
                await window.addHTMLPageToPDF(doc, airQualityGuide, pageWidth, pageHeight);

                doc.addPage();
                const condensationGuide = window.createCondensationGuidePage();
                await window.addHTMLPageToPDF(doc, condensationGuide, pageWidth, pageHeight);

                doc.addPage();
                const movingInGuide = window.createMovingInGuidePage();
                await window.addHTMLPageToPDF(doc, movingInGuide, pageWidth, pageHeight);
                
                // PDFë¥¼ Blobìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ZIPì— ì¶”ê°€
                const pdfBlob = doc.output('blob');
                
                // ì‘ì„±ì ì •ë³´ í¬í•¨í•œ íŒŒì¼ëª…
                const pdfFileName = `${projectName}${authorName}_í•˜ìì ê²€ë³´ê³ ì„œ.pdf`;
                
                zip.file(pdfFileName, pdfBlob);
                
                // ========== 2. ì—‘ì…€ íŒŒì¼ ìƒì„± ==========
                showToast('ğŸ“Š ì—‘ì…€ íŒŒì¼ ìƒì„± ì¤‘...');
                
                const workbook = new ExcelJS.Workbook();
                workbook.creator = 'ë”í™ˆì ê²€';
                workbook.created = new Date();
                workbook.modified = new Date();
                workbook.lastModifiedBy = 'ë”í™ˆì ê²€';
                workbook.calcProperties = { fullCalcOnLoad: true };
                
                // ==================== ì‹œíŠ¸1: í‘œì§€ (ì „ë¬¸ì  ë””ìì¸) ====================
                const coverSheet = workbook.addWorksheet('í‘œì§€', {
                    pageSetup: {
                        paperSize: 9, // A4
                        orientation: 'portrait',
                        fitToPage: true,
                        fitToWidth: 1,
                        fitToHeight: 0,
                        margins: {
                            left: 0.7, right: 0.7,
                            top: 0.75, bottom: 0.75,
                            header: 0.3, footer: 0.3
                        }
                    }
                });
                
                coverSheet.getColumn(1).width = 25;
                coverSheet.getColumn(2).width = 35;
                
                // ë¡œê³ /íƒ€ì´í‹€ ì˜ì—­ (1~3í–‰)
                coverSheet.mergeCells('A1:B3');
                const titleCell = coverSheet.getCell('A1');
                titleCell.value = 'í•˜ìì ê²€ ë¦¬ìŠ¤íŠ¸';
                titleCell.font = { 
                    name: 'ë§‘ì€ ê³ ë”•', 
                    size: 32, 
                    bold: true,
                    color: { argb: 'FF1F2937' }
                };
                titleCell.alignment = { 
                    vertical: 'middle', 
                    horizontal: 'center' 
                };
                titleCell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FFF3F4F6' }
                };
                titleCell.border = {
                    top: { style: 'thick', color: { argb: 'FF10B981' } },
                    left: { style: 'thick', color: { argb: 'FF10B981' } },
                    right: { style: 'thick', color: { argb: 'FF10B981' } },
                    bottom: { style: 'medium', color: { argb: 'FF10B981' } }
                };
                coverSheet.getRow(1).height = 35;
                coverSheet.getRow(2).height = 35;
                coverSheet.getRow(3).height = 35;
                
                // ë¹ˆ ì¤„
                coverSheet.getRow(4).height = 20;
                
                // ë¶€ì œëª© (5í–‰)
                coverSheet.mergeCells('A5:B5');
                const subtitleCell = coverSheet.getCell('A5');
                subtitleCell.value = '[ í”„ë¡œì íŠ¸ ì •ë³´ ]';
                subtitleCell.font = { 
                    name: 'ë§‘ì€ ê³ ë”•', 
                    size: 14, 
                    bold: true,
                    color: { argb: 'FF10B981' }
                };
                subtitleCell.alignment = { 
                    vertical: 'middle', 
                    horizontal: 'left' 
                };
                coverSheet.getRow(5).height = 25;
                
                // í”„ë¡œì íŠ¸ ì •ë³´ (6í–‰~)
                const projectInfo = [
                    ['ì•„íŒŒíŠ¸ëª…', projectData.apartmentName || ''],
                    ['ë™ / í˜¸ìˆ˜', `${projectData.dong || ''} / ${projectData.ho || ''}`],
                    ['ì ê²€ì¼ì', projectData.inspectionDate || ''],
                    ['ì ê²€ì (ê³„ì•½ì)', projectData.inspector || ''],
                    ['ì—°ë½ì²˜', projectData.phone || '']
                ];
                
                projectInfo.forEach((rowData, index) => {
                    const rowNum = 6 + index;
                    const row = coverSheet.getRow(rowNum);
                    row.height = 28;
                    
                    // Aì—´ (ë¼ë²¨)
                    const cellA = row.getCell(1);
                    cellA.value = rowData[0];
                    cellA.font = { 
                        name: 'ë§‘ì€ ê³ ë”•', 
                        bold: true, 
                        size: 12,
                        color: { argb: 'FFFFFFFF' }
                    };
                    cellA.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FF059669' }
                    };
                    cellA.border = {
                        top: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        left: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        bottom: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        right: { style: 'thin', color: { argb: 'FFCCCCCC' } }
                    };
                    cellA.alignment = { 
                        vertical: 'middle', 
                        horizontal: 'center' 
                    };
                    
                    // Bì—´ (ê°’)
                    const cellB = row.getCell(2);
                    cellB.value = rowData[1];
                    cellB.font = { 
                        name: 'ë§‘ì€ ê³ ë”•', 
                        size: 12,
                        color: { argb: 'FF1F2937' }
                    };
                    cellB.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FFFFFFFF' }
                    };
                    cellB.border = {
                        top: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        left: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        bottom: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        right: { style: 'thin', color: { argb: 'FFCCCCCC' } }
                    };
                    cellB.alignment = { 
                        vertical: 'middle', 
                        horizontal: 'left',
                        indent: 1
                    };
                });
                
                // ë¹ˆ ì¤„
                coverSheet.getRow(11).height = 20;
                
                // í•˜ì ìš”ì•½ (12í–‰)
                coverSheet.mergeCells('A12:B12');
                const summaryCell = coverSheet.getCell('A12');
                summaryCell.value = '[ í•˜ì í˜„í™© ]';
                summaryCell.font = { 
                    name: 'ë§‘ì€ ê³ ë”•', 
                    size: 14, 
                    bold: true,
                    color: { argb: 'FF10B981' }
                };
                summaryCell.alignment = { 
                    vertical: 'middle', 
                    horizontal: 'left' 
                };
                coverSheet.getRow(12).height = 25;
                
                // í•˜ì ê±´ìˆ˜ (13í–‰)
                const defectCountRow = coverSheet.getRow(13);
                defectCountRow.height = 35;
                
                const countLabelCell = defectCountRow.getCell(1);
                countLabelCell.value = 'ì´ í•˜ì ê±´ìˆ˜';
                countLabelCell.font = { 
                    name: 'ë§‘ì€ ê³ ë”•', 
                    bold: true, 
                    size: 13,
                    color: { argb: 'FFFFFFFF' }
                };
                countLabelCell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FF059669' }
                };
                countLabelCell.border = {
                    top: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    left: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    bottom: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    right: { style: 'thin', color: { argb: 'FFCCCCCC' } }
                };
                countLabelCell.alignment = { 
                    vertical: 'middle', 
                    horizontal: 'center' 
                };
                
                const countValueCell = defectCountRow.getCell(2);
                countValueCell.value = `${projectData.defects.length} ê±´`;
                countValueCell.font = { 
                    name: 'ë§‘ì€ ê³ ë”•', 
                    size: 18,
                    bold: true,
                    color: { argb: 'FFEF4444' }
                };
                countValueCell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FFFEF2F2' }
                };
                countValueCell.border = {
                    top: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    left: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    bottom: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    right: { style: 'thin', color: { argb: 'FFCCCCCC' } }
                };
                countValueCell.alignment = { 
                    vertical: 'middle', 
                    horizontal: 'center' 
                };
                
                // ë¹ˆ ì¤„ë“¤
                for (let i = 14; i <= 20; i++) {
                    coverSheet.getRow(i).height = 15;
                }
                
                // ì„œëª…ë€ (21í–‰)
                coverSheet.mergeCells('A21:B21');
                const signCell = coverSheet.getCell('A21');
                signCell.value = 'ì‘ì„±ì:  _______________     (ì¸)';
                signCell.font = { 
                    name: 'ë§‘ì€ ê³ ë”•', 
                    size: 12,
                    color: { argb: 'FF6B7280' }
                };
                signCell.alignment = { 
                    vertical: 'middle', 
                    horizontal: 'right' 
                };
                coverSheet.getRow(21).height = 30;
                
                // í•˜ë‹¨ ë¡œê³ /ë‚ ì§œ (22í–‰)
                coverSheet.mergeCells('A22:B22');
                const footerCell = coverSheet.getCell('A22');
                footerCell.value = `Generated by ë”í™ˆì ê²€ | ${new Date().toLocaleDateString('ko-KR')}`;
                footerCell.font = { 
                    name: 'ë§‘ì€ ê³ ë”•', 
                    size: 9,
                    italic: true,
                    color: { argb: 'FF9CA3AF' }
                };
                footerCell.alignment = { 
                    vertical: 'middle', 
                    horizontal: 'center' 
                };
                coverSheet.getRow(22).height = 20;
                
                // ==================== ì‹œíŠ¸2: í•˜ìëª©ë¡ ====================
                const detailSheet = workbook.addWorksheet('í•˜ìëª©ë¡', {
                    pageSetup: {
                        paperSize: 9, // A4
                        orientation: 'portrait',
                        fitToPage: true,
                        fitToWidth: 1,
                        fitToHeight: 0,
                        margins: {
                            left: 0.7, right: 0.7,
                            top: 0.75, bottom: 0.75,
                            header: 0.3, footer: 0.3
                        }
                    }
                });
                
                // ì»¬ëŸ¼ ë„ˆë¹„ ì„¤ì •
                detailSheet.getColumn(1).width = 7;   // ë²ˆí˜¸
                detailSheet.getColumn(2).width = 12;  // ê³µê°„
                detailSheet.getColumn(3).width = 15;  // ìœ„ì¹˜
                detailSheet.getColumn(4).width = 15;  // í•˜ìë‚´ìš©
                detailSheet.getColumn(5).width = 40;  // ìƒì„¸ì„¤ëª…
                
                // í—¤ë” í–‰
                const headerRow = detailSheet.getRow(1);
                headerRow.height = 30;
                
                const headers = ['ë²ˆí˜¸', 'ê³µê°„', 'ìœ„ì¹˜', 'í•˜ìë‚´ìš©', 'ìƒì„¸ì„¤ëª…'];
                headers.forEach((header, index) => {
                    const cell = headerRow.getCell(index + 1);
                    cell.value = header;
                    cell.font = { 
                        name: 'ë§‘ì€ ê³ ë”•', 
                        bold: true, 
                        size: 12, 
                        color: { argb: 'FFFFFFFF' } 
                    };
                    cell.alignment = { 
                        vertical: 'middle', 
                        horizontal: 'center', 
                        wrapText: true 
                    };
                    cell.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: 'FF059669' }
                    };
                    cell.border = {
                        top: { style: 'medium', color: { argb: 'FF000000' } },
                        left: { style: 'medium', color: { argb: 'FF000000' } },
                        bottom: { style: 'medium', color: { argb: 'FF000000' } },
                        right: { style: 'medium', color: { argb: 'FF000000' } }
                    };
                });
                
                // í•˜ì ë°ì´í„° í–‰ (ìˆ˜ì •: addRow ëŒ€ì‹  getRow ì‚¬ìš©)
                projectData.defects.forEach((defect, index) => {
                    const row = detailSheet.getRow(index + 2);
                    row.height = 40;
                    
                    // ë²ˆí˜¸
                    const cell1 = row.getCell(1);
                    cell1.value = index + 1;
                    cell1.font = { name: 'ë§‘ì€ ê³ ë”•', size: 11, bold: true };
                    cell1.alignment = { vertical: 'middle', horizontal: 'center' };
                    cell1.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: index % 2 === 0 ? 'FFFFFFFF' : 'FFF9FAFB' }
                    };
                    cell1.border = {
                        top: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        left: { style: 'medium', color: { argb: 'FF6B7280' } },
                        bottom: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        right: { style: 'thin', color: { argb: 'FFD1D5DB' } }
                    };
                    
                    // ê³µê°„ (ë°°ì—´ì—ì„œ ê°€ì ¸ì˜¤ê¸°)
                    const cell2 = row.getCell(2);
                    cell2.value = (defect.spaces && defect.spaces.length > 0) ? defect.spaces.join(', ') : '';
                    cell2.font = { name: 'ë§‘ì€ ê³ ë”•', size: 11 };
                    cell2.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                    cell2.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: index % 2 === 0 ? 'FFFFFFFF' : 'FFF9FAFB' }
                    };
                    cell2.border = {
                        top: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        left: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        bottom: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        right: { style: 'thin', color: { argb: 'FFD1D5DB' } }
                    };
                    
                    // ìœ„ì¹˜ (ë°°ì—´ì—ì„œ ê°€ì ¸ì˜¤ê¸°)
                    const cell3 = row.getCell(3);
                    cell3.value = (defect.locations && defect.locations.length > 0) ? defect.locations.join(', ') : '';
                    cell3.font = { name: 'ë§‘ì€ ê³ ë”•', size: 11 };
                    cell3.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                    cell3.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: index % 2 === 0 ? 'FFFFFFFF' : 'FFF9FAFB' }
                    };
                    cell3.border = {
                        top: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        left: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        bottom: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        right: { style: 'thin', color: { argb: 'FFD1D5DB' } }
                    };
                    
                    // í•˜ìë‚´ìš© (ë°°ì—´ì—ì„œ ê°€ì ¸ì˜¤ê¸°)
                    const cell4 = row.getCell(4);
                    cell4.value = (defect.types && defect.types.length > 0) ? defect.types.join(', ') : '';
                    cell4.font = { name: 'ë§‘ì€ ê³ ë”•', size: 11 };
                    cell4.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                    cell4.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: index % 2 === 0 ? 'FFFFFFFF' : 'FFF9FAFB' }
                    };
                    cell4.border = {
                        top: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        left: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        bottom: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        right: { style: 'thin', color: { argb: 'FFD1D5DB' } }
                    };
                    
                    // ìƒì„¸ì„¤ëª…
                    const cell5 = row.getCell(5);
                    cell5.value = defect.description || '';
                    cell5.font = { name: 'ë§‘ì€ ê³ ë”•', size: 10 };
                    cell5.alignment = { vertical: 'top', horizontal: 'left', wrapText: true, indent: 1 };
                    cell5.fill = {
                        type: 'pattern',
                        pattern: 'solid',
                        fgColor: { argb: index % 2 === 0 ? 'FFFFFFFF' : 'FFF9FAFB' }
                    };
                    cell5.border = {
                        top: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        left: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        bottom: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        right: { style: 'medium', color: { argb: 'FF6B7280' } }
                    };
                });
                
                // ì—‘ì…€ íŒŒì¼ì„ ZIPì— ì¶”ê°€
                const excelBuffer = await workbook.xlsx.writeBuffer();
                
                // ì‘ì„±ì ì •ë³´ í¬í•¨í•œ íŒŒì¼ëª…
                const excelFileName = `${projectName}${authorName}_í•˜ìëª©ë¡.xlsx`;
                
                zip.file(excelFileName, excelBuffer);
                
                // ========== 3. ì‚¬ì§„ ì¶”ê°€ ==========
                showToast('ğŸ“· ì‚¬ì§„ ìˆ˜ì§‘ ì¤‘...');
                
                // í‰ë©´ë„
                if (projectData.floorplan) {
                    const floorplanData = projectData.floorplan.split(',')[1];
                    zip.file('í‰ë©´ë„.jpg', floorplanData, { base64: true });
                    photoCount++;
                }
                
                // í•˜ì ì‚¬ì§„
                if (projectData.defects && projectData.defects.length > 0) {
                    const defectFolder = zip.folder('í•˜ìì‚¬ì§„');
                    
                    for (let index = 0; index < projectData.defects.length; index++) {
                        const defect = projectData.defects[index];
                        if (defect.photos && defect.photos.length > 0) {
                            const defectNum = String(index + 1).padStart(2, '0');
                            // âœ… ë°°ì—´ì—ì„œ ì²« ë²ˆì§¸ ê°’ ê°€ì ¸ì˜¤ê¸°
                            const spaceName = (defect.spaces && defect.spaces.length > 0) ? defect.spaces[0] : 'ë¯¸ì§€ì •';
                            const locationName = (defect.locations && defect.locations.length > 0) ? defect.locations[0] : 'ë¯¸ì§€ì •';
                            
                            for (let photoIndex = 0; photoIndex < defect.photos.length; photoIndex++) {
                                const photo = defect.photos[photoIndex];
                                
                                // null ì‚¬ì§„ ê±´ë„ˆë›°ê¸°
                                if (photo === null) continue;
                                
                                const photoType = photoIndex === 0 ? 'ì›ê²½' : 'ê·¼ì ‘';
                                
                                // ì›Œí„°ë§ˆí¬ ì¶”ê°€ (ë™í˜¸ìˆ˜ í¬í•¨)
                                const dongHo = `${projectData.dong}ë™${projectData.ho}í˜¸`;
                                const watermarkText = photoIndex === 0 ? `${dongHo}_${index + 1}` : `${dongHo}_${index + 1}-1`;
                                const photoWithWatermark = await window.addWatermarkToPhoto(photo, watermarkText);
                                
                                const photoData = photoWithWatermark.split(',')[1];
                                const fileName = `${defectNum}_${spaceName}_${locationName}_${photoType}.jpg`.replace(/\//g, '-');
                                defectFolder.file(fileName, photoData, { base64: true });
                                photoCount++;
                            }
                        }
                    }
                }
                
                // ì¥ë¹„ ì‚¬ì§„
                if (projectData.equipment && projectData.equipment.length > 0) {
                    const equipFolder = zip.folder('ì¥ë¹„ì‚¬ì§„');
                    
                    projectData.equipment.forEach((equip, index) => {
                        const equipNum = String(index + 1).padStart(2, '0');
                        const spaceName = equip.space || 'ë¯¸ì§€ì •';
                        const equipName = equip.equipment || 'ë¯¸ì§€ì •';
                        
                        if (equip.photos) {
                            Object.entries(equip.photos).forEach(([location, photo]) => {
                                if (photo) {
                                    const photoData = photo.split(',')[1];
                                    const fileName = `${equipNum}_${spaceName}_${equipName}_${location}.jpg`.replace(/\//g, '-');
                                    equipFolder.file(fileName, photoData, { base64: true });
                                    photoCount++;
                                }
                            });
                        } else if (equip.photo) {
                            const photoData = equip.photo.split(',')[1];
                            const fileName = `${equipNum}_${spaceName}_${equipName}.jpg`.replace(/\//g, '-');
                            equipFolder.file(fileName, photoData, { base64: true });
                            photoCount++;
                        }
                    });
                }
                
                // ========== 4. ZIP íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ ==========
                showToast(`ğŸ“¦ ZIP íŒŒì¼ ìƒì„± ì¤‘... (PDF + ì—‘ì…€ + ì‚¬ì§„ ${photoCount}ì¥)`);
                
                const content = await zip.generateAsync({ 
                    type: 'blob',
                    compression: 'DEFLATE',
                    compressionOptions: { level: 6 }
                });
                
                const url = URL.createObjectURL(content);
                const link = document.createElement('a');
                link.href = url;
                
                // ì‘ì„±ì ì •ë³´ í¬í•¨í•œ íŒŒì¼ëª…
                link.download = `${projectName}${authorName}_ì „ì²´ìë£Œ_${projectData.inspectionDate || new Date().toISOString().split('T')[0]}.zip`;
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                hideLoading();
                showToast(`âœ… ë‹¤ìš´ë¡œë“œ ì™„ë£Œ! ğŸ“„ PDF + ğŸ“Š ì—‘ì…€ + ğŸ“· ì‚¬ì§„ ${photoCount}ì¥`);
                
            } catch (error) {
                console.error('ì „ì²´ ìë£Œ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                hideLoading();
                alert('ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨: ' + error.message);
            }
        }

        // ==================== ì—‘ì…€ ë‹¤ìš´ë¡œë“œ (í…ìŠ¤íŠ¸ë§Œ) ====================
        async function downloadExcel() {
            // âœ… 1. í”„ë¡œì íŠ¸ ì •ë³´ ê²€ì¦
            if (!projectData.apartmentName || !projectData.dong || !projectData.ho) {
                alert('í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // âœ… ì ê²€ì¼ì í•„ìˆ˜ í™•ì¸
            if (!projectData.inspectionDate) {
                alert('âš ï¸ ì ê²€ì¼ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            if (!projectData.defects || projectData.defects.length === 0) {
                alert('ë‹¤ìš´ë¡œë“œí•  í•˜ì ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤');
                return;
            }
            
            showToast('ğŸ“Š ì—‘ì…€ íŒŒì¼ ìƒì„± ì¤‘...');
            
            try {
                const workbook = new ExcelJS.Workbook();
                workbook.creator = 'ë”í™ˆì ê²€';
                workbook.created = new Date();
                workbook.modified = new Date();
                workbook.lastModifiedBy = 'ë”í™ˆì ê²€';
                workbook.calcProperties = { fullCalcOnLoad: true };
                
                // === ë™ì¼í•œ ì½”ë“œ ì¬ì‚¬ìš© (í†µí•© ë‹¤ìš´ë¡œë“œì™€ ë™ì¼) ===
                // í‘œì§€ ì‹œíŠ¸
                const coverSheet = workbook.addWorksheet('í‘œì§€', {
                    pageSetup: {
                        paperSize: 9,
                        orientation: 'portrait',
                        fitToPage: true,
                        fitToWidth: 1,
                        fitToHeight: 0,
                        margins: {
                            left: 0.7, right: 0.7,
                            top: 0.75, bottom: 0.75,
                            header: 0.3, footer: 0.3
                        }
                    }
                });
                
                coverSheet.getColumn(1).width = 25;
                coverSheet.getColumn(2).width = 35;
                
                // íƒ€ì´í‹€
                coverSheet.mergeCells('A1:B3');
                const titleCell = coverSheet.getCell('A1');
                titleCell.value = 'í•˜ìì ê²€ ë¦¬ìŠ¤íŠ¸';
                titleCell.font = { name: 'ë§‘ì€ ê³ ë”•', size: 32, bold: true, color: { argb: 'FF1F2937' } };
                titleCell.alignment = { vertical: 'middle', horizontal: 'center' };
                titleCell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFF3F4F6' } };
                titleCell.border = {
                    top: { style: 'thick', color: { argb: 'FF10B981' } },
                    left: { style: 'thick', color: { argb: 'FF10B981' } },
                    right: { style: 'thick', color: { argb: 'FF10B981' } },
                    bottom: { style: 'medium', color: { argb: 'FF10B981' } }
                };
                coverSheet.getRow(1).height = 35;
                coverSheet.getRow(2).height = 35;
                coverSheet.getRow(3).height = 35;
                coverSheet.getRow(4).height = 20;
                
                // ë¶€ì œëª©
                coverSheet.mergeCells('A5:B5');
                const subtitleCell = coverSheet.getCell('A5');
                subtitleCell.value = '[ í”„ë¡œì íŠ¸ ì •ë³´ ]';
                subtitleCell.font = { name: 'ë§‘ì€ ê³ ë”•', size: 14, bold: true, color: { argb: 'FF10B981' } };
                subtitleCell.alignment = { vertical: 'middle', horizontal: 'left' };
                coverSheet.getRow(5).height = 25;
                
                // í”„ë¡œì íŠ¸ ì •ë³´
                const projectInfo = [
                    ['ì•„íŒŒíŠ¸ëª…', projectData.apartmentName || ''],
                    ['ë™ / í˜¸ìˆ˜', `${projectData.dong || ''} / ${projectData.ho || ''}`],
                    ['ì ê²€ì¼ì', projectData.inspectionDate || ''],
                    ['ì ê²€ì (ê³„ì•½ì)', projectData.inspector || ''],
                    ['ì—°ë½ì²˜', projectData.phone || '']
                ];
                
                projectInfo.forEach((rowData, index) => {
                    const rowNum = 6 + index;
                    const row = coverSheet.getRow(rowNum);
                    row.height = 28;
                    
                    const cellA = row.getCell(1);
                    cellA.value = rowData[0];
                    cellA.font = { name: 'ë§‘ì€ ê³ ë”•', bold: true, size: 12, color: { argb: 'FFFFFFFF' } };
                    cellA.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF059669' } };
                    cellA.border = {
                        top: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        left: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        bottom: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        right: { style: 'thin', color: { argb: 'FFCCCCCC' } }
                    };
                    cellA.alignment = { vertical: 'middle', horizontal: 'center' };
                    
                    const cellB = row.getCell(2);
                    cellB.value = rowData[1];
                    cellB.font = { name: 'ë§‘ì€ ê³ ë”•', size: 12, color: { argb: 'FF1F2937' } };
                    cellB.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFFFFFFF' } };
                    cellB.border = {
                        top: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        left: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        bottom: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                        right: { style: 'thin', color: { argb: 'FFCCCCCC' } }
                    };
                    cellB.alignment = { vertical: 'middle', horizontal: 'left', indent: 1 };
                });
                
                coverSheet.getRow(11).height = 20;
                
                // í•˜ì ìš”ì•½
                coverSheet.mergeCells('A12:B12');
                const summaryCell = coverSheet.getCell('A12');
                summaryCell.value = '[ í•˜ì í˜„í™© ]';
                summaryCell.font = { name: 'ë§‘ì€ ê³ ë”•', size: 14, bold: true, color: { argb: 'FF10B981' } };
                summaryCell.alignment = { vertical: 'middle', horizontal: 'left' };
                coverSheet.getRow(12).height = 25;
                
                const defectCountRow = coverSheet.getRow(13);
                defectCountRow.height = 35;
                
                const countLabelCell = defectCountRow.getCell(1);
                countLabelCell.value = 'ì´ í•˜ì ê±´ìˆ˜';
                countLabelCell.font = { name: 'ë§‘ì€ ê³ ë”•', bold: true, size: 13, color: { argb: 'FFFFFFFF' } };
                countLabelCell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF059669' } };
                countLabelCell.border = {
                    top: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    left: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    bottom: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    right: { style: 'thin', color: { argb: 'FFCCCCCC' } }
                };
                countLabelCell.alignment = { vertical: 'middle', horizontal: 'center' };
                
                const countValueCell = defectCountRow.getCell(2);
                countValueCell.value = `${projectData.defects.length} ê±´`;
                countValueCell.font = { name: 'ë§‘ì€ ê³ ë”•', size: 18, bold: true, color: { argb: 'FFEF4444' } };
                countValueCell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFFEF2F2' } };
                countValueCell.border = {
                    top: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    left: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    bottom: { style: 'thin', color: { argb: 'FFCCCCCC' } },
                    right: { style: 'thin', color: { argb: 'FFCCCCCC' } }
                };
                countValueCell.alignment = { vertical: 'middle', horizontal: 'center' };
                
                for (let i = 14; i <= 20; i++) {
                    coverSheet.getRow(i).height = 15;
                }
                
                // ì„œëª…ë€
                coverSheet.mergeCells('A21:B21');
                const signCell = coverSheet.getCell('A21');
                signCell.value = 'ì‘ì„±ì:  _______________     (ì¸)';
                signCell.font = { name: 'ë§‘ì€ ê³ ë”•', size: 12, color: { argb: 'FF6B7280' } };
                signCell.alignment = { vertical: 'middle', horizontal: 'right' };
                coverSheet.getRow(21).height = 30;
                
                // í•˜ë‹¨
                coverSheet.mergeCells('A22:B22');
                const footerCell = coverSheet.getCell('A22');
                footerCell.value = `Generated by ë”í™ˆì ê²€ | ${new Date().toLocaleDateString('ko-KR')}`;
                footerCell.font = { name: 'ë§‘ì€ ê³ ë”•', size: 9, italic: true, color: { argb: 'FF9CA3AF' } };
                footerCell.alignment = { vertical: 'middle', horizontal: 'center' };
                coverSheet.getRow(22).height = 20;
                
                // í•˜ìëª©ë¡ ì‹œíŠ¸
                const detailSheet = workbook.addWorksheet('í•˜ìëª©ë¡', {
                    pageSetup: {
                        paperSize: 9,
                        orientation: 'portrait',
                        fitToPage: true,
                        fitToWidth: 1,
                        fitToHeight: 0,
                        margins: {
                            left: 0.7, right: 0.7,
                            top: 0.75, bottom: 0.75,
                            header: 0.3, footer: 0.3
                        }
                    }
                });
                
                detailSheet.getColumn(1).width = 7;
                detailSheet.getColumn(2).width = 12;
                detailSheet.getColumn(3).width = 15;
                detailSheet.getColumn(4).width = 15;
                detailSheet.getColumn(5).width = 40;
                
                const headerRow = detailSheet.getRow(1);
                headerRow.height = 30;
                const headers = ['ë²ˆí˜¸', 'ê³µê°„', 'ìœ„ì¹˜', 'í•˜ìë‚´ìš©', 'ìƒì„¸ì„¤ëª…'];
                headers.forEach((header, index) => {
                    const cell = headerRow.getCell(index + 1);
                    cell.value = header;
                    cell.font = { name: 'ë§‘ì€ ê³ ë”•', bold: true, size: 12, color: { argb: 'FFFFFFFF' } };
                    cell.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                    cell.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF059669' } };
                    cell.border = {
                        top: { style: 'medium', color: { argb: 'FF000000' } },
                        left: { style: 'medium', color: { argb: 'FF000000' } },
                        bottom: { style: 'medium', color: { argb: 'FF000000' } },
                        right: { style: 'medium', color: { argb: 'FF000000' } }
                    };
                });
                
                projectData.defects.forEach((defect, index) => {
                    const row = detailSheet.getRow(index + 2);
                    row.height = 40;
                    
                    const cell1 = row.getCell(1);
                    cell1.value = index + 1;
                    cell1.font = { name: 'ë§‘ì€ ê³ ë”•', size: 11, bold: true };
                    cell1.alignment = { vertical: 'middle', horizontal: 'center' };
                    cell1.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: index % 2 === 0 ? 'FFFFFFFF' : 'FFF9FAFB' } };
                    cell1.border = {
                        top: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        left: { style: 'medium', color: { argb: 'FF6B7280' } },
                        bottom: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        right: { style: 'thin', color: { argb: 'FFD1D5DB' } }
                    };
                    
                    // ê³µê°„ (ë°°ì—´ì—ì„œ ê°€ì ¸ì˜¤ê¸°) âœ… ìˆ˜ì •ë¨
                    const cell2 = row.getCell(2);
                    cell2.value = (defect.spaces && defect.spaces.length > 0) ? defect.spaces.join(', ') : '';
                    cell2.font = { name: 'ë§‘ì€ ê³ ë”•', size: 11 };
                    cell2.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                    cell2.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: index % 2 === 0 ? 'FFFFFFFF' : 'FFF9FAFB' } };
                    cell2.border = {
                        top: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        left: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        bottom: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        right: { style: 'thin', color: { argb: 'FFD1D5DB' } }
                    };
                    
                    // ìœ„ì¹˜ (ë°°ì—´ì—ì„œ ê°€ì ¸ì˜¤ê¸°) âœ… ìˆ˜ì •ë¨
                    const cell3 = row.getCell(3);
                    cell3.value = (defect.locations && defect.locations.length > 0) ? defect.locations.join(', ') : '';
                    cell3.font = { name: 'ë§‘ì€ ê³ ë”•', size: 11 };
                    cell3.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                    cell3.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: index % 2 === 0 ? 'FFFFFFFF' : 'FFF9FAFB' } };
                    cell3.border = {
                        top: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        left: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        bottom: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        right: { style: 'thin', color: { argb: 'FFD1D5DB' } }
                    };
                    
                    // í•˜ìë‚´ìš© (ë°°ì—´ì—ì„œ ê°€ì ¸ì˜¤ê¸°) âœ… ìˆ˜ì •ë¨
                    const cell4 = row.getCell(4);
                    cell4.value = (defect.types && defect.types.length > 0) ? defect.types.join(', ') : '';
                    cell4.font = { name: 'ë§‘ì€ ê³ ë”•', size: 11 };
                    cell4.alignment = { vertical: 'middle', horizontal: 'center', wrapText: true };
                    cell4.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: index % 2 === 0 ? 'FFFFFFFF' : 'FFF9FAFB' } };
                    cell4.border = {
                        top: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        left: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        bottom: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        right: { style: 'thin', color: { argb: 'FFD1D5DB' } }
                    };
                    
                    const cell5 = row.getCell(5);
                    cell5.value = defect.description || '';
                    cell5.font = { name: 'ë§‘ì€ ê³ ë”•', size: 10 };
                    cell5.alignment = { vertical: 'top', horizontal: 'left', wrapText: true, indent: 1 };
                    cell5.fill = { type: 'pattern', pattern: 'solid', fgColor: { argb: index % 2 === 0 ? 'FFFFFFFF' : 'FFF9FAFB' } };
                    cell5.border = {
                        top: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        left: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        bottom: { style: 'thin', color: { argb: 'FFD1D5DB' } },
                        right: { style: 'medium', color: { argb: 'FF6B7280' } }
                    };
                });
                
                // íŒŒì¼ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
                const buffer = await workbook.xlsx.writeBuffer();
                const blob = new Blob([buffer], { 
                    type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' 
                });
                
                // âœ… ì‘ì„±ì ì •ë³´ í¬í•¨í•œ íŒŒì¼ëª…
                const projectName = `${projectData.apartmentName}_${projectData.dong}_${projectData.ho}`;
                const authorName = projectData.author ? `_${projectData.author}` : '';
                const fileName = `${projectName}${authorName}_í•˜ìì ê²€ë¦¬ìŠ¤íŠ¸_${projectData.inspectionDate || new Date().toISOString().split('T')[0]}.xlsx`;
                
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = fileName;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                showToast(`âœ… ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ! (í•˜ì ${projectData.defects.length}ê±´)`);
                
            } catch (error) {
                console.error('ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨: ' + error.message);
            }
        }

        // ==================== ì‚¬ì§„ ZIP ë‹¤ìš´ë¡œë“œ ====================
        async function downloadAllPhotos() {
            if (!projectData.apartmentName || !projectData.dong || !projectData.ho) {
                alert('í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            showToast('ğŸ“· ì‚¬ì§„ ìˆ˜ì§‘ ì¤‘...');
            
            try {
                const zip = new JSZip();
                const projectName = `${projectData.apartmentName}_${projectData.dong}_${projectData.ho}`;
                let photoCount = 0;
                
                // 1. í‰ë©´ë„
                if (projectData.floorplan) {
                    const floorplanData = projectData.floorplan.split(',')[1];
                    zip.file('í‰ë©´ë„.jpg', floorplanData, { base64: true });
                    photoCount++;
                }
                
                // 2. í•˜ì ì‚¬ì§„ (ìˆœë²ˆëŒ€ë¡œ, í´ë” ì—†ì´)
                if (projectData.defects && projectData.defects.length > 0) {
                    const defectFolder = zip.folder('í•˜ìì‚¬ì§„');
                    
                    for (let index = 0; index < projectData.defects.length; index++) {
                        const defect = projectData.defects[index];
                        if (defect.photos && defect.photos.length > 0) {
                            const defectNum = String(index + 1).padStart(2, '0'); // 01, 02, 03...
                            // âœ… ë°°ì—´ì—ì„œ ì²« ë²ˆì§¸ ê°’ ê°€ì ¸ì˜¤ê¸°
                            const spaceName = (defect.spaces && defect.spaces.length > 0) ? defect.spaces[0] : 'ë¯¸ì§€ì •';
                            const locationName = (defect.locations && defect.locations.length > 0) ? defect.locations[0] : 'ë¯¸ì§€ì •';
                            
                            for (let photoIndex = 0; photoIndex < defect.photos.length; photoIndex++) {
                                const photo = defect.photos[photoIndex];
                                
                                // null ì‚¬ì§„ ê±´ë„ˆë›°ê¸°
                                if (photo === null) continue;
                                
                                const photoType = photoIndex === 0 ? 'ì›ê²½' : 'ê·¼ì ‘';
                                
                                // ì›Œí„°ë§ˆí¬ ì¶”ê°€ (ë™í˜¸ìˆ˜ í¬í•¨)
                                const dongHo = `${projectData.dong}ë™${projectData.ho}í˜¸`;
                                const watermarkText = photoIndex === 0 ? `${dongHo}_${index + 1}` : `${dongHo}_${index + 1}-1`;
                                const photoWithWatermark = await window.addWatermarkToPhoto(photo, watermarkText);
                                
                                const photoData = photoWithWatermark.split(',')[1];
                                const fileName = `${defectNum}_${spaceName}_${locationName}_${photoType}.jpg`.replace(/\//g, '-');
                                defectFolder.file(fileName, photoData, { base64: true });
                                photoCount++;
                            }
                        }
                    }
                }
                
                // 3. ì¥ë¹„ ì‚¬ì§„
                if (projectData.equipment && projectData.equipment.length > 0) {
                    const equipFolder = zip.folder('ì¥ë¹„ì‚¬ì§„');
                    
                    projectData.equipment.forEach((equip, index) => {
                        const equipNum = String(index + 1).padStart(2, '0');
                        const spaceName = equip.space || 'ë¯¸ì§€ì •';
                        const equipName = equip.equipment || 'ë¯¸ì§€ì •';
                        
                        if (equip.photos) {
                            // ìœ„ì¹˜ë³„ ì‚¬ì§„
                            Object.entries(equip.photos).forEach(([location, photo]) => {
                                if (photo) {
                                    const photoData = photo.split(',')[1];
                                    const fileName = `${equipNum}_${spaceName}_${equipName}_${location}.jpg`.replace(/\//g, '-');
                                    equipFolder.file(fileName, photoData, { base64: true });
                                    photoCount++;
                                }
                            });
                        } else if (equip.photo) {
                            // êµ¬ ë²„ì „ ë‹¨ì¼ ì‚¬ì§„
                            const photoData = equip.photo.split(',')[1];
                            const fileName = `${equipNum}_${spaceName}_${equipName}.jpg`.replace(/\//g, '-');
                            equipFolder.file(fileName, photoData, { base64: true });
                            photoCount++;
                        }
                    });
                }
                
                if (photoCount === 0) {
                    showToast('âŒ ë‹¤ìš´ë¡œë“œí•  ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤');
                    return;
                }
                
                showToast(`ğŸ“¦ ZIP íŒŒì¼ ìƒì„± ì¤‘... (${photoCount}ì¥)`);
                
                // ZIP íŒŒì¼ ìƒì„±
                const content = await zip.generateAsync({ type: 'blob' });
                
                // ë‹¤ìš´ë¡œë“œ
                const url = URL.createObjectURL(content);
                const link = document.createElement('a');
                link.href = url;
                link.download = `${projectName}_ì‚¬ì§„ëª¨ìŒ_${projectData.inspectionDate || new Date().toISOString().split('T')[0]}.zip`;
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                showToast(`âœ… ì‚¬ì§„ ${photoCount}ì¥ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!`);
                
            } catch (error) {
                console.error('ì‚¬ì§„ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('ì‚¬ì§„ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨: ' + error.message);
            }
        }

        // ==================== PDF ìƒì„± ====================
        window.generatePDF = async function() {
            // âœ… 1. í”„ë¡œì íŠ¸ ì •ë³´ ê²€ì¦
            if (!projectData.apartmentName || !projectData.dong || !projectData.ho) {
                alert('í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // âœ… ì ê²€ì¼ì í•„ìˆ˜ í™•ì¸
            if (!projectData.inspectionDate) {
                alert('âš ï¸ ì ê²€ì¼ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // âœ… 2. ì‚¬ì§„ ëˆ„ë½ í™•ì¸ (2ì¥ ë¯¸ë§Œ)
            if (projectData.defects && projectData.defects.length > 0) {
                const defectsWithIncompletePhotos = projectData.defects.filter(d => 
                    !d.photos || d.photos.length < 2
                );
                if (defectsWithIncompletePhotos.length > 0) {
                    const photoDetails = defectsWithIncompletePhotos.map((d, idx) => {
                        const defectIndex = projectData.defects.indexOf(d) + 1;
                        const photoCount = d.photos ? d.photos.length : 0;
                        return `í•˜ì ${defectIndex}ë²ˆ: ì‚¬ì§„ ${photoCount}ì¥`;
                    }).join('\n');
                    
                    if (!confirm(`âš ï¸ ì‚¬ì§„ì´ 2ì¥ ë¯¸ë§Œì¸ í•˜ìê°€ ${defectsWithIncompletePhotos.length}ê±´ ìˆìŠµë‹ˆë‹¤.\n\n${photoDetails}\n\nğŸ“· ê¶Œì¥: ì›ê²½ + ê·¼ì ‘ ì‚¬ì§„ 2ì¥\n\nê³ ê° ë³´ê³ ì„œ í’ˆì§ˆì´ ì €í•˜ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nê³„ì† ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                        return;
                    }
                }
            }

            showLoading();

            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                const pageWidth = 210;
                const pageHeight = 297;

                // 1í˜ì´ì§€: í‘œì§€ (ë¯¸ë‹ˆë©€ ëª¨ë˜ ë ˆë“œ)
                const firstPageHTML = window.createSummaryFirstPage();
                await window.addHTMLPageToPDF(doc, firstPageHTML, pageWidth, pageHeight);

                // 2í˜ì´ì§€~: í•˜ì ëª©ë¡ (18ê°œì”©)
                if (projectData.defects.length > 0) {
                    const itemsPerPage = 18;
                    for (let i = 0; i < projectData.defects.length; i += itemsPerPage) {
                        doc.addPage();
                        const listPageHTML = window.createDefectListPage(i, itemsPerPage);
                        await window.addHTMLPageToPDF(doc, listPageHTML, pageWidth, pageHeight);
                    }
                }

                // í•˜ì ìƒì„¸ ì‚¬ì§„ í˜ì´ì§€ (3ê°œì”©, ì‚¬ì§„ 2ì¥ì”©)
                if (projectData.defects.length > 0) {
                    const defectsWithPhotos = projectData.defects.filter(d => d.photos && d.photos.length > 0);
                    
                    if (defectsWithPhotos.length > 0) {
                        for (let i = 0; i < defectsWithPhotos.length; i += 3) {
                            doc.addPage();
                            const batch = defectsWithPhotos.slice(i, i + 3);
                            const detailHTML = await window.createDefectDetailPage(batch, i);
                            await window.addHTMLPageToPDF(doc, detailHTML, pageWidth, pageHeight);
                        }
                    }
                }

                // ì¥ë¹„ì ê²€ í˜ì´ì§€ (1ê°œì”©)
                if (projectData.equipment && projectData.equipment.length > 0) {
                    // ì‚¬ì§„ì´ í•˜ë‚˜ë¼ë„ ìˆëŠ” í•­ëª©ë§Œ í•„í„°ë§
                    const equipmentWithPhotos = projectData.equipment.filter(e => {
                        if (e.photos && typeof e.photos === 'object') {
                            // ìƒˆ ë²„ì „: photos ê°ì²´ì—ì„œ í•˜ë‚˜ë¼ë„ ì‚¬ì§„ì´ ìˆìœ¼ë©´
                            return Object.values(e.photos).some(photo => photo !== null);
                        }
                        // êµ¬ ë²„ì „: photoê°€ ìˆìœ¼ë©´
                        return e.photo;
                    });
                    
                    if (equipmentWithPhotos.length > 0) {
                        // 2ê°œì”© í˜ì´ì§€ì— í‘œì‹œ (ì—¬ìœ ë¡­ê³  ê°€ë…ì„± ì¢‹ê²Œ)
                        for (let i = 0; i < equipmentWithPhotos.length; i += 2) {
                            doc.addPage();
                            const batch = equipmentWithPhotos.slice(i, i + 2);
                            const equipmentHTML = await window.createEquipmentPage(batch, i);
                            await window.addHTMLPageToPDF(doc, equipmentHTML, pageWidth, pageHeight);
                        }
                    }
                }

                // ê³µê¸°ì§ˆ ìƒì„¸ í˜ì´ì§€ ì¶”ê°€
                const airQualityWithData = projectData.airQuality.filter(room => 
                    room.radon || room.formaldehyde || room.vocs
                );
                if (airQualityWithData.length > 0) {
                    doc.addPage();
                    const airQualityHTML = window.createAirQualityDetailPage();
                    await window.addHTMLPageToPDF(doc, airQualityHTML, pageWidth, pageHeight);
                }

                // ê²¬ì ì„œ í˜ì´ì§€ ì¶”ê°€ (ì‹¤ë‚´ê³µê¸°ì§ˆì¸¡ì •ê²°ê³¼ ë°”ë¡œ ë‹¤ìŒ)
                doc.addPage();
                const quotationPage = window.createQuotationPage();
                await window.addHTMLPageToPDF(doc, quotationPage, pageWidth, pageHeight);

                // ì‹œê³µì•ˆë‚´ í˜ì´ì§€ ì¶”ê°€ (ê²¬ì ì„œ ë‹¤ìŒ)
                doc.addPage();
                const serviceGuidePage = window.createServiceGuidePage();
                await window.addHTMLPageToPDF(doc, serviceGuidePage, pageWidth, pageHeight);

                // ì°¸ê³ ìë£Œ í˜ì´ì§€ ì¶”ê°€ (ë³´ê³ ì„œ ë’¤ìª½ì—)
                doc.addPage();
                const warrantyPage1 = window.createWarrantyGuidePage1();
                await window.addHTMLPageToPDF(doc, warrantyPage1, pageWidth, pageHeight);

                doc.addPage();
                const warrantyPage2 = window.createWarrantyGuidePage2();
                await window.addHTMLPageToPDF(doc, warrantyPage2, pageWidth, pageHeight);

                doc.addPage();
                const airQualityGuide = window.createAirQualityManagementGuidePage();
                await window.addHTMLPageToPDF(doc, airQualityGuide, pageWidth, pageHeight);

                doc.addPage();
                const condensationGuide = window.createCondensationGuidePage();
                await window.addHTMLPageToPDF(doc, condensationGuide, pageWidth, pageHeight);

                doc.addPage();
                const movingInGuide = window.createMovingInGuidePage();
                await window.addHTMLPageToPDF(doc, movingInGuide, pageWidth, pageHeight);

                // ëª¨ë°”ì¼ í˜¸í™˜ ë‹¤ìš´ë¡œë“œ
                const filename = `ë”í™ˆì ê²€_${projectData.apartmentName}_${projectData.dong}${projectData.ho}_${new Date().toISOString().split('T')[0]}.pdf`;
                
                const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
                
                if (isMobile) {
                    const pdfBlob = doc.output('blob');
                    const blobUrl = URL.createObjectURL(pdfBlob);
                    
                    const link = document.createElement('a');
                    link.href = blobUrl;
                    link.download = filename;
                    document.body.appendChild(link);
                    link.click();
                    
                    setTimeout(() => {
                        document.body.removeChild(link);
                        URL.revokeObjectURL(blobUrl);
                    }, 100);
                    
                    hideLoading();
                    showToast('PDFê°€ ë‹¤ìš´ë¡œë“œ í´ë”ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                } else {
                    doc.save(filename);
                    hideLoading();
                    showToast('PDFê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤');
                }

            } catch (error) {
                console.error('PDF ìƒì„± ì˜¤ë¥˜:', error);
                hideLoading();
                alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // âœ… ì¥ë¹„ì ê²€ ì „ìš© PDF ìƒì„± (í‘œì§€ + ì¥ë¹„ì¸¡ì •ë§Œ)
        window.generateEquipmentOnlyPDF = async function() {
            // 1. í”„ë¡œì íŠ¸ ì •ë³´ ê²€ì¦
            if (!projectData.apartmentName || !projectData.dong || !projectData.ho) {
                alert('í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // ì ê²€ì¼ì í•„ìˆ˜ í™•ì¸
            if (!projectData.inspectionDate) {
                alert('âš ï¸ ì ê²€ì¼ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // 2. ì¥ë¹„ì¸¡ì • ë°ì´í„° í™•ì¸
            if (!projectData.equipment || projectData.equipment.length === 0) {
                alert('âš ï¸ ì¥ë¹„ì¸¡ì • ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.\nì¥ë¹„ì ê²€ íƒ­ì—ì„œ ì¸¡ì •ì„ ì§„í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì‚¬ì§„ì´ ìˆëŠ” ì¥ë¹„ì¸¡ì •ë§Œ í•„í„°ë§
            const equipmentWithPhotos = projectData.equipment.filter(e => {
                if (e.photos && typeof e.photos === 'object') {
                    return Object.values(e.photos).some(photo => photo !== null);
                }
                return e.photo;
            });
            
            if (equipmentWithPhotos.length === 0) {
                alert('âš ï¸ ì´¬ì˜ëœ ì¥ë¹„ì¸¡ì • ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤.\nì‚¬ì§„ì„ ì´¬ì˜í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading();

            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                const pageWidth = 210;
                const pageHeight = 297;

                // í‘œì§€ í˜ì´ì§€ (ì˜µì…˜1: ë¯¸ë‹ˆë©€ ëª¨ë˜ ìŠ¤íƒ€ì¼)
                const coverHTML = `
                    <div style="width: 794px; height: 1123px; background: #ffffff; display: flex; flex-direction: column; font-family: 'Malgun Gothic', sans-serif; position: relative;">
                        
                        <!-- ìƒë‹¨ ë¸”ë£¨ ì•…ì„¼íŠ¸ ë°” -->
                        <div style="height: 8px; background: linear-gradient(90deg, #3498db 0%, #2980b9 100%);"></div>
                        
                        <!-- ì¢Œì¸¡ ì‚¬ì´ë“œ ì•…ì„¼íŠ¸ -->
                        <div style="position: absolute; left: 0; top: 0; width: 6px; height: 100%; background: linear-gradient(180deg, #3498db 0%, #2980b9 100%);"></div>
                        
                        <!-- ë©”ì¸ ì»¨í…ì¸  -->
                        <div style="flex: 1; padding: 80px 80px 60px 100px; display: flex; flex-direction: column;">
                            
                            <!-- ìƒë‹¨ ë¡œê³ /íƒ€ì… ì˜ì—­ -->
                            <div style="margin-bottom: 60px;">
                                <div style="display: inline-flex; align-items: center; gap: 12px; padding: 12px 24px; background: #ecf0f1; border-radius: 30px;">
                                    <div style="width: 8px; height: 8px; background: #3498db; border-radius: 50%;"></div>
                                    <span style="color: #2c3e50; font-size: 14px; font-weight: 600; letter-spacing: 1px;">EQUIPMENT INSPECTION</span>
                                </div>
                            </div>
                            
                            <!-- íƒ€ì´í‹€ -->
                            <div style="margin-bottom: 80px;">
                                <h1 style="font-size: 56px; font-weight: 800; color: #2c3e50; margin: 0 0 20px 0; line-height: 1.2;">
                                    ì¥ë¹„ì¸¡ì •<br/>ë³´ê³ ì„œ
                                </h1>
                                <div style="width: 80px; height: 5px; background: #3498db; border-radius: 3px;"></div>
                            </div>
                            
                            <!-- í”„ë¡œì íŠ¸ ì •ë³´ ì¹´ë“œ -->
                            <div style="background: #f8f9fa; border-left: 4px solid #3498db; padding: 40px 35px; margin-bottom: 60px; border-radius: 0 8px 8px 0;">
                                <div style="display: flex; flex-direction: column; gap: 20px;">
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #7f8c8d; font-size: 14px; width: 100px; font-weight: 600;">PROJECT</span>
                                        <span style="color: #2c3e50; font-size: 26px; font-weight: 700;">${projectData.apartmentName}</span>
                                    </div>
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #7f8c8d; font-size: 14px; width: 100px; font-weight: 600;">UNIT</span>
                                        <span style="color: #2c3e50; font-size: 32px; font-weight: 700;">${projectData.dong}ë™ ${projectData.ho}í˜¸</span>
                                    </div>
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #7f8c8d; font-size: 14px; width: 100px; font-weight: 600;">DATE</span>
                                        <span style="color: #2c3e50; font-size: 20px; font-weight: 500;">${projectData.inspectionDate}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ì ê²€ í•­ëª© -->
                            <div style="padding: 30px 0; border-top: 2px solid #ecf0f1; border-bottom: 2px solid #ecf0f1;">
                                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                    <div style="width: 6px; height: 6px; background: #3498db; border-radius: 50%;"></div>
                                    <span style="color: #34495e; font-size: 16px; font-weight: 500;">ë²½ì²´ ìˆ˜ì§ ë° ë°”ë‹¥ ìˆ˜í‰ ì ê²€</span>
                                </div>
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div style="width: 6px; height: 6px; background: #3498db; border-radius: 50%;"></div>
                                    <span style="color: #34495e; font-size: 16px; font-weight: 500;">ë‹¨ì—´ì‹œê³µ ìƒíƒœ ì ê²€</span>
                                </div>
                            </div>
                            
                            <!-- í•˜ë‹¨ íšŒì‚¬ ì •ë³´ -->
                            <div style="margin-top: auto;">
                                <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                                    <div>
                                        <h3 style="font-size: 28px; font-weight: 700; color: #2c3e50; margin: 0 0 10px 0;">ë”í™ˆì ê²€</h3>
                                        <p style="font-size: 15px; color: #7f8c8d; margin: 0;">The Home Inspection</p>
                                    </div>
                                    <div style="text-align: right;">
                                        <p style="font-size: 16px; color: #34495e; margin: 8px 0; font-weight: 500;">ğŸ“ 070-8019-1456</p>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                `;

                
                await window.addHTMLPageToPDF(doc, coverHTML, pageWidth, pageHeight);

                // ì¥ë¹„ì ê²€ í˜ì´ì§€ (1í˜ì´ì§€ì— 1ê°œì”©)
                equipmentWithPhotos.forEach((item, i) => item._originalIndex = i + 1);
                
                for (let i = 0; i < equipmentWithPhotos.length; i++) {
                    doc.addPage();
                    const equipmentHTML = window.createEquipmentPage([equipmentWithPhotos[i]]);
                    await window.addHTMLPageToPDF(doc, equipmentHTML, pageWidth, pageHeight);
                }

                // íŒŒì¼ëª… ìƒì„±
                const filename = `${projectData.apartmentName}_${projectData.dong}_${projectData.ho}_ì¥ë¹„ì ê²€.pdf`;
                
                // iOSì—ì„œ ë‹¤ìš´ë¡œë“œ
                if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
                    const pdfBlob = doc.output('blob');
                    const blobUrl = URL.createObjectURL(pdfBlob);
                    
                    const link = document.createElement('a');
                    link.href = blobUrl;
                    link.download = filename;
                    link.style.display = 'none';
                    document.body.appendChild(link);
                    link.click();
                    
                    setTimeout(() => {
                        document.body.removeChild(link);
                        URL.revokeObjectURL(blobUrl);
                    }, 100);
                    
                    hideLoading();
                    showToast('ğŸ”§ ì¥ë¹„ì ê²€ ë³´ê³ ì„œê°€ ë‹¤ìš´ë¡œë“œ í´ë”ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                } else {
                    doc.save(filename);
                    hideLoading();
                    showToast('ğŸ”§ ì¥ë¹„ì ê²€ ë³´ê³ ì„œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤');
                }

            } catch (error) {
                console.error('ì¥ë¹„ì ê²€ PDF ìƒì„± ì˜¤ë¥˜:', error);
                hideLoading();
                alert('ì¥ë¹„ì ê²€ ë³´ê³ ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ==================== í˜„ì¥ì¶œë ¥ë³´ê³ ì„œ PDF ìƒì„± ====================
        window.generateFieldReportPDF = async function() {
            // âœ… 1. í”„ë¡œì íŠ¸ ì •ë³´ ê²€ì¦
            if (!projectData.apartmentName || !projectData.dong || !projectData.ho) {
                alert('í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // âœ… ì ê²€ì¼ì í•„ìˆ˜ í™•ì¸
            if (!projectData.inspectionDate) {
                alert('âš ï¸ ì ê²€ì¼ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // âœ… 2. í•˜ì ë°ì´í„° í™•ì¸
            if (!projectData.defects || projectData.defects.length === 0) {
                alert('âš ï¸ ë“±ë¡ëœ í•˜ìê°€ ì—†ìŠµë‹ˆë‹¤');
                return;
            }

            showLoading('í˜„ì¥ì¶œë ¥ë³´ê³ ì„œ ìƒì„± ì¤‘...');

            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                const pageWidth = 210;
                const pageHeight = 297;

                // ì‚¬ì§„ ìˆëŠ” í•˜ìë§Œ í•„í„°ë§
                const defectsWithPhotos = projectData.defects.filter(d => d.photos && d.photos.length > 0);
                
                // 1í˜ì´ì§€: í”„ë¡œì íŠ¸ ì •ë³´ + ì²« 11ê°œ í•˜ì
                const firstPageDefects = defectsWithPhotos.slice(0, 11);
                const firstPageHTML = createFieldReportFirstPage(firstPageDefects);
                await window.addHTMLPageToPDF(doc, firstPageHTML, pageWidth, pageHeight);

                // 2í˜ì´ì§€~: ë‚˜ë¨¸ì§€ í•˜ì (12ê°œì”©)
                const itemsPerPage = 12;
                const remainingDefects = defectsWithPhotos.slice(11);
                
                for (let i = 0; i < remainingDefects.length; i += itemsPerPage) {
                    doc.addPage();
                    const batch = remainingDefects.slice(i, i + itemsPerPage);
                    const tableHTML = createFieldReportTablePage(batch, i + 11); // ì¸ë±ìŠ¤ëŠ” 11ë¶€í„° ì‹œì‘
                    await window.addHTMLPageToPDF(doc, tableHTML, pageWidth, pageHeight);
                }

                // íŒŒì¼ëª… ìƒì„±
                const filename = `${projectData.apartmentName}_${projectData.dong}_${projectData.ho}_í˜„ì¥ì¶œë ¥.pdf`;
                
                // iOSì—ì„œ ë‹¤ìš´ë¡œë“œ
                if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
                    const pdfBlob = doc.output('blob');
                    const blobUrl = URL.createObjectURL(pdfBlob);
                    
                    const link = document.createElement('a');
                    link.href = blobUrl;
                    link.download = filename;
                    link.style.display = 'none';
                    document.body.appendChild(link);
                    link.click();
                    
                    setTimeout(() => {
                        document.body.removeChild(link);
                        URL.revokeObjectURL(blobUrl);
                    }, 100);
                    
                    hideLoading();
                    showToast('ğŸ“‹ í˜„ì¥ì¶œë ¥ë³´ê³ ì„œê°€ ë‹¤ìš´ë¡œë“œ í´ë”ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
                } else {
                    doc.save(filename);
                    hideLoading();
                    showToast('ğŸ“‹ í˜„ì¥ì¶œë ¥ë³´ê³ ì„œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤');
                }

            } catch (error) {
                console.error('í˜„ì¥ì¶œë ¥ë³´ê³ ì„œ ìƒì„± ì˜¤ë¥˜:', error);
                hideLoading();
                alert('í˜„ì¥ì¶œë ¥ë³´ê³ ì„œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // í˜„ì¥ì¶œë ¥ë³´ê³ ì„œ ì²« í˜ì´ì§€ ìƒì„± (í”„ë¡œì íŠ¸ ì •ë³´ + 9ê°œ í•˜ì, ìµœì  ì‚¬ì§„)
        function createFieldReportFirstPage(defects) {
            const rowsHTML = defects.map((defect, idx) => {
                const globalIndex = idx + 1;
                const photo1 = defect.photos && defect.photos[0] ? defect.photos[0] : '';
                const photo2 = defect.photos && defect.photos[1] ? defect.photos[1] : '';
                
                // ë°ì´í„° í•„ë“œëª… ì²˜ë¦¬ (ë³µìˆ˜í˜•/ë‹¨ìˆ˜í˜• ëª¨ë‘ ì§€ì›)
                const spaces = defect.spaces ? defect.spaces.join(', ') : (defect.space || '-');
                const types = defect.types ? defect.types.join(', ') : (defect.type || '-');
                const description = defect.description || defect.details || '-';
                
                return `
                    <tr>
                        <td style="padding: 5px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; font-size: 13px; background: #fff;">${globalIndex}</td>
                        <td style="padding: 5px; border: 1px solid #000; text-align: center; color: #000; font-size: 13px; font-weight: bold; background: #fff;">${spaces}</td>
                        <td style="padding: 5px; border: 1px solid #000; text-align: center; color: #000; font-size: 12px; font-weight: bold; background: #fff;">${types}</td>
                        <td style="padding: 5px 8px; border: 1px solid #000; color: #000; font-size: 12px; font-weight: 600; line-height: 1.4; background: #fff;">
                            ${description}
                            ${defect.date ? `<div style="color: #000; font-size: 10px; margin-top: 3px; font-weight: bold;">${defect.date}</div>` : ''}
                        </td>
                        <td style="padding: 4px; border: 1px solid #000; text-align: center; background: #fff;">
                            ${photo1 ? `<img src="${photo1}" style="width: 100px; height: 75px; object-fit: cover; display: block; margin: 0 auto; border: 1px solid #000;">` : '<div style="width: 100px; height: 75px; border: 1px solid #000; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #000; margin: 0 auto; font-weight: bold;">ì‚¬ì§„ì—†ìŒ</div>'}
                        </td>
                        <td style="padding: 4px; border: 1px solid #000; text-align: center; background: #fff;">
                            ${photo2 ? `<img src="${photo2}" style="width: 100px; height: 75px; object-fit: cover; display: block; margin: 0 auto; border: 1px solid #000;">` : '<div style="width: 100px; height: 75px; border: 1px solid #000; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #000; margin: 0 auto; font-weight: bold;">ì‚¬ì§„ì—†ìŒ</div>'}
                        </td>
                    </tr>
                `;
            }).join('');

            return `
                <div style="width: 794px; height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 22px 18px; position: relative; box-sizing: border-box;">
                    <!-- í—¤ë” -->
                    <div style="border: 2px solid #000; padding: 15px; margin-bottom: 12px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h1 style="margin: 0 0 5px 0; font-size: 22px; color: #000; font-weight: bold;">í•˜ìì ê²€ë¦¬ìŠ¤íŠ¸(ì œì¶œìš©)</h1>
                            <p style="margin: 0; font-size: 13px; color: #000; font-weight: 600;">${projectData.apartmentName} ${projectData.dong}ë™ ${projectData.ho}í˜¸ | ${projectData.inspectionDate || ''}</p>
                        </div>
                        <div style="text-align: right;">
                            <span style="font-size: 15px; color: #000; font-weight: bold;">ì´ ${projectData.defects.length}ê±´</span>
                        </div>
                    </div>

                    ${defects.length > 0 ? `
                    <!-- í…Œì´ë¸” -->
                    <table style="width: 100%; border-collapse: collapse; font-size: 12px; border: 2px solid #000;">
                        <thead>
                            <tr style="background: #e8e8e8;">
                                <th style="padding: 9px 5px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; width: 38px;">No</th>
                                <th style="padding: 9px 5px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; width: 58px;">ê³µê°„</th>
                                <th style="padding: 9px 5px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; width: 68px;">í•˜ì</th>
                                <th style="padding: 9px 5px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000;">ë‚´ìš©</th>
                                <th style="padding: 9px 5px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; width: 108px;">ì›ê²½</th>
                                <th style="padding: 9px 5px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; width: 108px;">ê·¼ì ‘</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${rowsHTML}
                        </tbody>
                    </table>
                    ` : ''}

                    <!-- í‘¸í„° -->
                    <div style="position: absolute; bottom: 12px; left: 18px; right: 18px; padding-top: 8px; border-top: 1px solid #000; font-size: 10px; color: #000; text-align: center; font-weight: bold;">
                        ë”í™ˆì ê²€ | ì „í™”: 070-8019-1456 / 010-9985-0128 | ì‚¬ì „ì ê²€ ì „ë¬¸ì—…ì²´
                    </div>
                </div>
            `;
        }

        // í˜„ì¥ì¶œë ¥ë³´ê³ ì„œ í…Œì´ë¸” í˜ì´ì§€ ìƒì„± (10ê°œì”©, ìµœì  ì‚¬ì§„, í‘ë°± ì¶œë ¥ ìµœì í™”)
        function createFieldReportTablePage(defects, startIndex) {
            const rowsHTML = defects.map((defect, idx) => {
                const globalIndex = startIndex + idx + 1;
                const photo1 = defect.photos && defect.photos[0] ? defect.photos[0] : '';
                const photo2 = defect.photos && defect.photos[1] ? defect.photos[1] : '';
                
                // ë°ì´í„° í•„ë“œëª… ì²˜ë¦¬ (ë³µìˆ˜í˜•/ë‹¨ìˆ˜í˜• ëª¨ë‘ ì§€ì›)
                const spaces = defect.spaces ? defect.spaces.join(', ') : (defect.space || '-');
                const types = defect.types ? defect.types.join(', ') : (defect.type || '-');
                const description = defect.description || defect.details || '-';
                
                return `
                    <tr>
                        <td style="padding: 4px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; font-size: 13px; background: #fff;">${globalIndex}</td>
                        <td style="padding: 4px; border: 1px solid #000; text-align: center; color: #000; font-size: 13px; font-weight: bold; background: #fff;">${spaces}</td>
                        <td style="padding: 4px; border: 1px solid #000; text-align: center; color: #000; font-size: 12px; font-weight: bold; background: #fff;">${types}</td>
                        <td style="padding: 4px 7px; border: 1px solid #000; color: #000; font-size: 12px; font-weight: 600; line-height: 1.3; background: #fff;">
                            ${description}
                            ${defect.date ? `<div style="color: #000; font-size: 10px; margin-top: 2px; font-weight: bold;">${defect.date}</div>` : ''}
                        </td>
                        <td style="padding: 3px; border: 1px solid #000; text-align: center; background: #fff;">
                            ${photo1 ? `<img src="${photo1}" style="width: 100px; height: 75px; object-fit: cover; display: block; margin: 0 auto; border: 1px solid #000;">` : '<div style="width: 100px; height: 75px; border: 1px solid #000; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #000; margin: 0 auto; font-weight: bold;">ì‚¬ì§„ì—†ìŒ</div>'}
                        </td>
                        <td style="padding: 3px; border: 1px solid #000; text-align: center; background: #fff;">
                            ${photo2 ? `<img src="${photo2}" style="width: 100px; height: 75px; object-fit: cover; display: block; margin: 0 auto; border: 1px solid #000;">` : '<div style="width: 100px; height: 75px; border: 1px solid #000; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #000; margin: 0 auto; font-weight: bold;">ì‚¬ì§„ì—†ìŒ</div>'}
                        </td>
                    </tr>
                `;
            }).join('');

            return `
                <div style="width: 794px; height: 1123px; background: white; padding: 18px 16px; font-family: 'Malgun Gothic', sans-serif; box-sizing: border-box;">
                    <!-- í—¤ë” -->
                    <div style="margin-bottom: 10px; padding-bottom: 7px; border-bottom: 3px solid #000;">
                        <h2 style="font-size: 15px; margin: 0; color: #000; font-weight: bold;">
                            ${projectData.apartmentName} ${projectData.dong}ë™ ${projectData.ho}í˜¸ - í•˜ìì ê²€ ëª©ë¡
                        </h2>
                    </div>

                    <!-- í…Œì´ë¸” -->
                    <table style="width: 100%; border-collapse: collapse; font-size: 12px; border: 2px solid #000;">
                        <thead>
                            <tr style="background: #e8e8e8;">
                                <th style="padding: 9px 4px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; width: 38px;">No</th>
                                <th style="padding: 9px 4px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; width: 58px;">ê³µê°„</th>
                                <th style="padding: 9px 4px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; width: 68px;">í•˜ì</th>
                                <th style="padding: 9px 5px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000;">ë‚´ìš©</th>
                                <th style="padding: 9px 4px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; width: 108px;">ì›ê²½</th>
                                <th style="padding: 9px 4px; border: 1px solid #000; text-align: center; font-weight: bold; color: #000; width: 108px;">ê·¼ì ‘</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${rowsHTML}
                        </tbody>
                    </table>

                    <!-- í‘¸í„° -->
                    <div style="position: absolute; bottom: 12px; left: 16px; right: 16px; text-align: right; font-size: 10px; color: #000; padding-top: 7px; border-top: 1px solid #000; font-weight: bold;">
                        ë”í™ˆì ê²€ | 070-8019-1456
                    </div>
                </div>
            `;
        }

        window.addHTMLPageToPDF = async function(doc, htmlContent, pageWidth, pageHeight) {
            const tempDiv = document.createElement('div');
            tempDiv.style.width = '794px';
            tempDiv.style.position = 'absolute';
            tempDiv.style.left = '-9999px';
            tempDiv.style.background = '#ffffff';
            tempDiv.innerHTML = htmlContent;
            document.body.appendChild(tempDiv);

            const canvas = await html2canvas(tempDiv, {
                scale: 2,
                useCORS: true,
                backgroundColor: '#ffffff',
                logging: false
            });

            document.body.removeChild(tempDiv);

            const imgData = canvas.toDataURL('image/jpeg', 0.95);
            const imgWidth = pageWidth;
            const imgHeight = (canvas.height * pageWidth) / canvas.width;
            
            doc.addImage(imgData, 'JPEG', 0, 0, imgWidth, Math.min(imgHeight, pageHeight));
        }

        window.addHTMLPageToPDF = async function(doc, htmlContent, pageWidth, pageHeight) {
            const tempDiv = document.createElement('div');
            tempDiv.style.width = '794px';
            tempDiv.style.position = 'absolute';
            tempDiv.style.left = '-9999px';
            tempDiv.style.background = '#ffffff';
            tempDiv.innerHTML = htmlContent;
            document.body.appendChild(tempDiv);

            const canvas = await html2canvas(tempDiv, {
                scale: 2,
                useCORS: true,
                backgroundColor: '#ffffff',
                logging: false
            });

            document.body.removeChild(tempDiv);

            const imgData = canvas.toDataURL('image/jpeg', 0.95);
            const imgWidth = pageWidth;
            const imgHeight = (canvas.height * pageWidth) / canvas.width;
            
            doc.addImage(imgData, 'JPEG', 0, 0, imgWidth, Math.min(imgHeight, pageHeight));
        }

        // ì²« í˜ì´ì§€: í”„ë¡œì íŠ¸ ì •ë³´ + í•˜ì ëª©ë¡ 10ê°œ
window.createSummaryFirstPage = function() {
            // ==================== ë¯¸ë‹ˆë©€ ëª¨ë˜ í‘œì§€ (ë ˆë“œ ì•…ì„¼íŠ¸) ====================
            return `
                <div style="width: 794px; height: 1123px; background: #ffffff; display: flex; flex-direction: column; font-family: 'Malgun Gothic', sans-serif; position: relative; box-sizing: border-box;">
                    
                    <!-- ìƒë‹¨ ë ˆë“œ ì•…ì„¼íŠ¸ ë°” -->
                    <div style="height: 8px; background: linear-gradient(90deg, #e74c3c 0%, #c0392b 100%);"></div>
                    
                    <!-- ì¢Œì¸¡ ì‚¬ì´ë“œ ì•…ì„¼íŠ¸ -->
                    <div style="position: absolute; left: 0; top: 0; width: 6px; height: 100%; background: linear-gradient(180deg, #e74c3c 0%, #c0392b 100%);"></div>
                    
                    <!-- ë©”ì¸ ì»¨í…ì¸  -->
                    <div style="flex: 1; padding: 50px 60px 45px 80px; display: flex; flex-direction: column;">
                        
                        <!-- ìƒë‹¨ ë¡œê³ /íƒ€ì… ì˜ì—­ -->
                        <div style="margin-bottom: 30px;">
                            <div style="display: inline-flex; align-items: center; gap: 12px; padding: 10px 20px; background: #fee2e2; border-radius: 30px;">
                                <div style="width: 8px; height: 8px; background: #e74c3c; border-radius: 50%;"></div>
                                <span style="color: #991b1b; font-size: 13px; font-weight: 600; letter-spacing: 1px;">INSPECTION REPORT</span>
                            </div>
                        </div>
                        
                        <!-- íƒ€ì´í‹€ -->
                        <div style="margin-bottom: 35px;">
                            <h1 style="font-size: 48px; font-weight: 800; color: #2c3e50; margin: 0 0 12px 0; line-height: 1.2;">
                                ì‚¬ì „ì ê²€<br/>ë³´ê³ ì„œ
                            </h1>
                            <div style="width: 70px; height: 4px; background: #e74c3c; border-radius: 3px;"></div>
                        </div>
                        
                        <!-- í”„ë¡œì íŠ¸ ì •ë³´ + í‰ë©´ë„ (í‰ë©´ë„ ìœ ë¬´ì— ë”°ë¼ ìë™ ë°°ì¹˜) -->
                        ${projectData.floorplan ? `
                            <!-- í‰ë©´ë„ ìˆìŒ: ê°€ë¡œ ë°°ì¹˜ -->
                            <div style="display: flex; gap: 20px; margin-bottom: 25px;">
                                <!-- ì¢Œì¸¡: í”„ë¡œì íŠ¸ ì •ë³´ ì¹´ë“œ -->
                                <div style="flex: 1; background: #fef2f2; border-left: 4px solid #e74c3c; padding: 25px 25px; border-radius: 0 8px 8px 0;">
                                    <div style="display: flex; flex-direction: column; gap: 14px;">
                                        <div style="display: flex; align-items: baseline;">
                                            <span style="color: #6b7280; font-size: 12px; width: 80px; font-weight: 600;">PROJECT</span>
                                            <span style="color: #2c3e50; font-size: 22px; font-weight: 700;">${projectData.apartmentName}</span>
                                        </div>
                                        <div style="display: flex; align-items: baseline;">
                                            <span style="color: #6b7280; font-size: 12px; width: 80px; font-weight: 600;">UNIT</span>
                                            <span style="color: #2c3e50; font-size: 26px; font-weight: 700;">${projectData.dong}ë™ ${projectData.ho}í˜¸</span>
                                        </div>
                                        <div style="display: flex; align-items: baseline;">
                                            <span style="color: #6b7280; font-size: 12px; width: 80px; font-weight: 600;">DATE</span>
                                            <span style="color: #2c3e50; font-size: 16px; font-weight: 500;">${projectData.inspectionDate || '-'}</span>
                                        </div>
                                        <div style="display: flex; align-items: baseline;">
                                            <span style="color: #6b7280; font-size: 12px; width: 80px; font-weight: 600;">CLIENT</span>
                                            <span style="color: #2c3e50; font-size: 16px; font-weight: 500;">${projectData.customerName || '-'}</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- ìš°ì¸¡: í‰ë©´ë„ -->
                                <div style="flex: 1; border: 2px solid #fee2e2; border-radius: 12px; overflow: hidden; background: #fef2f2; display: flex; align-items: center; justify-content: center;">
                                    <img src="${projectData.floorplan}" style="width: 100%; height: 180px; object-fit: contain; background: #ffffff;" />
                                </div>
                            </div>
                        ` : `
                            <!-- í‰ë©´ë„ ì—†ìŒ: í”„ë¡œì íŠ¸ ì •ë³´ë§Œ ì „ì²´ ë„ˆë¹„ -->
                            <div style="margin-bottom: 25px;">
                                <div style="background: #fef2f2; border-left: 4px solid #e74c3c; padding: 30px 35px; border-radius: 0 8px 8px 0;">
                                    <div style="display: flex; flex-direction: column; gap: 18px;">
                                        <div style="display: flex; align-items: baseline;">
                                            <span style="color: #6b7280; font-size: 13px; width: 100px; font-weight: 600;">PROJECT</span>
                                            <span style="color: #2c3e50; font-size: 26px; font-weight: 700;">${projectData.apartmentName}</span>
                                        </div>
                                        <div style="display: flex; align-items: baseline;">
                                            <span style="color: #6b7280; font-size: 13px; width: 100px; font-weight: 600;">UNIT</span>
                                            <span style="color: #2c3e50; font-size: 32px; font-weight: 700;">${projectData.dong}ë™ ${projectData.ho}í˜¸</span>
                                        </div>
                                        <div style="display: flex; align-items: baseline;">
                                            <span style="color: #6b7280; font-size: 13px; width: 100px; font-weight: 600;">DATE</span>
                                            <span style="color: #2c3e50; font-size: 20px; font-weight: 500;">${projectData.inspectionDate || '-'}</span>
                                        </div>
                                        <div style="display: flex; align-items: baseline;">
                                            <span style="color: #6b7280; font-size: 13px; width: 100px; font-weight: 600;">CLIENT</span>
                                            <span style="color: #2c3e50; font-size: 20px; font-weight: 500;">${projectData.customerName || '-'}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `}
                        
                        <!-- í•˜ì ìš”ì•½ -->
                        <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 12px; padding: 18px 22px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                <div style="width: 20px; height: 20px; background: #e74c3c; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px;">!</div>
                                <span style="color: #991b1b; font-size: 14px; font-weight: 700;">ì…ì£¼ ì „ ì‚¬ì „ì ê²€ ì™„ë£Œ</span>
                            </div>
                            <p style="color: #b91c1c; font-size: 11px; margin: 0 0 10px 0; line-height: 1.4; padding-left: 30px;">
                                ì „ë¬¸ ì¥ë¹„ë¥¼ í™œìš©í•œ ê¼¼ê¼¼í•œ í•˜ì ì ê²€ìœ¼ë¡œ ì•ˆì‹¬í•˜ê³  ì…ì£¼í•˜ì‹¤ ìˆ˜ ìˆë„ë¡ ë„ì™€ë“œë¦½ë‹ˆë‹¤.
                            </p>
                            <div style="display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #fecaca;">
                                <div style="text-align: center;">
                                    <div style="color: #6b7280; font-size: 10px; margin-bottom: 3px; font-weight: 600;">ì´ í•˜ì</div>
                                    <div style="color: #e74c3c; font-size: 24px; font-weight: 800;">${projectData.defects.length}</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="color: #6b7280; font-size: 10px; margin-bottom: 3px; font-weight: 600;">ì¦ë¹™ ì‚¬ì§„</div>
                                    <div style="color: #dc2626; font-size: 24px; font-weight: 800;">${projectData.defects.filter(d => d.photos && d.photos.length > 0).reduce((sum, d) => sum + d.photos.length, 0)}</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ì ê²€ í•­ëª© -->
                        <div style="padding: 15px 0; border-top: 2px solid #e5e7eb; border-bottom: 2px solid #e5e7eb; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <div style="width: 5px; height: 5px; background: #e74c3c; border-radius: 50%;"></div>
                                <span style="color: #374151; font-size: 12px; font-weight: 600;">ë²½ì²´ ìˆ˜ì§ ë° ë°”ë‹¥ ìˆ˜í‰ ì ê²€</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                <div style="width: 5px; height: 5px; background: #e74c3c; border-radius: 50%;"></div>
                                <span style="color: #374151; font-size: 12px; font-weight: 600;">ì‹¤ë‚´ ê³µê¸°ì§ˆ ì¸¡ì •</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 5px; height: 5px; background: #e74c3c; border-radius: 50%;"></div>
                                <span style="color: #374151; font-size: 12px; font-weight: 600;">ë§ˆê° í’ˆì§ˆ ë° ì‹œê³µ ìƒíƒœ ì ê²€</span>
                            </div>
                        </div>
                        
                        <!-- ì‚¬í›„ ê´€ë¦¬ ì•ˆë‚´ -->
                        <div style="background: #fef9c3; border: 1px solid #fcd34d; border-radius: 8px; padding: 12px 16px; margin-bottom: 15px;">
                            <div style="display: flex; align-items: flex-start; gap: 8px;">
                                <span style="font-size: 14px;">âš ï¸</span>
                                <div>
                                    <span style="color: #92400e; font-size: 11px; font-weight: 700;">ì‚¬í›„ ê´€ë¦¬ ì•ˆë‚´</span>
                                    <p style="color: #78350f; font-size: 10px; margin: 4px 0 0 0; line-height: 1.5;">
                                        í•˜ìì‚¬í•­ì€ ì¤€ê³µ ì´í›„ì—ë„ ì£¼ê¸°ì ìœ¼ë¡œ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, í•˜ìë‹´ë³´ì±…ì„ê¸°ê°„ ë‚´ ì •ê¸°ì ì¸ ì ê²€ê³¼ ê´€ë¦¬ë¥¼ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- í•˜ë‹¨ íšŒì‚¬ ì •ë³´ -->
                        <div style="margin-top: auto;">
                            <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                                <div>
                                    <h3 style="font-size: 24px; font-weight: 700; color: #2c3e50; margin: 0 0 6px 0;">ë”í™ˆì ê²€</h3>
                                    <p style="font-size: 13px; color: #6b7280; margin: 0;">The Home Inspection</p>
                                </div>
                                <div style="text-align: right;">
                                    <p style="font-size: 14px; color: #34495e; margin: 5px 0; font-weight: 500;">ğŸ“ 070-8019-1456</p>
                                    <p style="font-size: 12px; color: #6b7280; margin: 5px 0;">010-9985-0128</p>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            `;
        }



        // ë‚˜ë¨¸ì§€ í˜ì´ì§€: í•˜ì ëª©ë¡ë§Œ (20ê°œì”©)
        window.createDefectListPage = function(startIndex, itemsPerPage = 18) {
            let defectRows = '';
            const endIndex = Math.min(startIndex + itemsPerPage, projectData.defects.length);
            const defectsToDisplay = projectData.defects.slice(startIndex, endIndex);
            
            defectsToDisplay.forEach((defect, index) => {
                const globalIndex = startIndex + index + 1;
                const spaces = defect.spaces ? defect.spaces.join(', ') : (defect.space || '-');
                const locations = defect.locations ? defect.locations.join(', ') : (defect.location || '-');
                const types = defect.types ? defect.types.join(', ') : (defect.type || '-');
                const description = defect.description || '';
                
                defectRows += `
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 10px 4px; text-align: center; font-weight: bold; color: #000; font-size: 13px; vertical-align: middle; border-right: 1px solid #e0e0e0;">${globalIndex}</td>
                        <td style="padding: 10px 4px; text-align: center; color: #000; font-weight: 600; font-size: 13px; vertical-align: middle; border-right: 1px solid #e0e0e0;">${spaces}</td>
                        <td style="padding: 10px 4px; text-align: center; color: #000; font-weight: 600; font-size: 13px; vertical-align: middle; border-right: 1px solid #e0e0e0;">${locations}</td>
                        <td style="padding: 10px 4px; color: #000; font-weight: 600; font-size: 13px; vertical-align: middle; border-right: 1px solid #e0e0e0;">${types}</td>
                        <td style="padding: 10px 6px; color: #000; font-weight: 500; font-size: 12px; word-break: break-word; white-space: normal; line-height: 1.5; vertical-align: middle;">${description || '-'}</td>
                    </tr>
                `;
            });
            
            const totalPages = Math.ceil((projectData.defects.length - 15) / itemsPerPage) + 1;
            const currentPage = Math.floor((startIndex - 15) / itemsPerPage) + 2;
            const pageIndicator = ` (${currentPage}/${totalPages} í˜ì´ì§€)`;

            return `
                <div style="width: 794px; min-height: 1123px; max-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 35px; position: relative; box-sizing: border-box; overflow: hidden;">
                    <div style="margin-bottom: 20px;">
                        <h3 style="margin: 0 0 12px 0; font-size: 16px; color: #000; border-bottom: 2px solid #e74c3c; padding-bottom: 6px;">ğŸ“‹ í•˜ìì ê²€ ëª©ë¡ (ì´ ${projectData.defects.length}ê±´)${pageIndicator}</h3>
                        <p style="margin: 5px 0 12px 0; font-size: 12px; color: #333;">${projectData.apartmentName} ${projectData.dong}ë™ ${projectData.ho}í˜¸</p>
                    </div>

                    <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd; font-size: 13px; margin-bottom: 60px;">
                        <thead>
                            <tr style="background: #f8f9fa; border-bottom: 2px solid #999;">
                                <th style="padding: 10px 4px; width: 5%; color: #000; font-size: 13px; font-weight: bold; border-right: 1px solid #e0e0e0;">No</th>
                                <th style="padding: 10px 4px; width: 12%; color: #000; font-size: 13px; font-weight: bold; border-right: 1px solid #e0e0e0;">ê³µê°„</th>
                                <th style="padding: 10px 4px; width: 12%; color: #000; font-size: 13px; font-weight: bold; border-right: 1px solid #e0e0e0;">ìœ„ì¹˜</th>
                                <th style="padding: 10px 4px; width: 15%; color: #000; font-size: 13px; font-weight: bold; border-right: 1px solid #e0e0e0;">í•˜ìë‚´ìš©</th>
                                <th style="padding: 10px 6px; width: 52%; color: #000; font-size: 13px; font-weight: bold;">ìƒì„¸ì„¤ëª…</th>
                            </tr>
                        </thead>
                        <tbody>${defectRows}</tbody>
                    </table>

                    <div style="position: absolute; bottom: 20px; left: 35px; right: 35px; padding-top: 10px; border-top: 1px solid #ddd; font-size: 10px; color: #333; text-align: center;">
                        <div>ë”í™ˆì ê²€ | ì „í™”: 070-8019-1456 / 010-9985-0128 | ì‚¬ì „ì ê²€ ì „ë¬¸ì—…ì²´</div>
                    </div>
                </div>
            `;
        }


        // ğŸ“· ì‚¬ì§„ì— ì›Œí„°ë§ˆí¬ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
        window.addWatermarkToPhoto = async function(imageDataUrl, text) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    
                    const ctx = canvas.getContext('2d');
                    
                    // ì›ë³¸ ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
                    ctx.drawImage(img, 0, 0);
                    
                    // ì›Œí„°ë§ˆí¬ ë°°ì§€ í¬ê¸° (ì´ë¯¸ì§€ ë†’ì´ì˜ 6%ë¡œ ì¶•ì†Œ)
                    const badgeHeight = img.height * 0.06; // ì´ë¯¸ì§€ ë†’ì´ì˜ 6% (ë” ì‘ê²Œ)
                    const fontSize = badgeHeight * 0.5; // ë°°ì§€ ë†’ì´ì˜ 50%
                    
                    // í…ìŠ¤íŠ¸ ë„ˆë¹„ ì¸¡ì •
                    ctx.font = `bold ${fontSize}px Arial`;
                    const textWidth = ctx.measureText(text).width;
                    const badgeWidth = textWidth + badgeHeight * 0.4; // ì¢Œìš° ì—¬ë°± ì¤„ì„
                    const padding = badgeHeight * 0.2; // ì—¬ë°± ë¹„ìœ¨
                    
                    // ë°˜íˆ¬ëª… ê²€ì€ìƒ‰ ë°°ê²½ (ì§ì‚¬ê°í˜•)
                    ctx.fillStyle = 'rgba(0, 0, 0, 0.75)';
                    ctx.roundRect(20, 20, badgeWidth, badgeHeight, 12);
                    ctx.fill();
                    
                    // í°ìƒ‰ í…Œë‘ë¦¬
                    ctx.strokeStyle = 'rgba(255, 255, 255, 0.4)';
                    ctx.lineWidth = 3;
                    ctx.roundRect(20, 20, badgeWidth, badgeHeight, 12);
                    ctx.stroke();
                    
                    // í°ìƒ‰ í…ìŠ¤íŠ¸
                    ctx.fillStyle = '#FFFFFF';
                    ctx.font = `bold ${fontSize}px Arial`;
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(text, 20 + badgeWidth / 2, 20 + badgeHeight / 2);
                    
                    resolve(canvas.toDataURL('image/jpeg', 0.95));
                };
                img.src = imageDataUrl;
            });
        }

        window.createDefectDetailPage = async function(defects, startIndex) {
            let contentHTML = '';
            
            for (let idx = 0; idx < defects.length; idx++) {
                const defect = defects[idx];
                const globalIndex = startIndex + idx + 1;
                
                // ì›ë³¸ ì‚¬ì§„
                const farPhotoOriginal = defect.photos && defect.photos.length > 0 ? defect.photos[0] : '';
                const closePhotoOriginal = defect.photos && defect.photos.length > 1 ? defect.photos[1] : '';
                
                // ì›Œí„°ë§ˆí¬ ì¶”ê°€ëœ ì‚¬ì§„ (ë™í˜¸ìˆ˜ í¬í•¨)
                const dongHo = `${projectData.dong}ë™${projectData.ho}í˜¸`;
                const farPhoto = farPhotoOriginal ? await window.addWatermarkToPhoto(farPhotoOriginal, `${dongHo}_${globalIndex}`) : '';
                const closePhoto = closePhotoOriginal ? await window.addWatermarkToPhoto(closePhotoOriginal, `${dongHo}_${globalIndex}-1`) : '';
                
                // ë°°ì—´ì„ ë¬¸ìì—´ë¡œ ë³€í™˜ (í•˜ìœ„ í˜¸í™˜ì„±)
                const spaces = defect.spaces ? defect.spaces.join(', ') : (defect.space || '-');
                const description = defect.description || '';
                
                contentHTML += `
                    <div style="border: 1.5px solid #ddd; border-radius: 6px; padding: 12px; margin-bottom: 15px; background: white;">
                        <!-- í•˜ì ë²ˆí˜¸ í—¤ë” (ë” ì‘ê²Œ) -->
                        <div style="background: #f0f9ff; color: #000; border-bottom: 1.5px solid #3498db; padding: 8px 12px; margin: -12px -12px 12px -12px; border-radius: 5px 5px 0 0; font-size: 13px; font-weight: bold;">
                            í•˜ì ${globalIndex}
                        </div>
                        
                        <!-- ì •ë³´ í…Œì´ë¸” (ì»´íŒ©íŠ¸) -->
                        <table style="width: 100%; border-collapse: collapse; font-size: 11px; margin-bottom: 12px;">
                            <tr style="border-bottom: 1px solid #eee;">
                                <td style="padding: 6px; width: 18%; background: #f8f9fa; font-weight: bold; color: #000;">ê³µê°„</td>
                                <td style="padding: 6px; color: #000;">${spaces}</td>
                            </tr>
                            <tr>
                                <td style="padding: 6px; background: #f8f9fa; font-weight: bold; color: #000;">ìƒì„¸ì„¤ëª…</td>
                                <td style="padding: 6px; color: #000; font-weight: 600; line-height: 1.4;">${description || '-'}</td>
                            </tr>
                        </table>

                        <!-- ì‚¬ì§„ ì˜ì—­ (ìµœì í™”ëœ í¬ê¸°) -->
                        <div style="display: flex; gap: 10px;">
                            <div style="flex: 1; border: 1px solid #ddd; border-radius: 4px; overflow: hidden;">
                                <div style="padding: 6px; text-align: center; font-weight: bold; font-size: 11px; color: #000; background: #e8f5e9; border-bottom: 1px solid #10b981;">
                                    ğŸ“· ì›ê²½ (ë©€ë¦¬ì„œ)
                                </div>
                                ${farPhoto ? `
                                    <img src="${farPhoto}" style="width: 100%; height: 280px; object-fit: contain; display: block; background: #fafafa;" />
                                ` : `
                                    <div style="width: 100%; height: 280px; background: #f5f5f5; display: flex; align-items: center; justify-content: center; color: #333; font-size: 11px;">ì‚¬ì§„ ì—†ìŒ</div>
                                `}
                            </div>

                            <div style="flex: 1; border: 1px solid #ddd; border-radius: 4px; overflow: hidden;">
                                <div style="padding: 6px; text-align: center; font-weight: bold; font-size: 11px; color: #000; background: #fff7ed; border-bottom: 1px solid #f59e0b;">
                                    ğŸ“· ê·¼ê²½ (ê°€ê¹Œì´ì„œ)
                                </div>
                                ${closePhoto ? `
                                    <img src="${closePhoto}" style="width: 100%; height: 280px; object-fit: contain; display: block; background: #fafafa;" />
                                ` : `
                                    <div style="width: 100%; height: 280px; background: #f5f5f5; display: flex; align-items: center; justify-content: center; color: #333; font-size: 11px;">ì‚¬ì§„ ì—†ìŒ</div>
                                `}
                            </div>
                        </div>
                    </div>
                `;
            }

            return `
                <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 35px; box-sizing: border-box;">
                    <div style="background: #ffebee; border: 1.5px solid #e74c3c; padding: 15px; margin-bottom: 20px; border-radius: 6px;">
                        <h2 style="margin: 0 0 5px 0; font-size: 20px; color: #000;">í•˜ì ìƒì„¸ ì‚¬ì§„ (ì›ê²½+ê·¼ê²½)</h2>
                        <p style="margin: 0; font-size: 12px; color: #000;">${projectData.apartmentName} ${projectData.dong}ë™ ${projectData.ho}í˜¸ | ${projectData.inspectionDate || ''}</p>
                    </div>

                    ${contentHTML}

                    <div style="position: absolute; bottom: 20px; left: 35px; right: 35px; padding-top: 10px; border-top: 1px solid #ddd; font-size: 10px; color: #333; text-align: center;">
                        <div>ë”í™ˆì ê²€ | ì „í™”: 070-8019-1456 / 010-9985-0128 | ì‚¬ì „ì ê²€ ì „ë¬¸ì—…ì²´</div>
                    </div>
                </div>
            `;
        }


        // === ì¥ë¹„ì ê²€ ì¸¡ì • ë³´ê³ ì„œ í˜ì´ì§€ (3ê°œì”©) ===
        window.createEquipmentPage = function(equipmentList, startIndex) {
            let contentHTML = '';
            
            equipmentList.forEach((item, idx) => {
                const globalIndex = startIndex + idx + 1;
                
                // í•˜ìœ„ í˜¸í™˜ì„±
                const space = item.space || (item.spaces ? item.spaces.join(', ') : '-');
                
                // í•˜ìœ„ í˜¸í™˜ì„±: ê¸°ì¡´ 4ê°œ êµ¬ì¡°ë¥¼ 4ê°œë¡œ ë³€í™˜
                if (item.photos && item.photos['ì¢Œì¸¡ìƒë‹¨']) {
                    item.photos = {
                        'ì¢Œì¸¡': item.photos['ì¢Œì¸¡ìƒë‹¨'] || item.photos['ì¢Œì¸¡í•˜ë‹¨'] || null,
                        'ìš°ì¸¡': item.photos['ìš°ì¸¡ìƒë‹¨'] || item.photos['ìš°ì¸¡í•˜ë‹¨'] || null,
                        'ë°”ë‹¥1': item.photos['ë°”ë‹¥'] || null,
                        'ë°”ë‹¥2': null
                    };
                } else if (item.photos && item.photos['ë°”ë‹¥'] && !item.photos['ë°”ë‹¥1']) {
                    // ê¸°ì¡´ 'ë°”ë‹¥'ì„ 'ë°”ë‹¥1'ë¡œ ë³€í™˜
                    item.photos['ë°”ë‹¥1'] = item.photos['ë°”ë‹¥'];
                    delete item.photos['ë°”ë‹¥'];
                    if (!item.photos['ë°”ë‹¥2']) item.photos['ë°”ë‹¥2'] = null;
                }
                
                // photos ê°ì²´ê°€ ìˆìœ¼ë©´ ìœ„ì¹˜ë³„ ì‚¬ì§„, ì—†ìœ¼ë©´ ë‹¨ì¼ ì‚¬ì§„ (êµ¬ ë²„ì „)
                const hasLocationPhotos = item.photos && typeof item.photos === 'object';
                
                contentHTML += `
                    <div style="border: 1px solid #ddd; border-radius: 8px; padding: 0; background: white; margin-bottom: 20px; page-break-inside: avoid;">
                        <!-- í—¤ë” -->
                        <div style="background: #f8f9fa; padding: 10px 15px; border-bottom: 1px solid #ddd;">
                            <strong style="font-size: 16px; color: #000;">ì¥ë¹„ì ê²€ ${globalIndex} - ${space}</strong>
                        </div>
                        
                        <!-- ì ê²€ê²°ê³¼ -->
                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; font-weight: bold; text-align: center; background: #f8f9fa; color: #000; width: 25%;">ì ê²€ê²°ê³¼</td>
                                <td style="padding: 10px; border-bottom: 1px solid #ddd; color: #000;">${item.inspection || 'ë²½ì²´ìˆ˜ì§ ë° ë°”ë‹¥ìˆ˜í‰ / ë‹¨ì—´ì‹œê³µ ì–‘í˜¸'}</td>
                            </tr>
                        </table>

                        ${hasLocationPhotos ? `
                            <!-- ì‚¬ì§„ ì˜ì—­ -->
                            <div style="padding: 0 15px 15px 15px;">
                                ${(() => {
                                    // ì‚¬ì§„ ë°°ì—´ë¡œ ë³€í™˜ (null ì•„ë‹Œ ê²ƒë§Œ)
                                    const photoList = [];
                                    const locations = ['ì¢Œì¸¡', 'ìš°ì¸¡', 'ë°”ë‹¥1', 'ë°”ë‹¥2'];
                                    const colors = { 'ì¢Œì¸¡': '#3498db', 'ìš°ì¸¡': '#e74c3c', 'ë°”ë‹¥1': '#f39c12', 'ë°”ë‹¥2': '#f39c12' };
                                    const icons = { 'ì¢Œì¸¡': 'â¬…ï¸', 'ìš°ì¸¡': 'â¡ï¸', 'ë°”ë‹¥1': 'â¬‡ï¸', 'ë°”ë‹¥2': 'â¬‡ï¸' };
                                    
                                    locations.forEach(loc => {
                                        if (item.photos[loc]) {
                                            photoList.push({
                                                name: loc,
                                                photo: item.photos[loc],
                                                color: colors[loc],
                                                icon: icons[loc]
                                            });
                                        }
                                    });
                                    
                                    if (photoList.length === 0) {
                                        return `
                                            <div style="padding: 40px; text-align: center; color: #333; background: #f8f9fa; border-radius: 6px;">
                                                <div style="font-size: 14px; margin-bottom: 8px;">ğŸ“· ì´¬ì˜ëœ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤</div>
                                                <div style="font-size: 11px;">ì¥ë¹„ì ê²€ ì‹œ ì‚¬ì§„ì„ ì²¨ë¶€í•´ì£¼ì„¸ìš”</div>
                                            </div>
                                        `;
                                    }
                                    
                                    let html = '';
                                    
                                    // 1ì¤„: ì¢Œì¸¡, ìš°ì¸¡ (2ì¹¸ ê³ ì •)
                                    const topPhotos = [
                                        item.photos['ì¢Œì¸¡'] ? { name: 'ì¢Œì¸¡', photo: item.photos['ì¢Œì¸¡'], color: colors['ì¢Œì¸¡'], icon: icons['ì¢Œì¸¡'] } : null,
                                        item.photos['ìš°ì¸¡'] ? { name: 'ìš°ì¸¡', photo: item.photos['ìš°ì¸¡'], color: colors['ìš°ì¸¡'], icon: icons['ìš°ì¸¡'] } : null
                                    ].filter(p => p);
                                    
                                    if (topPhotos.length > 0) {
                                        html += `<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">`;
                                        topPhotos.forEach(loc => {
                                            html += `
                                                <div style="border: 1px solid #ddd; border-radius: 4px; overflow: hidden;">
                                                    <div style="padding: 8px; text-align: center; font-weight: bold; font-size: 12px; color: #333; border-bottom: 3px solid ${loc.color};">
                                                        ${loc.icon} ${loc.name}
                                                    </div>
                                                    <img src="${loc.photo}" style="width: 100%; height: 240px; object-fit: cover; display: block;" />
                                                </div>
                                            `;
                                        });
                                        // ì¢Œì¸¡ì´ë‚˜ ìš°ì¸¡ ì¤‘ í•˜ë‚˜ë§Œ ìˆìœ¼ë©´ ë¹ˆì¹¸ ì¶”ê°€
                                        if (topPhotos.length === 1) {
                                            html += `
                                                <div style="border: 1px solid #ddd; border-radius: 4px; overflow: hidden; background: #f8f9fa;">
                                                    <div style="padding: 8px; text-align: center; font-weight: bold; font-size: 12px; color: #333; border-bottom: 3px solid #ddd;">
                                                        ì‚¬ì§„ ì—†ìŒ
                                                    </div>
                                                    <div style="width: 100%; height: 240px; display: flex; align-items: center; justify-content: center; color: #ccc; font-size: 48px;">ğŸ“·</div>
                                                </div>
                                            `;
                                        }
                                        html += `</div>`;
                                    }
                                    
                                    // 2ì¤„: ë°”ë‹¥ ì‚¬ì§„ ì²˜ë¦¬
                                    const hasFloor1 = item.photos['ë°”ë‹¥1'] ? true : false;
                                    const hasFloor2 = item.photos['ë°”ë‹¥2'] ? true : false;
                                    
                                    if (hasFloor1 && hasFloor2) {
                                        // ë°”ë‹¥ 2ì¥ ëª¨ë‘ ìˆìœ¼ë©´ â†’ 2ì¹¸ìœ¼ë¡œ ë‚˜ë€íˆ
                                        html += `
                                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                                <div style="border: 1px solid #ddd; border-radius: 4px; overflow: hidden;">
                                                    <div style="padding: 8px; text-align: center; font-weight: bold; font-size: 12px; color: #333; border-bottom: 3px solid ${colors['ë°”ë‹¥1']};">
                                                        ${icons['ë°”ë‹¥1']} ë°”ë‹¥1
                                                    </div>
                                                    <img src="${item.photos['ë°”ë‹¥1']}" style="width: 100%; height: 240px; object-fit: cover; display: block;" />
                                                </div>
                                                <div style="border: 1px solid #ddd; border-radius: 4px; overflow: hidden;">
                                                    <div style="padding: 8px; text-align: center; font-weight: bold; font-size: 12px; color: #333; border-bottom: 3px solid ${colors['ë°”ë‹¥2']};">
                                                        ${icons['ë°”ë‹¥2']} ë°”ë‹¥2
                                                    </div>
                                                    <img src="${item.photos['ë°”ë‹¥2']}" style="width: 100%; height: 240px; object-fit: cover; display: block;" />
                                                </div>
                                            </div>
                                        `;
                                    } else if (hasFloor1 || hasFloor2) {
                                        // ë°”ë‹¥ 1ì¥ë§Œ ìˆìœ¼ë©´ â†’ ì¤‘ì•™ì— í‘œì‹œ (í¼ì§€ì§€ ì•Šê²Œ)
                                        const floorPhoto = hasFloor1 ? { name: 'ë°”ë‹¥1', photo: item.photos['ë°”ë‹¥1'], color: colors['ë°”ë‹¥1'], icon: icons['ë°”ë‹¥1'] } 
                                                                      : { name: 'ë°”ë‹¥2', photo: item.photos['ë°”ë‹¥2'], color: colors['ë°”ë‹¥2'], icon: icons['ë°”ë‹¥2'] };
                                        html += `
                                            <div style="display: flex; justify-content: center;">
                                                <div style="width: 60%; border: 1px solid #ddd; border-radius: 4px; overflow: hidden;">
                                                    <div style="padding: 8px; text-align: center; font-weight: bold; font-size: 12px; color: #333; border-bottom: 3px solid ${floorPhoto.color};">
                                                        ${floorPhoto.icon} ${floorPhoto.name}
                                                    </div>
                                                    <img src="${floorPhoto.photo}" style="width: 100%; height: 280px; object-fit: cover; display: block;" />
                                                </div>
                                            </div>
                                        `;
                                    }
                                    
                                    return html;
                                })()}
                            </div>
                        ` : `
                            <!-- ë‹¨ì¼ ì‚¬ì§„ (êµ¬ ë²„ì „ í˜¸í™˜) -->
                            <div style="text-align: center;">
                                <div style="padding: 8px; text-align: center; font-weight: bold; font-size: 12px; color: #333; border: 1px solid #ddd; border-bottom: 3px solid #2c3e50; border-radius: 4px 4px 0 0;">
                                    ì´¬ì˜ ì‚¬ì§„
                                </div>
                                ${item.photo ? `
                                    <img src="${item.photo}" style="width: 100%; max-height: 350px; object-fit: contain; border: 1px solid #ddd; border-top: none;" />
                                ` : `
                                    <div style="width: 100%; height: 250px; background: #f9f9f9; border: 1px solid #ddd; border-top: none; display: flex; align-items: center; justify-content: center; color: #333; font-size: 12px;">ì‚¬ì§„ ì—†ìŒ</div>
                                `}
                            </div>
                        `}
                    </div>
                `;
            });

            return `
                <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 30px;">
                    <div style="background: white; color: #000; padding: 15px 20px; margin-bottom: 20px; border-radius: 8px; border: 1px solid #ddd;">
                        <h2 style="margin: 0; font-size: 20px; font-weight: bold;">ì¥ë¹„ ì¸¡ì • ë³´ê³ ì„œ</h2>
                        <p style="margin: 5px 0 0 0; font-size: 13px; color: #333;">${projectData.apartmentName} ${projectData.dong}ë™ ${projectData.ho}í˜¸ | ${projectData.inspectionDate || ''}</p>
                    </div>

                    ${contentHTML}

                    <div style="position: absolute; bottom: 20px; left: 30px; right: 30px; padding-top: 15px; border-top: 1px solid #ddd; font-size: 11px; color: #333;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>ë”í™ˆì ê²€ | 070-8019-1456</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ì°¸ê³ ìë£Œ í˜ì´ì§€ ìƒì„± í•¨ìˆ˜ë“¤
        window.createWarrantyGuidePage1 = function() {
            return `
                <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 40px; position: relative;">
                    <h2 style="margin: 0 0 25px 0; font-size: 22px; color: #000; border-bottom: 3px solid #e74c3c; padding-bottom: 12px;">ğŸ“ í•˜ìë³´ìˆ˜ ì²­êµ¬ ê°€ì´ë“œ</h2>

                    <div style="background: #ffebee; border-left: 4px solid #e74c3c; padding: 18px; margin-bottom: 25px; border-radius: 4px;">
                        <p style="margin: 0; color: #000; font-size: 14px; line-height: 1.8; font-weight: 500;">
                            í•˜ìë¥¼ ë°œê²¬í•˜ì…¨ë‚˜ìš”? í•˜ìë‹´ë³´ì±…ì„ ê¸°ê°„ ë‚´ì— ì ì ˆí•œ ì ˆì°¨ë¡œ ë³´ìˆ˜ ì²­êµ¬í•˜ì‹œë©´ ë¬´ìƒìœ¼ë¡œ ìˆ˜ë¦¬ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                    </div>

                    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: white;">
                        <div style="background: #e3f2fd; color: #000; border-bottom: 2px solid #3498db; padding: 12px 18px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            1ë‹¨ê³„: í•˜ì ë°œê²¬ ì¦‰ì‹œ ì‚¬ì§„ ì´¬ì˜ ë° ê¸°ë¡
                        </div>
                        <ul style="margin: 0; padding-left: 20px; font-size: 13px; color: #000; line-height: 2;">
                            <li><strong>ì›ê²½ ì‚¬ì§„:</strong> í•˜ìê°€ ì–´ëŠ ìœ„ì¹˜ì— ìˆëŠ”ì§€ ì „ì²´ì ì¸ ê³µê°„ ì´¬ì˜</li>
                            <li><strong>ê·¼ì ‘ ì‚¬ì§„:</strong> í•˜ì ë¶€ìœ„ë¥¼ í™•ëŒ€í•˜ì—¬ ìƒì„¸í•˜ê²Œ ì´¬ì˜</li>
                            <li><strong>ê¸°ë¡ ì‚¬í•­:</strong> ë°œê²¬ ë‚ ì§œ, ìœ„ì¹˜(ê³µê°„), í•˜ì ë‚´ìš©ì„ ë©”ëª¨</li>
                        </ul>
                    </div>

                    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: white;">
                        <div style="background: #e8f5e9; color: #000; border-bottom: 2px solid #2ecc71; padding: 12px 18px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            2ë‹¨ê³„: í•˜ìë³´ìˆ˜ ì‹ ì²­
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 4px; border: 1px solid #f39c12; margin-bottom: 15px;">
                            <p style="margin: 0; color: #000; font-size: 13px; line-height: 1.8;">
                                <strong>ì‹ ì²­ ë°©ë²•</strong><br>
                                â‘  <strong>ê´€ë¦¬ì‚¬ë¬´ì†Œ</strong>ì— ì ‘ìˆ˜ (ì¼ë°˜ì ì¸ ë°©ë²•)<br>
                                â‘¡ <strong>ì‹œê³µì‚¬ A/Sì„¼í„°</strong>ì— ì§ì ‘ ì ‘ìˆ˜ (ê¸´ê¸‰ í•˜ì, ëŒ€ì‘ ë¯¸í¡ ì‹œ)
                            </p>
                        </div>
                        
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 4px; border: 1px solid #3498db;">
                            <p style="margin: 0 0 10px 0; color: #000; font-size: 13px; font-weight: bold;">ğŸ“Œ ì œì¶œ ì„œë¥˜</p>
                            <ul style="margin: 0; padding-left: 20px; font-size: 13px; color: #000; line-height: 1.8;">
                                <li>í•˜ìë³´ìˆ˜ ì‹ ì²­ì„œ</li>
                                <li>í•˜ì ì‚¬ì§„ (ì›ê²½, ê·¼ì ‘)</li>
                                <li>ì…ì£¼ì ì •ë³´ (ë™/í˜¸ìˆ˜, ì—°ë½ì²˜)</li>
                            </ul>
                        </div>
                    </div>

                    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; background: white;">
                        <div style="background: #fff3e0; color: #000; border-bottom: 2px solid #f39c12; padding: 12px 18px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            3ë‹¨ê³„: ì‹œê³µì‚¬ì˜ í•˜ì í™•ì¸ ë° ë³´ìˆ˜
                        </div>
                        <ul style="margin: 0; padding-left: 20px; font-size: 13px; color: #000; line-height: 2;">
                            <li>ì‹œê³µì‚¬ì—ì„œ í•˜ì í™•ì¸ì„ ìœ„í•´ ë°©ë¬¸ (ì¼ì • í˜‘ì˜, ë³´í†µ 1~2ì£¼ ì†Œìš”)</li>
                            <li>í•˜ì ì¸ì • ì‹œ ë³´ìˆ˜ ì¼ì • í˜‘ì˜ ë° ì‹œí–‰</li>
                            <li>ë³´ìˆ˜ ì™„ë£Œ í›„ ì…ì£¼ì í™•ì¸ ë° ì„œëª…</li>
                            <li><strong>ëŒ€ì‘ ì§€ì—° ì‹œ:</strong> ì‹œê³µì‚¬ ë³¸ì‚¬ A/Sì„¼í„°, í•œêµ­ì†Œë¹„ìì›(1372) ìƒë‹´</li>
                        </ul>
                    </div>

                    <div style="position: absolute; bottom: 25px; left: 40px; right: 40px; padding-top: 15px; border-top: 1px solid #ddd; font-size: 12px; color: #000; text-align: center; font-weight: 500;">
                        <div>ë”í™ˆì ê²€ | ì „í™”: 070-8019-1456 / 010-9985-0128</div>
                    </div>
                </div>
            `;
        }

        window.createWarrantyGuidePage2 = function() {
            return `
                <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 40px; position: relative;">
                    <h2 style="margin: 0 0 25px 0; font-size: 22px; color: #000; border-bottom: 3px solid #e74c3c; padding-bottom: 12px;">â° í•˜ìë‹´ë³´ì±…ì„ ê¸°ê°„ ìƒì„¸</h2>

                    <div style="background: #ffebee; border-left: 4px solid #e74c3c; padding: 18px; margin-bottom: 25px; border-radius: 4px;">
                        <p style="margin: 0; color: #000; font-size: 14px; line-height: 1.8; font-weight: 500;">
                            <strong>ê³µë™ì£¼íƒê´€ë¦¬ë²• ì‹œí–‰ë ¹ ì œ36ì¡°</strong>ì— ë”°ë¼ ì‚¬ì—…ì£¼ì²´ëŠ” í•˜ìë‹´ë³´ì±…ì„ ê¸°ê°„ ë™ì•ˆ ë¬´ìƒ ë³´ìˆ˜ ì˜ë¬´ê°€ ìˆìŠµë‹ˆë‹¤.
                        </p>
                    </div>

                    <div style="border: 2px solid #e74c3c; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: white;">
                        <div style="background: #ffebee; color: #000; padding: 12px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            â‘  ë‚´ë ¥êµ¬ì¡°ë¶€ - 10ë…„
                        </div>
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; width: 25%; background: #f8f9fa; font-weight: bold; color: #000;">ëŒ€ìƒ</td>
                                <td style="padding: 12px; color: #000;">ê¸°ë‘¥, ë³´, ë‚´ë ¥ë²½, ì£¼ê³„ë‹¨, ì§€ë¶•í‹€, ë°”ë‹¥</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">ì˜ˆì‹œ</td>
                                <td style="padding: 12px; color: #000;">êµ¬ì¡° ê· ì—´, ë¶€ë“±ì¹¨í•˜, ê¸°ë‘¥Â·ë³´ íŒŒì†</td>
                            </tr>
                        </table>
                    </div>

                    <div style="border: 2px solid #f39c12; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: white;">
                        <div style="background: #fff3e0; color: #000; padding: 12px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            â‘¡ ì£¼ìš” ì„¤ë¹„ - 3ë…„
                        </div>
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; width: 25%; background: #f8f9fa; font-weight: bold; color: #000;">ëŒ€ìƒ</td>
                                <td style="padding: 12px; color: #000;">ë‚œë°©Â·ê¸‰ë°°ìˆ˜Â·ì „ê¸°Â·ê°€ìŠ¤Â·ì†Œë°©Â·í™˜ê¸°</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">ì˜ˆì‹œ</td>
                                <td style="padding: 12px; color: #000;">ë³´ì¼ëŸ¬ ê³ ì¥, ìˆ˜ì „ ëˆ„ìˆ˜, ë°°ê´€ ë§‰í˜, ëˆ„ì „</td>
                            </tr>
                        </table>
                    </div>

                    <div style="border: 2px solid #3498db; border-radius: 8px; padding: 20px; background: white;">
                        <div style="background: #e3f2fd; color: #000; padding: 12px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            â‘¢ ë§ˆê°ì¬ - 2ë…„
                        </div>
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; width: 25%; background: #f8f9fa; font-weight: bold; color: #000;">ëŒ€ìƒ</td>
                                <td style="padding: 12px; color: #000;">ë„ë°°, ì¥íŒ, íƒ€ì¼, ë„ì¥, ì°½í˜¸</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">ì˜ˆì‹œ</td>
                                <td style="padding: 12px; color: #000;">ë„ë°° ë“¤ëœ¸, ì¥íŒ ë³€ìƒ‰, íƒ€ì¼ ê· ì—´</td>
                            </tr>
                        </table>
                    </div>

                    <div style="position: absolute; bottom: 25px; left: 40px; right: 40px; padding-top: 15px; border-top: 1px solid #ddd; font-size: 12px; color: #000; text-align: center; font-weight: 500;">
                        <div>ë”í™ˆì ê²€ | ì „í™”: 070-8019-1456 / 010-9985-0128</div>
                    </div>
                </div>
            `;
        }

        window.createAirQualityManagementGuidePage = function() {
            return `
                <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 40px; position: relative;">
                    <h2 style="margin: 0 0 25px 0; font-size: 22px; color: #000; border-bottom: 3px solid #2ecc71; padding-bottom: 12px;">ğŸŒ¿ ì‹¤ë‚´ ê³µê¸°ì§ˆ ê´€ë¦¬ ê°€ì´ë“œ</h2>

                    <div style="background: #e8f5e9; border-left: 4px solid #2ecc71; padding: 18px; margin-bottom: 25px; border-radius: 4px;">
                        <p style="margin: 0; color: #000; font-size: 14px; line-height: 1.8; font-weight: 500;">
                            ìƒˆ ì•„íŒŒíŠ¸ëŠ” ìì¬ì—ì„œ ë‚˜ì˜¤ëŠ” ìœ í•´ë¬¼ì§ˆë¡œ ì¸í•´ ì‹¤ë‚´ ê³µê¸°ì§ˆì´ ë‚˜ì  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
                            ì…ì£¼ ì „í›„ ì ì ˆí•œ í™˜ê¸°ì™€ ê´€ë¦¬ë¡œ ì¾Œì í•œ ì‹¤ë‚´ í™˜ê²½ì„ ë§Œë“œì„¸ìš”.
                        </p>
                    </div>

                    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: white;">
                        <div style="background: #e3f2fd; color: #000; border-bottom: 2px solid #3498db; padding: 12px 18px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            1. ìì£¼ í™˜ê¸°í•˜ê¸° (ê°€ì¥ ì¤‘ìš”!)
                        </div>
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; width: 30%; background: #f8f9fa; font-weight: bold; color: #000;">í™˜ê¸° íšŸìˆ˜</td>
                                <td style="padding: 12px; color: #000;">í•˜ë£¨ 3íšŒ ì´ìƒ (ì•„ì¹¨, ì ì‹¬, ì €ë…)</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">í™˜ê¸° ì‹œê°„</td>
                                <td style="padding: 12px; color: #000;">íšŒë‹¹ ìµœì†Œ 30ë¶„ (ë§ë°”ëŒ ì¹˜ë„ë¡ ëŒ€ê°ì„  ì°½ë¬¸ ê°œë°©)</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">í™˜ê¸° ì‹œê¸°</td>
                                <td style="padding: 12px; color: #000;">ì…ì£¼ 2ì£¼ ì „ë¶€í„° ë§¤ì¼ í™˜ê¸°</td>
                            </tr>
                        </table>
                    </div>

                    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: white;">
                        <div style="background: #ffebee; color: #000; border-bottom: 2px solid #e74c3c; padding: 12px 18px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            2. ë² ì´í¬ì•„ì›ƒ (Bake-Out)
                        </div>
                        <div style="background: #fff3e0; padding: 15px; border-radius: 4px; border: 1px solid #f39c12; margin-bottom: 15px;">
                            <p style="margin: 0; color: #000; font-size: 13px; line-height: 1.8; font-weight: 500;">
                                <strong>ë² ì´í¬ì•„ì›ƒì´ë€?</strong> ì‹¤ë‚´ ì˜¨ë„ë¥¼ ë†’ì—¬ì„œ ê±´ì¶• ìì¬ì˜ ìœ í•´ë¬¼ì§ˆì„ ë¹ ë¥´ê²Œ ë°°ì¶œì‹œí‚¤ëŠ” ë°©ë²•
                            </p>
                        </div>
                        <ul style="margin: 0; padding-left: 20px; font-size: 13px; color: #000; line-height: 2;">
                            <li><strong>ë°©ë²•:</strong> ëª¨ë“  ì°½ë¬¸ ë‹«ê³  ë‚œë°©ìœ¼ë¡œ 30~35ë„ê¹Œì§€ ì˜¬ë¦¼</li>
                            <li><strong>ì‹œê°„:</strong> 6~8ì‹œê°„ ìœ ì§€ í›„ 2ì‹œê°„ ì´ìƒ í™˜ê¸°</li>
                            <li><strong>ë°˜ë³µ:</strong> ì´ ê³¼ì •ì„ 3~5íšŒ ë°˜ë³µí•˜ë©´ íš¨ê³¼ì </li>
                        </ul>
                    </div>

                    <div style="border: 2px solid #3498db; border-radius: 8px; padding: 20px; background: #e3f2fd;">
                        <h3 style="margin: 0 0 15px 0; color: #3498db; font-size: 17px; font-weight: bold;">ğŸ“Š ì‹¤ë‚´ ê³µê¸°ì§ˆ ê¶Œê³ ê¸°ì¤€</h3>
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px; background: white;">
                            <thead>
                                <tr style="background: #f8f9fa; border: 1px solid #ddd;">
                                    <th style="padding: 12px; color: #000; font-weight: bold; border: 1px solid #ddd;">ì˜¤ì—¼ë¬¼ì§ˆ</th>
                                    <th style="padding: 12px; color: #000; font-weight: bold; border: 1px solid #ddd;">ê¶Œê³ ê¸°ì¤€</th>
                                    <th style="padding: 12px; color: #000; font-weight: bold; border: 1px solid #ddd;">ê±´ê°•ì˜í–¥</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="border: 1px solid #ddd;">
                                    <td style="padding: 10px; font-weight: bold; color: #000; border: 1px solid #ddd;">ë¼ëˆ(Rn)</td>
                                    <td style="padding: 10px; color: #e74c3c; font-weight: bold; text-align: center; border: 1px solid #ddd;">148 ì´í•˜</td>
                                    <td style="padding: 10px; color: #000; border: 1px solid #ddd;">íì•” ìœ ë°œ 1ê¸‰ ë°œì•”ë¬¼ì§ˆ</td>
                                </tr>
                                <tr style="border: 1px solid #ddd;">
                                    <td style="padding: 10px; font-weight: bold; color: #000; border: 1px solid #ddd;">í¬ë¦„ì•Œë°íˆë“œ</td>
                                    <td style="padding: 10px; color: #e74c3c; font-weight: bold; text-align: center; border: 1px solid #ddd;">0.210 ì´í•˜</td>
                                    <td style="padding: 10px; color: #000; border: 1px solid #ddd;">ëˆˆÂ·ì½” ìê·¹, ìƒˆì§‘ì¦í›„êµ°</td>
                                </tr>
                                <tr style="border: 1px solid #ddd;">
                                    <td style="padding: 10px; font-weight: bold; color: #000; border: 1px solid #ddd;">ì´VOCs</td>
                                    <td style="padding: 10px; color: #e74c3c; font-weight: bold; text-align: center; border: 1px solid #ddd;">0.500 ì´í•˜</td>
                                    <td style="padding: 10px; color: #000; border: 1px solid #ddd;">í˜„ê¸°ì¦, í”¼ë¡œ, í˜¸í¡ê¸° ìê·¹</td>
                                </tr>
                            </tbody>
                        </table>
                        <div style="background: white; padding: 12px; margin-top: 15px; border-radius: 4px; border: 1px solid #3498db;">
                            <p style="margin: 0; color: #000; font-size: 12px; line-height: 1.6; font-weight: 500;">
                                <strong>âš ï¸ ì¤‘ìš”:</strong> ì‹ ì¶• ê³µë™ì£¼íƒ 3ê°œ í•­ëª©ì€ ë²•ì  ê¶Œê³ ê¸°ì¤€ì…ë‹ˆë‹¤. ì…ì£¼ ì „ ë°˜ë“œì‹œ ì¸¡ì •í•˜ì„¸ìš”.
                            </p>
                        </div>
                    </div>

                    <div style="position: absolute; bottom: 25px; left: 40px; right: 40px; padding-top: 15px; border-top: 1px solid #ddd; font-size: 12px; color: #000; text-align: center; font-weight: 500;">
                        <div>ë”í™ˆì ê²€ | ì „í™”: 070-8019-1456 / 010-9985-0128</div>
                    </div>
                </div>
            `;
        }

        window.createCondensationGuidePage = function() {
            return `
                <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 40px; position: relative;">
                    <h2 style="margin: 0 0 25px 0; font-size: 22px; color: #000; border-bottom: 3px solid #3498db; padding-bottom: 12px;">ğŸ’§ ê²°ë¡œ ì˜ˆë°© ë° ê´€ë¦¬ ê°€ì´ë“œ</h2>

                    <div style="background: #e3f2fd; border-left: 4px solid #3498db; padding: 18px; margin-bottom: 25px; border-radius: 4px;">
                        <p style="margin: 0; color: #000; font-size: 14px; line-height: 1.8; font-weight: 500;">
                            ê²°ë¡œëŠ” ì‹¤ë‚´ì™¸ ì˜¨ë„ì°¨ì™€ ìŠµë„ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ìì—°í˜„ìƒì…ë‹ˆë‹¤. 
                            ì ì ˆí•œ í™˜ê¸°ì™€ ì‹¤ë‚´ ìŠµë„ ê´€ë¦¬ë¡œ ê²°ë¡œ ë°œìƒì„ ìµœì†Œí™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                    </div>

                    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: white;">
                        <div style="background: #e3f2fd; color: #000; border-bottom: 2px solid #3498db; padding: 12px 18px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            1. ê²°ë¡œ ì˜ˆë°© ë°©ë²•
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <div style="background: #e8f5e9; padding: 15px; border-radius: 4px; border: 1px solid #2ecc71;">
                                <div style="font-weight: bold; color: #2ecc71; margin-bottom: 8px; font-size: 14px;">âœ“ í™˜ê¸°í•˜ê¸°</div>
                                <div style="font-size: 13px; color: #000; line-height: 1.8;">
                                    â€¢ í•˜ë£¨ 3íšŒ, 10ë¶„ ì´ìƒ<br>
                                    â€¢ ìš”ë¦¬Â·ìƒ¤ì›Œ í›„ ì¦‰ì‹œ í™˜ê¸°<br>
                                    â€¢ ë§ë°”ëŒ ì¹˜ë„ë¡ ê°œë°©
                                </div>
                            </div>
                            <div style="background: #e3f2fd; padding: 15px; border-radius: 4px; border: 1px solid #3498db;">
                                <div style="font-weight: bold; color: #3498db; margin-bottom: 8px; font-size: 14px;">âœ“ ìŠµë„ ì¡°ì ˆ</div>
                                <div style="font-size: 13px; color: #000; line-height: 1.8;">
                                    â€¢ ì‹¤ë‚´ ìŠµë„ 40~60% ìœ ì§€<br>
                                    â€¢ ê°€ìŠµê¸° ì‚¬ìš© ìì œ<br>
                                    â€¢ ë¹¨ë˜ ì‹¤ë‚´ ê±´ì¡° ê¸ˆì§€
                                </div>
                            </div>
                            <div style="background: #fff3e0; padding: 15px; border-radius: 4px; border: 1px solid #f39c12;">
                                <div style="font-weight: bold; color: #f39c12; margin-bottom: 8px; font-size: 14px;">âœ“ ì‹¤ë‚´ ì˜¨ë„</div>
                                <div style="font-size: 13px; color: #000; line-height: 1.8;">
                                    â€¢ 18~22ë„ ì ì • ìœ ì§€<br>
                                    â€¢ ë‚œë°© ê³¼ë„í•˜ê²Œ ë†’ì´ì§€ ì•Šê¸°<br>
                                    â€¢ ì™¸ì¶œ ì‹œì—ë„ ìµœì†Œ ë‚œë°©
                                </div>
                            </div>
                            <div style="background: #ffebee; padding: 15px; border-radius: 4px; border: 1px solid #e74c3c;">
                                <div style="font-weight: bold; color: #e74c3c; margin-bottom: 8px; font-size: 14px;">âœ“ ê°€êµ¬ ë°°ì¹˜</div>
                                <div style="font-size: 13px; color: #000; line-height: 1.8;">
                                    â€¢ ì™¸ë²½ì—ì„œ 5~10cm ë„ìš°ê¸°<br>
                                    â€¢ í†µí’ ê³µê°„ í™•ë³´<br>
                                    â€¢ ë¶™ë°•ì´ì¥ í™˜ê¸°êµ¬ ì—´ì–´ë‘ê¸°
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; background: white;">
                        <div style="background: #ffebee; color: #000; border-bottom: 2px solid #e74c3c; padding: 12px 18px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            2. ê²°ë¡œ ë°œìƒ ì‹œ ëŒ€ì²˜ ë°©ë²•
                        </div>
                        <ul style="margin: 0; padding-left: 20px; font-size: 13px; color: #000; line-height: 2;">
                            <li><strong>ë¬¼ê¸° ì œê±°:</strong> ì¦‰ì‹œ ë§ˆë¥¸ ê±¸ë ˆë¡œ ë¬¼ê¸°ë¥¼ ë‹¦ì•„ëƒ„</li>
                            <li><strong>í™˜ê¸°:</strong> ë¬¼ê¸° ì œê±° í›„ ì¦‰ì‹œ í™˜ê¸°í•˜ì—¬ ìŠµê¸° ë°°ì¶œ</li>
                            <li><strong>ì œìŠµ:</strong> ì œìŠµê¸° ë˜ëŠ” ì œìŠµì œ ì‚¬ìš©</li>
                            <li><strong>ê³°íŒ¡ì´ ì œê±°:</strong> ë½ìŠ¤ í¬ì„ì•¡(1:10)ìœ¼ë¡œ ì†Œë…</li>
                        </ul>
                    </div>

                    <div style="position: absolute; bottom: 25px; left: 40px; right: 40px; padding-top: 15px; border-top: 1px solid #ddd; font-size: 12px; color: #000; text-align: center; font-weight: 500;">
                        <div>ë”í™ˆì ê²€ | ì „í™”: 070-8019-1456 / 010-9985-0128</div>
                    </div>
                </div>
            `;
        }

        window.createMovingInGuidePage = function() {
            return `
                <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 40px; position: relative;">
                    <h2 style="margin: 0 0 25px 0; font-size: 22px; color: #000; border-bottom: 3px solid #9b59b6; padding-bottom: 12px;">ğŸ¡ ì…ì£¼ ì‹œ ì•Œì•„ë‘ë©´ ìœ ìš©í•œ ì •ë³´</h2>

                    <div style="background: #f3e5f5; border-left: 4px solid #9b59b6; padding: 18px; margin-bottom: 25px; border-radius: 4px;">
                        <p style="margin: 0; color: #000; font-size: 14px; line-height: 1.8; font-weight: 500;">
                            ìƒˆ ì•„íŒŒíŠ¸ ì…ì£¼ë¥¼ ì•ë‘ê³  ê³„ì‹ ê°€ìš”? ì…ì£¼ ì „í›„ ì•Œì•„ë‘ë©´ ë„ì›€ì´ ë˜ëŠ” ì‹¤ìš© ì •ë³´ë¥¼ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.
                        </p>
                    </div>

                    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: white;">
                        <div style="background: #f3e5f5; color: #000; border-bottom: 2px solid #9b59b6; padding: 12px 18px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            1. ì…ì£¼ ì „ í•„ìˆ˜ ì¤€ë¹„ì‚¬í•­
                        </div>
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; width: 30%; background: #f8f9fa; font-weight: bold; color: #000;">ì „ì…ì‹ ê³ </td>
                                <td style="padding: 12px; color: #000;">ì…ì£¼ì¼ë¡œë¶€í„° 14ì¼ ì´ë‚´</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">í™”ì¬ë³´í—˜</td>
                                <td style="padding: 12px; color: #000;">ì˜ë¬´ê°€ì… (ê´€ë¦¬ì‚¬ë¬´ì†Œ ì¼ê´„ ê°€ì… ê°€ëŠ¥)</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">ì¸í„°ë„·/TV</td>
                                <td style="padding: 12px; color: #000;">ì…ì£¼ 2ì£¼ ì „ ì‹ ì²­</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">ê°€ìŠ¤ ê°œí†µ</td>
                                <td style="padding: 12px; color: #000;">ë„ì‹œê°€ìŠ¤ íšŒì‚¬ ì‹ ì²­ (ë°©ë¬¸ ê²€ì‚¬)</td>
                            </tr>
                        </table>
                    </div>

                    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; margin-bottom: 20px; background: white;">
                        <div style="background: #e8f5e9; color: #000; border-bottom: 2px solid #2ecc71; padding: 12px 18px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            2. ê´€ë¦¬ë¹„ ì ˆì•½ ë…¸í•˜ìš°
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 4px; border: 1px solid #ddd;">
                                <div style="font-weight: bold; color: #2ecc71; margin-bottom: 8px; font-size: 14px;">ë‚œë°©ë¹„</div>
                                <ul style="margin: 5px 0 0 0; padding-left: 15px; font-size: 13px; color: #000; line-height: 1.8;">
                                    <li>ì ì •ì˜¨ë„ ìœ ì§€ (20~22ë„)</li>
                                    <li>ì™¸ì¶œ ì‹œ ì €ì˜¨ëª¨ë“œ</li>
                                </ul>
                            </div>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 4px; border: 1px solid #ddd;">
                                <div style="font-weight: bold; color: #3498db; margin-bottom: 8px; font-size: 14px;">ì „ê¸°ì„¸</div>
                                <ul style="margin: 5px 0 0 0; padding-left: 15px; font-size: 13px; color: #000; line-height: 1.8;">
                                    <li>ëŒ€ê¸°ì „ë ¥ ì°¨ë‹¨</li>
                                    <li>LED ì¡°ëª… ì‚¬ìš©</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div style="border: 2px solid #ddd; border-radius: 8px; padding: 20px; background: white;">
                        <div style="background: #e3f2fd; color: #000; border-bottom: 2px solid #3498db; padding: 12px 18px; margin: -20px -20px 18px -20px; border-radius: 6px 6px 0 0; font-size: 16px; font-weight: bold;">
                            3. ë¹„ìƒ ì—°ë½ì²˜
                        </div>
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; width: 35%; background: #f8f9fa; font-weight: bold; color: #000;">ê´€ë¦¬ì‚¬ë¬´ì†Œ</td>
                                <td style="padding: 12px; color: #000;">ì¼ë°˜ ë¬¸ì˜, í•˜ìë³´ìˆ˜</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">ë„ì‹œê°€ìŠ¤ (119)</td>
                                <td style="padding: 12px; color: #000;">ê°€ìŠ¤ ëˆ„ì¶œ ì‹ ê³ </td>
                            </tr>
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">í•œêµ­ì „ë ¥ (123)</td>
                                <td style="padding: 12px; color: #000;">ì •ì „, ì „ê¸° ê³ ì¥</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; background: #f8f9fa; font-weight: bold; color: #000;">ìˆ˜ë„ (120)</td>
                                <td style="padding: 12px; color: #000;">ìˆ˜ë„ ê³ ì¥, ìˆ˜ì§ˆ ë¬¸ì œ</td>
                            </tr>
                        </table>
                    </div>

                    <div style="position: absolute; bottom: 25px; left: 40px; right: 40px; padding-top: 15px; border-top: 1px solid #ddd; font-size: 12px; color: #000; text-align: center; font-weight: 500;">
                        <div>ë”í™ˆì ê²€ | ì „í™”: 070-8019-1456 / 010-9985-0128</div>
                    </div>
                </div>
            `;
        }

        // ==================== ê²¬ì ì„œ í˜ì´ì§€ ìƒì„± ====================
        window.createQuotationPage = function() {
            const today = new Date();
            const formattedDate = `${today.getFullYear()}ë…„ ${today.getMonth() + 1}ì›” ${today.getDate()}ì¼`;
            const apartmentName = projectData.apartmentName || '';
            const dong = projectData.dong || '';
            const ho = projectData.ho || '';
            const recipient = `${apartmentName} ${dong}ë™ ${ho}í˜¸`.trim() || 'ê³ ê°ë‹˜';

            return `
                <div style="width: 794px; min-height: 1123px; background: #ffffff; font-family: 'Malgun Gothic', sans-serif; padding: 35px 40px; position: relative;">
                    
                    <!-- í—¤ë” -->
                    <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 25px; padding-bottom: 20px; border-bottom: 3px solid #1e3a5f;">
                        <div style="font-size: 38px; font-weight: 900; color: #1e3a5f; letter-spacing: 2px;">ë”í™ˆì ê²€ ê²¬ì ì„œ</div>
                    </div>
                    
                    <!-- ìˆ˜ì‹ ì ì •ë³´ -->
                    <div style="background: #f0f4f8; padding: 12px 20px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-size: 14px; font-weight: 700; color: #1e3a5f;">ğŸ“ ${recipient}</div>
                        <div style="font-size: 12px; color: #666; font-weight: 600;">ë°œí–‰ì¼: ${formattedDate}</div>
                    </div>
                    
                    <!-- 2ë‹¨ ë ˆì´ì•„ì›ƒ -->
                    <div style="display: flex; gap: 25px;">
                        <!-- ì¢Œì¸¡ ì»¬ëŸ¼ -->
                        <div style="flex: 1;">
                            <!-- ì…ì£¼ì²­ì†Œ -->
                            <div style="margin-bottom: 18px;">
                                <span style="background: #1e3a5f; color: white; padding: 8px 15px; font-size: 14px; font-weight: 700; border-radius: 5px; display: inline-block; margin-bottom: 10px;">ì…ì£¼ì²­ì†Œ</span>
                                <span style="font-size: 12px; font-weight: 500; color: #666; margin-left: 8px;">ì²­ì†Œì „ë¬¸íŒ€</span>
                                
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 10px 15px; margin: 8px 0;">
                                    <div style="font-size: 13px; font-weight: 700; color: #1e3a5f; margin-bottom: 3px;">20í‰ ë¯¸ë§Œ</div>
                                    <div style="font-size: 16px; font-weight: 800; color: #dc2626; text-align: right;">300,000ì›</div>
                                </div>
                                
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 10px 15px; margin: 8px 0;">
                                    <div style="font-size: 13px; font-weight: 700; color: #1e3a5f; margin-bottom: 3px;">20í‰ ì´ìƒ (ê³µê¸‰ë©´ì  ê¸°ì¤€)</div>
                                    <div style="font-size: 11px; color: #666; margin-bottom: 5px;">í‰ë‹¹ 13,000ì›</div>
                                    <div style="font-size: 16px; font-weight: 800; color: #dc2626; text-align: right;">____í‰ Ã— 13,000ì›</div>
                                </div>
                                
                                <div style="display: flex; align-items: center; gap: 8px; margin: 10px 0 8px 0;">
                                    <div style="width: 8px; height: 8px; background: #1e3a5f; border-radius: 50%;"></div>
                                    <span style="font-size: 13px; font-weight: 700; color: #333;">ì„ íƒ ì˜µì…˜</span>
                                </div>
                                <div style="padding-left: 16px;">
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dashed #e0e0e0;"><span style="font-size: 12px; font-weight: 600; color: #333;">ê°€ì „ì²­ì†Œ (ë‚´/ì™¸ì¸¡)</span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">20,000ì›</span></div>
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dashed #e0e0e0;"><span style="font-size: 12px; font-weight: 600; color: #333;">í° ë¶™ë°•ì´ì¥ (ì•ˆë°© ì™¸)</span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">50,000ì›</span></div>
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dashed #e0e0e0;"><span style="font-size: 12px; font-weight: 600; color: #333;">ì—ì–´ì»¨ì²­ì†Œ (ì™¸ë¶€/í•„í„°)</span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">20,000ì›</span></div>
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dashed #e0e0e0;"><span style="font-size: 12px; font-weight: 600; color: #333;">ìƒˆì§‘ì¦í›„êµ° ë² ì´ì§</span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">150,000ì›</span></div>
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0;"><span style="font-size: 12px; font-weight: 600; color: #333;">ì»¬ë¹„ <span style="font-size: 10px; color: #888;">(ë²½ì§€/ì²œì¥ì§€ íŠ¹ìˆ˜ì²­ì†Œ)</span></span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">200,000ì›</span></div>
                                </div>
                            </div>
                            
                            <!-- ì¤„ëˆˆê³µì‚¬ -->
                            <div style="margin-bottom: 18px;">
                                <span style="background: #1e3a5f; color: white; padding: 8px 15px; font-size: 14px; font-weight: 700; border-radius: 5px; display: inline-block; margin-bottom: 10px;">ì¤„ëˆˆê³µì‚¬</span>
                                <span style="font-size: 12px; font-weight: 500; color: #666; margin-left: 8px;">10ë…„ ê²½ë ¥ ì „ë¬¸íŒ€</span>
                                
                                <div style="display: flex; align-items: center; gap: 8px; margin: 10px 0 8px 0;">
                                    <div style="width: 8px; height: 8px; background: #1e3a5f; border-radius: 50%;"></div>
                                    <span style="font-size: 13px; font-weight: 700; color: #333;">íŒ¨í‚¤ì§€ ì„ íƒ</span>
                                </div>
                                <div style="padding-left: 16px;">
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dashed #e0e0e0;"><span style="font-size: 12px; font-weight: 600; color: #333;">íŒ¨í‚¤ì§€1 <span style="font-size: 10px; color: #888;">í˜„ê´€+ìš•ì‹¤2ê³³ë°”ë‹¥+ì‹¤ë¦¬ì½˜ì˜¤ì—¼ë°©ì§€</span></span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">320,000ì›</span></div>
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dashed #e0e0e0;"><span style="font-size: 12px; font-weight: 600; color: #333;">íŒ¨í‚¤ì§€2 <span style="font-size: 10px; color: #888;">íŒ¨í‚¤ì§€1+ìƒ¤ì›Œë¶€ìŠ¤ë²½3ë©´+ì‹¤ë¦¬ì½˜ì˜¤ì—¼ë°©ì§€</span></span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">430,000ì›</span></div>
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0;"><span style="font-size: 12px; font-weight: 600; color: #333;">íŒ¨í‚¤ì§€3 <span style="font-size: 10px; color: #888;">íŒ¨í‚¤ì§€2+ìš•ì¡°ë²½3ë©´+ì‹¤ë¦¬ì½˜ì˜¤ì—¼ë°©ì§€</span></span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">580,000ì›</span></div>
                                </div>
                            </div>
                            
                            <!-- íƒ„ì„±ì½”íŠ¸ -->
                            <div style="margin-bottom: 18px;">
                                <span style="background: #1e3a5f; color: white; padding: 8px 15px; font-size: 14px; font-weight: 700; border-radius: 5px; display: inline-block; margin-bottom: 10px;">íƒ„ì„±ì½”íŠ¸</span>
                                
                                <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 10px 15px; margin: 8px 0;">
                                    <div style="font-size: 13px; font-weight: 700; color: #1e3a5f; margin-bottom: 3px;">ê¸°ë³¸ íŒ¨í‚¤ì§€</div>
                                    <div style="font-size: 11px; color: #666; margin-bottom: 5px;">ë² ë€ë‹¤ 1ê°œ + ì„¸íƒì‹¤ 1ê°œ</div>
                                    <div style="font-size: 16px; font-weight: 800; color: #dc2626; text-align: right;">500,000ì›</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ìš°ì¸¡ ì»¬ëŸ¼ -->
                        <div style="flex: 1;">
                            <!-- ë‚˜ë…¸ì½”íŒ… -->
                            <div style="margin-bottom: 18px;">
                                <span style="background: #1e3a5f; color: white; padding: 8px 15px; font-size: 14px; font-weight: 700; border-radius: 5px; display: inline-block; margin-bottom: 10px;">ë‚˜ë…¸ì½”íŒ… / ì½”íŒ…</span>
                                
                                <div style="display: flex; align-items: center; gap: 8px; margin: 10px 0 8px 0;">
                                    <div style="width: 8px; height: 8px; background: #1e3a5f; border-radius: 50%;"></div>
                                    <span style="font-size: 13px; font-weight: 700; color: #333;">ì£¼ë°©ìƒíŒ ë‚˜ë…¸ì½”íŒ…</span>
                                    <span style="font-size: 11px; color: #666;">(ì•„ì¼ëœë“œ í¬í•¨)</span>
                                </div>
                                <div style="padding-left: 16px;">
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0;"><span style="font-size: 12px; font-weight: 600; color: #333;">84íƒ€ì… ê¹Œì§€</span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">400,000ì›</span></div>
                                </div>
                                
                                <div style="display: flex; align-items: center; gap: 8px; margin: 10px 0 8px 0;">
                                    <div style="width: 8px; height: 8px; background: #1e3a5f; border-radius: 50%;"></div>
                                    <span style="font-size: 13px; font-weight: 700; color: #333;">ë¯¸ë„ëŸ¼ë°©ì§€ ì‹œê³µ</span>
                                </div>
                                <div style="padding-left: 16px;">
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0;"><span style="font-size: 12px; font-weight: 600; color: #333;">ìš•ì‹¤ 2ê³³</span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">350,000ì›</span></div>
                                </div>
                                
                                <div style="display: flex; align-items: center; gap: 8px; margin: 10px 0 8px 0;">
                                    <div style="width: 8px; height: 8px; background: #1e3a5f; border-radius: 50%;"></div>
                                    <span style="font-size: 13px; font-weight: 700; color: #333;">ê°•ë§ˆë£¨ ì½”íŒ…</span>
                                </div>
                                <div style="padding-left: 16px;">
                                    <div style="display: flex; justify-content: space-between; padding: 5px 0;"><span style="font-size: 12px; font-weight: 600; color: #333;">ê±°ì‹¤</span><span style="font-size: 14px; font-weight: 800; color: #dc2626;">400,000ì›</span></div>
                                </div>
                            </div>
                            
                            <!-- ë¬´ìƒì„œë¹„ìŠ¤ -->
                            <div style="background: #f0fdf4; border: 2px solid #16a34a; border-radius: 8px; padding: 12px 15px; margin-top: 15px;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <span style="font-size: 16px;">ğŸ</span>
                                    <span style="font-size: 13px; font-weight: 800; color: #16a34a;">ë¬´ìƒì„œë¹„ìŠ¤ (ì ê²€ê³ ê° í˜œíƒ)</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 4px 0;">
                                    <span style="font-size: 12px; font-weight: 600; color: #333;">ì‚¬í›„ì ê²€ì„œë¹„ìŠ¤</span>
                                    <div>
                                        <span style="font-size: 11px; color: #999; text-decoration: line-through; margin-right: 8px;">60,000ì›</span>
                                        <span style="background: #dc2626; color: white; padding: 2px 10px; border-radius: 12px; font-size: 10px; font-weight: 700;">ë¬´ìƒ</span>
                                    </div>
                                </div>
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 4px 0;">
                                    <span style="font-size: 12px; font-weight: 600; color: #333;">ì ê²€ ìŠ¤í‹°ì»¤ ì œê±°</span>
                                    <div>
                                        <span style="font-size: 11px; color: #999; text-decoration: line-through; margin-right: 8px;">50,000ì›</span>
                                        <span style="background: #dc2626; color: white; padding: 2px 10px; border-radius: 12px; font-size: 10px; font-weight: 700;">ë¬´ìƒ</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ì•ˆë‚´ì‚¬í•­ -->
                            <div style="background: #f8fafc; border-radius: 6px; padding: 12px 15px; margin-top: 15px;">
                                <div style="font-size: 12px; font-weight: 700; color: #1e3a5f; margin-bottom: 8px;">ğŸ“‹ ì•ˆë‚´ì‚¬í•­</div>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3px 15px; font-size: 11px; color: #333; font-weight: 600;">
                                    <div>â€¢ V.A.T ë³„ë„</div>
                                    <div>â€¢ ê²¬ì  ìœ íš¨ê¸°ê°„ 30ì¼</div>
                                    <div>â€¢ ì¤„ëˆˆê³µì‚¬ 2ë…„ í•˜ìë³´ìˆ˜</div>
                                    <div>â€¢ ê³ ê°ìš”ì²­ì™¸ ì¶”ê°€ìš”ê¸ˆì—†ìŒ</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ìƒë‹´ CTA -->
                    <div style="background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 15px 25px; border-radius: 8px; margin-top: 20px; display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-size: 15px; font-weight: 700;">ìƒë‹´ ë° ê²¬ì ë¬¸ì˜</div>
                        <div>
                            <div style="font-size: 24px; font-weight: 900;">ğŸ“ 010-9985-0128</div>
                            <div style="font-size: 11px; opacity: 0.9; margin-top: 3px;">ì¹´ì¹´ì˜¤í†¡ ì±„ë„ "ë”í™ˆì ê²€"</div>
                        </div>
                    </div>
                    
                    <!-- í‘¸í„° -->
                    <div style="position: absolute; bottom: 20px; left: 40px; right: 40px; display: flex; justify-content: space-between; align-items: center; padding-top: 10px; border-top: 1px solid #e0e0e0; font-size: 10px; color: #666; font-weight: 600;">
                        <span>ë”í™ˆì ê²€ | ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì…ì£¼ ì „ í•˜ìì ê²€ ì„œë¹„ìŠ¤</span>
                        <span>www.thehomeinsp.com</span>
                    </div>
                </div>
            `;
        }

        // ==================== ì‹œê³µì•ˆë‚´ í˜ì´ì§€ ìƒì„± ====================
        window.createServiceGuidePage = function() {
            const CLEANING_IMG = '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';
            const GROUT_IMG = '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';
            const SICKHOUSE_IMG = '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';
            const ELASTIC_IMG = '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';
            const NANO_IMG = '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';
            const FREE_IMG = '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';
            
            return `
                <div style="width: 794px; min-height: 1123px; background: #ffffff; font-family: 'Malgun Gothic', sans-serif; padding: 30px 35px; position: relative;">
                    <div style="text-align: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 3px solid #1e3a5f;">
                        <div style="font-size: 28px; font-weight: 900; color: #1e3a5f; letter-spacing: 2px;">ğŸ  ì‹œê³µì•ˆë‚´</div>
                        <div style="font-size: 12px; color: #666; margin-top: 5px;">ë”í™ˆì ê²€ì´ ì œê³µí•˜ëŠ” ì „ë¬¸ ì‹œê³µ ì„œë¹„ìŠ¤ë¥¼ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤</div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <!-- ì…ì£¼ì²­ì†Œ -->
                        <div style="border: 1px solid #e2e8f0; border-radius: 10px; overflow: hidden; background: #fff;">
                            <div style="padding: 12px 15px; display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);">
                                <div style="width: 40px; height: 40px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px;">ğŸ§¹</div>
                                <div style="color: white; font-size: 15px; font-weight: 700;">ì…ì£¼ì²­ì†Œ</div>
                            </div>
                            <div style="padding: 15px;">
                                <div style="width: 100%; height: 100px; background: #f8fafc; border-radius: 8px; margin-bottom: 12px; overflow: hidden;">
                                    <img src="data:image/jpeg;base64,${CLEANING_IMG}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div style="font-size: 11px; color: #333; line-height: 1.6; margin-bottom: 10px;">ì‹ ì¶• ì•„íŒŒíŠ¸ ì…ì£¼ ì „ ì „ë¬¸ ì²­ì†ŒíŒ€ì´ ì„¸ëŒ€ ì „ì²´ë¥¼ ê¹¨ë—í•˜ê²Œ ì²­ì†Œí•©ë‹ˆë‹¤. ê±´ì„¤ ë¨¼ì§€, ì‹œë©˜íŠ¸ ê°€ë£¨, ì°½í‹€ ì‹¤ë¦¬ì½˜ ë“±ì„ ì™„ë²½íˆ ì œê±°í•©ë‹ˆë‹¤.</div>
                                <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ì „ë¬¸ ì²­ì†ŒíŒ€</span>
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ì„¸ëŒ€ ì „ì²´</span>
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ê±´ì„¤ ë¨¼ì§€ ì œê±°</span>
                                    <span style="background: #fef3c7; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #b45309;">ìì²´ ê²€ìˆ˜</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ìƒˆì§‘ì¦í›„êµ° ì‹œê³µ -->
                        <div style="border: 1px solid #e2e8f0; border-radius: 10px; overflow: hidden; background: #fff;">
                            <div style="padding: 12px 15px; display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #ea580c 0%, #f97316 100%);">
                                <div style="width: 40px; height: 40px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px;">ğŸŒ¿</div>
                                <div style="color: white; font-size: 15px; font-weight: 700;">ìƒˆì§‘ì¦í›„êµ° ì‹œê³µ</div>
                            </div>
                            <div style="padding: 15px;">
                                <div style="width: 100%; height: 100px; background: #f8fafc; border-radius: 8px; margin-bottom: 12px; overflow: hidden;">
                                    <img src="data:image/jpeg;base64,${SICKHOUSE_IMG}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div style="font-size: 11px; color: #333; line-height: 1.6; margin-bottom: 10px;">í¬ë¦„ì•Œë°íˆë“œ, VOCs ë“± ìœ í•´ë¬¼ì§ˆì„ ì œê±°í•˜ì—¬ ì¾Œì í•œ ì‹¤ë‚´ í™˜ê²½ì„ ë§Œë“­ë‹ˆë‹¤. ê±´ì‹/í”„ë¦¬ë¯¸ì—„ ì˜µì…˜ìœ¼ë¡œ ë§ì¶¤ ì‹œê³µì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>
                                <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ìœ í•´ë¬¼ì§ˆ ì œê±°</span>
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ê±´ì‹/í”„ë¦¬ë¯¸ì—„</span>
                                    <span style="background: #fef3c7; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #b45309;">ì•„ì´ ìˆëŠ” ê°€ì • ì¶”ì²œ</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ì¤„ëˆˆê³µì‚¬ -->
                        <div style="border: 1px solid #e2e8f0; border-radius: 10px; overflow: hidden; background: #fff;">
                            <div style="padding: 12px 15px; display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);">
                                <div style="width: 40px; height: 40px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px;">ğŸ”²</div>
                                <div style="color: white; font-size: 15px; font-weight: 700;">ì¤„ëˆˆê³µì‚¬</div>
                            </div>
                            <div style="padding: 15px;">
                                <div style="width: 100%; height: 100px; background: #f8fafc; border-radius: 8px; margin-bottom: 12px; overflow: hidden;">
                                    <img src="data:image/jpeg;base64,${GROUT_IMG}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div style="font-size: 11px; color: #333; line-height: 1.6; margin-bottom: 10px;">ìš•ì‹¤, í˜„ê´€ íƒ€ì¼ ì¤„ëˆˆì„ ì „ë¬¸ ì‹œê³µí•˜ì—¬ ê³°íŒ¡ì´ì™€ ì˜¤ì—¼ì„ ë°©ì§€í•©ë‹ˆë‹¤. ì‹¤ë¦¬ì½˜ ì˜¤ì—¼ë°©ì§€ ì½”íŒ…ê¹Œì§€ í¬í•¨ëœ íŒ¨í‚¤ì§€ êµ¬ì„±ì…ë‹ˆë‹¤.</div>
                                <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">10ë…„ ê²½ë ¥íŒ€</span>
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ê³°íŒ¡ì´ ë°©ì§€</span>
                                    <span style="background: #fef3c7; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #b45309;">2ë…„ í•˜ìë³´ìˆ˜</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- íƒ„ì„±ì½”íŠ¸ -->
                        <div style="border: 1px solid #e2e8f0; border-radius: 10px; overflow: hidden; background: #fff;">
                            <div style="padding: 12px 15px; display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%);">
                                <div style="width: 40px; height: 40px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px;">ğŸ¨</div>
                                <div style="color: white; font-size: 15px; font-weight: 700;">íƒ„ì„±ì½”íŠ¸</div>
                            </div>
                            <div style="padding: 15px;">
                                <div style="width: 100%; height: 100px; background: #f8fafc; border-radius: 8px; margin-bottom: 12px; overflow: hidden;">
                                    <img src="data:image/jpeg;base64,${ELASTIC_IMG}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div style="font-size: 11px; color: #333; line-height: 1.6; margin-bottom: 10px;">ë² ë€ë‹¤, ì„¸íƒì‹¤ ë“± ì™¸ë¶€ ë…¸ì¶œ ê³µê°„ì— íƒ„ì„±ì½”íŠ¸ë¥¼ ì‹œê³µí•˜ì—¬ ê²°ë¡œ, ê³°íŒ¡ì´, ê· ì—´ì„ ì˜ˆë°©í•©ë‹ˆë‹¤.</div>
                                <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ê²°ë¡œ ë°©ì§€</span>
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ê³°íŒ¡ì´ ì˜ˆë°©</span>
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ê· ì—´ ë°©ì§€</span>
                                    <span style="background: #fef3c7; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #b45309;">ë² ë€ë‹¤ í•„ìˆ˜</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ë‚˜ë…¸ì½”íŒ… -->
                        <div style="border: 1px solid #e2e8f0; border-radius: 10px; overflow: hidden; background: #fff;">
                            <div style="padding: 12px 15px; display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #0d9488 0%, #14b8a6 100%);">
                                <div style="width: 40px; height: 40px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px;">ğŸ’</div>
                                <div style="color: white; font-size: 15px; font-weight: 700;">ë‚˜ë…¸ì½”íŒ… / ì½”íŒ…</div>
                            </div>
                            <div style="padding: 15px;">
                                <div style="width: 100%; height: 100px; background: #f8fafc; border-radius: 8px; margin-bottom: 12px; overflow: hidden;">
                                    <img src="data:image/jpeg;base64,${NANO_IMG}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div style="font-size: 11px; color: #333; line-height: 1.6; margin-bottom: 10px;">ì£¼ë°©ìƒíŒ, ìš•ì‹¤ ë°”ë‹¥, ê°•ë§ˆë£¨ ë“±ì— ë‚˜ë…¸ì½”íŒ…ì„ ì ìš©í•˜ì—¬ ì˜¤ì—¼ ë°©ì§€, ë¯¸ë„ëŸ¼ ë°©ì§€ íš¨ê³¼ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</div>
                                <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ìƒíŒ ë‚˜ë…¸ì½”íŒ…</span>
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ë¯¸ë„ëŸ¼ë°©ì§€</span>
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ê°•ë§ˆë£¨ ì½”íŒ…</span>
                                    <span style="background: #fef3c7; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #b45309;">ì˜¤ì—¼ ë°©ì§€</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ë¬´ìƒì„œë¹„ìŠ¤ -->
                        <div style="border: 1px solid #e2e8f0; border-radius: 10px; overflow: hidden; background: #fff;">
                            <div style="padding: 12px 15px; display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #db2777 0%, #ec4899 100%);">
                                <div style="width: 40px; height: 40px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px;">ğŸ</div>
                                <div style="color: white; font-size: 15px; font-weight: 700;">ì ê²€ê³ ê° ë¬´ìƒì„œë¹„ìŠ¤</div>
                            </div>
                            <div style="padding: 15px;">
                                <div style="width: 100%; height: 100px; background: #f8fafc; border-radius: 8px; margin-bottom: 12px; overflow: hidden;">
                                    <img src="data:image/jpeg;base64=${FREE_IMG}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div style="font-size: 11px; color: #333; line-height: 1.6; margin-bottom: 10px;">ë”í™ˆì ê²€ ê³ ê°ë‹˜ê»˜ ì œê³µë˜ëŠ” íŠ¹ë³„ í˜œíƒì…ë‹ˆë‹¤. ì‚¬í›„ì ê²€ì„œë¹„ìŠ¤ì™€ ì ê²€ ìŠ¤í‹°ì»¤ ì œê±°ë¥¼ ë¬´ìƒìœ¼ë¡œ ì œê³µí•©ë‹ˆë‹¤.</div>
                                <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                    <span style="background: #fef3c7; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #b45309;">ì‚¬í›„ì ê²€ ë¬´ìƒ</span>
                                    <span style="background: #fef3c7; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #b45309;">ìŠ¤í‹°ì»¤ ì œê±° ë¬´ìƒ</span>
                                    <span style="background: #f1f5f9; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 600; color: #475569;">ì ê²€ê³ ê° í˜œíƒ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: #f0f4f8; border-radius: 8px; padding: 15px 20px; margin-top: 20px;">
                        <div style="font-size: 13px; font-weight: 700; color: #1e3a5f; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">ğŸ“‹ ì‹œê³µ ì§„í–‰ ì•ˆë‚´</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px 20px;">
                            <div style="display: flex; align-items: flex-start; gap: 8px; font-size: 10px; color: #333;"><span style="background: #1e3a5f; color: white; width: 16px; height: 16px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 9px; font-weight: 700; flex-shrink: 0;">1</span><span>ê²¬ì ì„œ í™•ì¸ í›„ ì›í•˜ì‹œëŠ” í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”</span></div>
                            <div style="display: flex; align-items: flex-start; gap: 8px; font-size: 10px; color: #333;"><span style="background: #1e3a5f; color: white; width: 16px; height: 16px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 9px; font-weight: 700; flex-shrink: 0;">2</span><span>ì „í™” ë˜ëŠ” ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì˜ˆì•½ ë¬¸ì˜í•´ì£¼ì„¸ìš”</span></div>
                            <div style="display: flex; align-items: flex-start; gap: 8px; font-size: 10px; color: #333;"><span style="background: #1e3a5f; color: white; width: 16px; height: 16px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 9px; font-weight: 700; flex-shrink: 0;">3</span><span>ì…ì£¼ ì¼ì •ì— ë§ì¶° ì‹œê³µì¼ì„ ì¡°ìœ¨í•©ë‹ˆë‹¤</span></div>
                            <div style="display: flex; align-items: flex-start; gap: 8px; font-size: 10px; color: #333;"><span style="background: #1e3a5f; color: white; width: 16px; height: 16px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 9px; font-weight: 700; flex-shrink: 0;">4</span><span>ì‹œê³µ ì™„ë£Œ í›„ ê³ ê° ê²€ìˆ˜ ë° AS ì ‘ìˆ˜ ì•ˆë‚´</span></div>
                            <div style="display: flex; align-items: flex-start; gap: 8px; font-size: 10px; color: #333;"><span style="background: #1e3a5f; color: white; width: 16px; height: 16px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 9px; font-weight: 700; flex-shrink: 0;">5</span><span>ì¤„ëˆˆê³µì‚¬ëŠ” 2ë…„ê°„ í•˜ìë³´ìˆ˜ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤</span></div>
                            <div style="display: flex; align-items: flex-start; gap: 8px; font-size: 10px; color: #333;"><span style="background: #1e3a5f; color: white; width: 16px; height: 16px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 9px; font-weight: 700; flex-shrink: 0;">6</span><span>ê³ ê° ìš”ì²­ ì™¸ ì¶”ê°€ ìš”ê¸ˆì€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</span></div>
                        </div>
                    </div>
                    
                    <div style="position: absolute; bottom: 15px; left: 35px; right: 35px; display: flex; justify-content: space-between; align-items: center; padding-top: 8px; border-top: 1px solid #e0e0e0; font-size: 9px; color: #666; font-weight: 600;">
                        <span>ë”í™ˆì ê²€ | ğŸ“ 010-9985-0128 | ì¹´ì¹´ì˜¤í†¡ "ë”í™ˆì ê²€"</span>
                        <span>www.thehomeinsp.com</span>
                    </div>
                </div>
            `;
        }


        window.createAirQualityDetailPage = function() {
            const airQualityData = projectData.airQuality.filter(room => 
                room.radon || room.formaldehyde || room.vocs
            );

            // ê¸°ì¤€ì¹˜
            const standards = {
                radon: 148,
                formaldehyde: 0.210,
                vocs: 0.500
            };

            // í‘œ ìƒì„±
            let tableRows = '';
            airQualityData.forEach((room) => {
                const radonValue = parseFloat(room.radon) || 0;
                const formaldehydeValue = parseFloat(room.formaldehyde) || 0;
                const vocsValue = parseFloat(room.vocs) || 0;

                const radonStatus = radonValue > 0 ? (radonValue <= standards.radon ? 'ì í•©' : 'ë¶€ì í•©') : '-';
                const formaldehydeStatus = formaldehydeValue > 0 ? (formaldehydeValue <= standards.formaldehyde ? 'ì í•©' : 'ë¶€ì í•©') : '-';
                const vocsStatus = vocsValue > 0 ? (vocsValue <= standards.vocs ? 'ì í•©' : 'ë¶€ì í•©') : '-';

                tableRows += `
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 10px; text-align: center; font-weight: bold; background: #f8f9fa; color: #000000;">${room.name}</td>
                        <td style="padding: 10px; text-align: center; color: #000000;">${room.radon || '-'}</td>
                        <td style="padding: 10px; text-align: center; color: ${radonValue > standards.radon ? '#e74c3c' : '#10b981'}; font-weight: bold;">${radonStatus}</td>
                        <td style="padding: 10px; text-align: center; color: #000000;">${room.formaldehyde || '-'}</td>
                        <td style="padding: 10px; text-align: center; color: ${formaldehydeValue > standards.formaldehyde ? '#e74c3c' : '#10b981'}; font-weight: bold;">${formaldehydeStatus}</td>
                        <td style="padding: 10px; text-align: center; color: #000000;">${room.vocs || '-'}</td>
                        <td style="padding: 10px; text-align: center; color: ${vocsValue > standards.vocs ? '#e74c3c' : '#10b981'}; font-weight: bold;">${vocsStatus}</td>
                    </tr>
                `;
            });

            return `
                <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 30px;">
                    <div style="background: linear-gradient(135deg, #16a085 0%, #1abc9c 100%); color: white; padding: 20px; margin-bottom: 25px; border-radius: 8px;">
                        <h1 style="margin: 0 0 8px 0; font-size: 26px;">ì‹¤ë‚´ ê³µê¸°ì§ˆ ì¸¡ì • ê²°ê³¼</h1>
                        <p style="margin: 0; font-size: 14px; opacity: 0.9;">${projectData.apartmentName} ${projectData.dong}ë™ ${projectData.ho}í˜¸ | ${projectData.inspectionDate || ''}</p>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <h3 style="margin: 0 0 15px 0; font-size: 18px; color: #000000; border-bottom: 2px solid #16a085; padding-bottom: 8px;">ğŸ“‹ ì¸¡ì • ë°ì´í„°</h3>
                        <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd; font-size: 13px;">
                            <thead>
                                <tr style="background: #f8f9fa; border-bottom: 2px solid #ddd;">
                                    <th style="padding: 12px; border: 1px solid #ddd; color: #000000;">ê³µê°„</th>
                                    <th style="padding: 12px; border: 1px solid #ddd; color: #000000;">ë¼ëˆ<br>(Bq/mÂ³)</th>
                                    <th style="padding: 12px; border: 1px solid #ddd; color: #000000;">íŒì •</th>
                                    <th style="padding: 12px; border: 1px solid #ddd; color: #000000;">í¬ë¦„ì•Œë°íˆë“œ<br>(mg/mÂ³)</th>
                                    <th style="padding: 12px; border: 1px solid #ddd; color: #000000;">íŒì •</th>
                                    <th style="padding: 12px; border: 1px solid #ddd; color: #000000;">ì´VOCs<br>(mg/mÂ³)</th>
                                    <th style="padding: 12px; border: 1px solid #ddd; color: #000000;">íŒì •</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${tableRows}
                            </tbody>
                        </table>
                    </div>

                    <div style="background: #e8f5e9; border: 1px solid #4caf50; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #2e7d32; font-size: 16px;">âœ“ ê¶Œê³ ê¸°ì¤€ (ì‹¤ë‚´ê³µê¸°ì§ˆ ê³µì •ì‹œí—˜ê¸°ì¤€)</h4>
                        <div style="font-size: 14px; color: #1b5e20; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                            <div>â€¢ ë¼ëˆ(Rn): <strong>148 Bq/mÂ³ ì´í•˜</strong></div>
                            <div>â€¢ í¬ë¦„ì•Œë°íˆë“œ(HCHO): <strong>0.210 mg/mÂ³ ì´í•˜</strong></div>
                            <div>â€¢ ì´íœ˜ë°œì„±ìœ ê¸°í™”í•©ë¬¼(TVOCs): <strong>0.500 mg/mÂ³ ì´í•˜</strong></div>
                        </div>
                    </div>

                    <div style="background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                        <div style="font-size: 12px; color: #856404; line-height: 1.6;">
                            <strong>â€» ì°¸ê³ ì‚¬í•­</strong><br>
                            - ì¸¡ì • ê²°ê³¼ëŠ” ì¸¡ì • ë‹¹ì‹œì˜ í™˜ê²½ ì¡°ê±´ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                            - ë¶€ì í•© íŒì • ì‹œ í™˜ê¸° ë“±ì˜ ì¡°ì¹˜ í›„ ì¬ì¸¡ì •ì„ ê¶Œì¥í•©ë‹ˆë‹¤.<br>
                            - ë¼ëˆ ë†ë„ëŠ” ê³„ì ˆ, ì‹œê°„ëŒ€ì— ë”°ë¼ ë³€ë™ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </div>
                    </div>

                    <div style="position: absolute; bottom: 20px; left: 30px; right: 30px; padding-top: 15px; border-top: 1px solid #ddd; font-size: 11px; color: #000000; text-align: center;">
                        <div>ë”í™ˆì ê²€ | ì „í™”: 070-8019-1456 / 010-9985-0128 | ì‚¬ì „ì ê²€ ì „ë¬¸ì—…ì²´</div>
                    </div>
                </div>
            `;
        }

        // ==================== IndexedDB ì„¤ì • ====================
        let db;
        const DB_NAME = 'TheHomeInspectionDB';
        const DB_VERSION = 1;
        const STORE_NAME = 'projects';

        // IndexedDB ì´ˆê¸°í™”
        function initDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);
                
                request.onerror = () => reject(request.error);
                request.onsuccess = () => {
                    db = request.result;
                    resolve(db);
                };
                
                request.onupgradeneeded = (event) => {
                    const db = event.target.result;
                    if (!db.objectStoreNames.contains(STORE_NAME)) {
                        const objectStore = db.createObjectStore(STORE_NAME, { keyPath: 'id' });
                        objectStore.createIndex('savedAt', 'savedAt', { unique: false });
                        objectStore.createIndex('apartmentName', 'apartmentName', { unique: false });
                    }
                };
            });
        }

        // IndexedDBì— ë°ì´í„° ì €ì¥
        async function saveToIndexedDB(key, data) {
            try {
                if (!db) await initDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction([STORE_NAME], 'readwrite');
                    const objectStore = transaction.objectStore(STORE_NAME);
                    
                    // âœ… ìˆ˜ì •: dataë¥¼ ê·¸ëŒ€ë¡œ ì €ì¥í•˜ë˜, idë¥¼ keyë¡œ ì„¤ì •
                    const finalData = { 
                        id: key,  // IndexedDBì˜ í‚¤
                        data: data  // ì‹¤ì œ ë°ì´í„° (í”„ë¡œì íŠ¸ ë°°ì—´ ë˜ëŠ” ë‹¨ì¼ í”„ë¡œì íŠ¸)
                    };
                    
                    const request = objectStore.put(finalData);
                    
                    request.onsuccess = () => {
                        console.log('âœ… IndexedDB ì €ì¥ ì„±ê³µ:', key);
                        resolve();
                    };
                    request.onerror = () => reject(request.error);
                });
            } catch (e) {
                console.error('IndexedDB ì €ì¥ ì˜¤ë¥˜:', e);
                throw e;
            }
        }

        // IndexedDBì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadFromIndexedDB(key) {
            try {
                if (!db) await initDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction([STORE_NAME], 'readonly');
                    const objectStore = transaction.objectStore(STORE_NAME);
                    const request = objectStore.get(key);
                    
                    request.onsuccess = () => {
                        const result = request.result;
                        if (result && result.data) {
                            // âœ… ìˆ˜ì •: data í•„ë“œì—ì„œ ì‹¤ì œ ë°ì´í„° ë°˜í™˜
                            console.log('âœ… IndexedDB ë¶ˆëŸ¬ì˜¤ê¸° ì„±ê³µ:', key);
                            resolve(result.data);
                        } else {
                            console.log('â„¹ï¸ IndexedDBì— ë°ì´í„° ì—†ìŒ:', key);
                            resolve(null);
                        }
                    };
                    request.onerror = () => reject(request.error);
                });
            } catch (e) {
                console.error('IndexedDB ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', e);
                return null;
            }
        }

        // IndexedDBì—ì„œ ëª¨ë“  í”„ë¡œì íŠ¸ ê°€ì ¸ì˜¤ê¸°
        async function getAllFromIndexedDB() {
            try {
                if (!db) await initDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction([STORE_NAME], 'readonly');
                    const objectStore = transaction.objectStore(STORE_NAME);
                    const request = objectStore.getAll();
                    
                    request.onsuccess = () => resolve(request.result);
                    request.onerror = () => reject(request.error);
                });
            } catch (e) {
                console.error('IndexedDB ëª©ë¡ ì¡°íšŒ ì˜¤ë¥˜:', e);
                return [];
            }
        }

        // IndexedDBì—ì„œ ë°ì´í„° ì‚­ì œ
        async function deleteFromIndexedDB(key) {
            try {
                if (!db) await initDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = db.transaction([STORE_NAME], 'readwrite');
                    const objectStore = transaction.objectStore(STORE_NAME);
                    const request = objectStore.delete(key);
                    
                    request.onsuccess = () => resolve();
                    request.onerror = () => reject(request.error);
                });
            } catch (e) {
                console.error('IndexedDB ì‚­ì œ ì˜¤ë¥˜:', e);
                throw e;
            }
        }

        // ==================== ìë™ ì €ì¥ í•¨ìˆ˜ ====================
        // autoSaveTimeout ì œê±°ë¨ - saveTimerë¡œ í†µí•©
        
        // ë™/í˜¸ìˆ˜ ì…ë ¥ ì‹œ "ë™", "í˜¸" ìë™ ì œê±°
        function cleanDongHo(input, type) {
            let value = input.value;
            
            // "ë™" ë˜ëŠ” "í˜¸" ì œê±°
            if (type === 'ë™') {
                value = value.replace(/ë™/g, '').trim();
            } else if (type === 'í˜¸') {
                value = value.replace(/í˜¸/g, '').trim();
            }
            
            // ê°’ì´ ë³€ê²½ë˜ì—ˆìœ¼ë©´ ì—…ë°ì´íŠ¸
            if (input.value !== value) {
                const cursorPos = input.selectionStart - (input.value.length - value.length);
                input.value = value;
                input.setSelectionRange(cursorPos, cursorPos);
            }
        }
        
        function autoSaveProjectData() {
            // projectData ì—…ë°ì´íŠ¸
            projectData.apartmentName = document.getElementById('apartmentName').value;
            projectData.dong = document.getElementById('dong').value;
            projectData.ho = document.getElementById('ho').value;
            projectData.inspectionDate = document.getElementById('inspectionDate').value;
            projectData.customerName = document.getElementById('customerName').value;
            projectData.customerPhone = document.getElementById('customerPhone').value;
            
            // ì €ì¥ (ì´ë¯¸ debounce ì ìš©)
            saveWithDebounce(500); // 0.5ì´ˆ ì§€ì—°
            updateProgress();
        }

        // ==================== ë°ì´í„° ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° (êµ¬ë²„ì „ - ì‚¬ìš© ì•ˆ í•¨) ====================
        // async function saveToLocalStorage() {
        //     try {
        //         await saveToIndexedDB('thehomein_current', projectData);
        //     } catch (e) {
        //         console.error('ì €ì¥ ì˜¤ë¥˜:', e);
        //         alert('ì €ì¥ ì‹¤íŒ¨: ' + e.message);
        //     }
        // }

        async function loadFromLocalStorage() {
            try {
                const saved = await loadFromIndexedDB('thehomein_current');
                if (saved) {
                    // Proxyë¥¼ í†µí•´ í˜„ì¬ í”„ë¡œì íŠ¸ì— ë°ì´í„° ë¡œë“œ
                    const project = getCurrentProject();
                    Object.assign(project, saved);
                    
                    document.getElementById('apartmentName').value = projectData.apartmentName || '';
                    document.getElementById('dong').value = projectData.dong || '';
                    document.getElementById('ho').value = projectData.ho || '';
                    document.getElementById('inspectionDate').value = projectData.inspectionDate || '';
                    document.getElementById('customerName').value = projectData.customerName || '';
                    document.getElementById('customerPhone').value = projectData.customerPhone || '';
                    
                    displayFloorplan();
                    renderDefects();
                    renderEquipment();
                    renderAirQuality();
                    
                    if (projectData.defects.length > 0) {
                        defectIdCounter = Math.max(...projectData.defects.map(d => d.id)) + 1;
                    }
                    if (projectData.equipment && projectData.equipment.length > 0) {
                        equipmentIdCounter = Math.max(...projectData.equipment.map(e => e.id)) + 1;
                    }
                    if (projectData.airQuality.length > 0) {
                        airQualityIdCounter = Math.max(...projectData.airQuality.map(a => a.id)) + 1;
                    }
                }
            } catch (e) {
                console.error('ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', e);
            }
        }

        window.saveCurrentData = async function() {
            const timestamp = new Date().toISOString();
            const key = `thehomein_${timestamp}`;
            
            try {
                await saveToIndexedDB(key, {
                    ...projectData,
                    savedAt: timestamp
                });
                await renderSavedList();
                showToast('ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
            } catch (e) {
                alert('ì €ì¥ ì‹¤íŒ¨: ' + e.message);
            }
        }

        async function renderSavedList() {
            const container = document.getElementById('savedList');
            
            try {
                const saved = await getAllFromIndexedDB();
                const filtered = saved.filter(item => item.id !== 'thehomein_current');
                
                if (filtered.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-secondary); text-align: center;">ì €ì¥ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</p>';
                    return;
                }
                
                // ìµœì‹ ìˆœ ì •ë ¬
                filtered.sort((a, b) => new Date(b.savedAt) - new Date(a.savedAt));
                
                container.innerHTML = filtered.map(item => `
                    <div class="saved-item">
                        <div class="saved-info">
                            <h3>${item.apartmentName || 'ì œëª© ì—†ìŒ'} ${item.dong} ${item.ho}</h3>
                            <p>${new Date(item.savedAt).toLocaleString('ko-KR')}</p>
                        </div>
                        <div class="saved-actions">
                            <button class="icon-btn load" onclick="loadSavedData('${item.id}')">ğŸ“‚</button>
                            <button class="icon-btn delete" onclick="deleteSavedData('${item.id}')">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                `).join('');
            } catch (e) {
                console.error('ëª©ë¡ ë Œë”ë§ ì˜¤ë¥˜:', e);
                container.innerHTML = '<p style="color: red; text-align: center;">ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</p>';
            }
        }

        window.loadSavedData = async function(key) {
            if (confirm('í˜„ì¬ ì‘ì—… ì¤‘ì¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¡œ ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                try {
                    const data = await loadFromIndexedDB(key);
                    if (!data) {
                        alert('ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                        return;
                    }
                    
                    // Proxyë¥¼ í†µí•´ í˜„ì¬ í”„ë¡œì íŠ¸ì— ë°ì´í„° ë¡œë“œ
                    const project = getCurrentProject();
                    Object.assign(project, data);
                    
                    // equipment ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì´ˆê¸°í™”
                    if (!project.equipment) {
                        project.equipment = [];
                    }
                    
                    document.getElementById('apartmentName').value = projectData.apartmentName || '';
                    document.getElementById('dong').value = projectData.dong || '';
                    document.getElementById('ho').value = projectData.ho || '';
                    document.getElementById('inspectionDate').value = projectData.inspectionDate || '';
                    document.getElementById('customerName').value = projectData.customerName || '';
                    document.getElementById('customerPhone').value = projectData.customerPhone || '';
                    
                    displayFloorplan();
                    renderDefects();
                    renderEquipment();
                    renderAirQuality();
                    await saveProjectsToLocalStorage();
                    updateProgress();
                    
                    showToast('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤');
                    switchTab('project');
                } catch (e) {
                    alert('ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: ' + e.message);
                }
            }
        }

        window.deleteSavedData = async function(key) {
            if (confirm('ì´ í”„ë¡œì íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                try {
                    await deleteFromIndexedDB(key);
                    await renderSavedList();
                    showToast('í”„ë¡œì íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
                } catch (e) {
                    alert('ì‚­ì œ ì‹¤íŒ¨: ' + e.message);
                }
            }
        }

        window.clearAllData = async function() {
            if (confirm('ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                if (confirm('ë‹¤ì‹œ í•œë²ˆ í™•ì¸í•©ë‹ˆë‹¤. ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.')) {
                    try {
                        const allData = await getAllFromIndexedDB();
                        
                        for (const item of allData) {
                            await deleteFromIndexedDB(item.id);
                        }
                        
                        // í˜„ì¬ í”„ë¡œì íŠ¸ ì´ˆê¸°í™”
                        const project = getCurrentProject();
                        project.apartmentName = '';
                        project.dong = '';
                        project.ho = '';
                        project.inspectionDate = '';
                        project.customerName = '';
                        project.customerPhone = '';
                        project.floorplan = null;
                        project.defects = [];
                        project.equipment = [];
                        project.airQuality = [];
                        
                        defectIdCounter = 1;
                        equipmentIdCounter = 1;
                        airQualityIdCounter = 1;
                        
                        document.getElementById('apartmentName').value = '';
                        document.getElementById('dong').value = '';
                        document.getElementById('ho').value = '';
                        document.getElementById('inspectionDate').valueAsDate = new Date();
                        document.getElementById('customerName').value = '';
                        document.getElementById('customerPhone').value = '';
                        
                        displayFloorplan();
                        renderDefects();
                        renderEquipment();
                        renderAirQuality();
                        await renderSavedList();
                        updateProgress();
                        
                        showToast('ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
                    } catch (e) {
                        alert('ì‚­ì œ ì‹¤íŒ¨: ' + e.message);
                    }
                }
            }
        }

        // ==================== ê³„ì•½ì„œ ê´€ë¦¬ ê¸°ëŠ¥ ====================

        // ì „ì—­ ë³€ìˆ˜
        let contracts = [];
        let currentEditingContract = null;
        let signaturePads = {};

        // ê³„ì•½ì„œ ë°ì´í„° ë¡œë“œ
        async function loadContracts() {
            try {
                const db = await initContractDB();
                const tx = db.transaction('contracts', 'readonly');
                const store = tx.objectStore('contracts');
                const request = store.getAll();
                
                request.onsuccess = () => {
                    contracts = request.result || [];
                    displayContractList();
                };
            } catch (error) {
                console.error('ê³„ì•½ì„œ ë¡œë“œ ì‹¤íŒ¨:', error);
                contracts = [];
                displayContractList();
            }
        }

        // IndexedDBì— contracts ì €ì¥ì†Œ ì¶”ê°€
        async function initContractDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open('TheHomeInspectionDB', 3); // ë²„ì „ ì—…ê·¸ë ˆì´ë“œ
                
                request.onerror = () => reject(request.error);
                request.onsuccess = () => resolve(request.result);
                
                request.onupgradeneeded = (event) => {
                    const db = event.target.result;
                    
                    // contracts ì €ì¥ì†Œê°€ ì—†ìœ¼ë©´ ìƒì„±
                    if (!db.objectStoreNames.contains('contracts')) {
                        const contractStore = db.createObjectStore('contracts', { 
                            keyPath: 'id', 
                            autoIncrement: true 
                        });
                        contractStore.createIndex('name', 'name', { unique: false });
                        contractStore.createIndex('createdAt', 'createdAt', { unique: false });
                    }
                };
            });
        }

        // ê³„ì•½ì„œ ëª©ë¡ í‘œì‹œ
        function displayContractList() {
            const container = document.getElementById('contractListContainer');
            
            if (!container) return;
            
            if (contracts.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: var(--text-secondary);">
                        <div style="font-size: 48px; margin-bottom: 20px;">ğŸ“„</div>
                        <p style="font-size: 18px;">ì‘ì„±ëœ ê³„ì•½ì„œê°€ ì—†ìŠµë‹ˆë‹¤</p>
                        <p style="font-size: 14px; margin-top: 10px;">
                            "â• ìƒˆ ê³„ì•½ì„œ ì‘ì„±" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì²« ê³„ì•½ì„œë¥¼ ì‘ì„±í•˜ì„¸ìš”
                        </p>
                    </div>
                `;
                return;
            }
            
            const sortedContracts = [...contracts].sort((a, b) => 
                new Date(b.createdAt) - new Date(a.createdAt)
            );
            
            container.innerHTML = sortedContracts.map(contract => `
                <div class="card" style="margin-bottom: 15px;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                        <div style="flex: 1;">
                            <h3 style="color: var(--primary); margin-bottom: 8px; font-size: 20px;">
                                ${contract.name}
                            </h3>
                            <p style="color: var(--text-secondary); font-size: 14px; margin: 5px 0;">
                                ğŸ“… ê³„ì•½ì¼: ${contract.startDate} ~ ${contract.endDate}
                            </p>
                            <p style="color: var(--text-secondary); font-size: 14px; margin: 5px 0;">
                                ğŸ’° ë‹¨ê°€: ${Number(contract.price).toLocaleString()}ì›/ê±´
                            </p>
                            <p style="color: var(--text-secondary); font-size: 12px; margin-top: 10px;">
                                ì‘ì„±ì¼: ${new Date(contract.createdAt).toLocaleDateString()}
                            </p>
                        </div>
                        <div style="display: flex; gap: 8px; flex-direction: column;">
                            <button class="btn btn-primary" onclick="viewContract(${contract.id})" 
                                style="font-size: 14px; padding: 8px 15px;">
                                ğŸ‘ï¸ ë³´ê¸°
                            </button>
                            <button class="btn" onclick="downloadContractPDF(${contract.id})" 
                                style="font-size: 14px; padding: 8px 15px;">
                                ğŸ“¥ PDF
                            </button>
                            <button class="btn" onclick="deleteContract(${contract.id})" 
                                style="font-size: 14px; padding: 8px 15px; background: var(--danger); color: white;">
                                ğŸ—‘ï¸ ì‚­ì œ
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ê³„ì•½ì„œ ê²€ìƒ‰
        function searchContracts() {
            const searchTerm = document.getElementById('contractSearch').value.toLowerCase();
            const filtered = contracts.filter(c => 
                c.name.toLowerCase().includes(searchTerm)
            );
            
            const container = document.getElementById('contractListContainer');
            
            if (filtered.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                        <p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filtered.map(contract => `
                <div class="card" style="margin-bottom: 15px;">
                    <h3 style="color: var(--primary);">${contract.name}</h3>
                    <p style="color: var(--text-secondary); font-size: 14px;">
                        ê³„ì•½ê¸°ê°„: ${contract.startDate} ~ ${contract.endDate}
                    </p>
                    <div style="margin-top: 15px; display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="viewContract(${contract.id})">ë³´ê¸°</button>
                        <button class="btn" onclick="downloadContractPDF(${contract.id})">PDF</button>
                        <button class="btn" onclick="deleteContract(${contract.id})" 
                            style="background: var(--danger); color: white;">ì‚­ì œ</button>
                    </div>
                </div>
            `).join('');
        }

        // ê³„ì•½ì„œ ì‘ì„± í¼ìœ¼ë¡œ ìŠ¤í¬ë¡¤
        window.showContractForm = function() {
            const contractForm = document.getElementById('contractForm');
            if (contractForm) {
                contractForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            
            // ì„œëª… íŒ¨ë“œ ì´ˆê¸°í™”
            setTimeout(() => {
                if (typeof initializeSignaturePads === 'function') {
                    initializeSignaturePads();
                }
            }, 300);
            
            // ê¸°ë³¸ ë‚ ì§œ ì„¤ì •
            const today = new Date().toISOString().split('T')[0];
            const nextYear = new Date();
            nextYear.setFullYear(nextYear.getFullYear() + 1);
            
            const startDateEl = document.getElementById('contractStartDate');
            const endDateEl = document.getElementById('contractEndDate');
            if (startDateEl && !startDateEl.value) startDateEl.value = today;
            if (endDateEl && !endDateEl.value) endDateEl.value = nextYear.toISOString().split('T')[0];
        }

        // ê³„ì•½ì„œ ëª©ë¡ í‘œì‹œ
        window.showContractList = function() {
            // ë” ì´ìƒ ëª©ë¡ ê¸°ëŠ¥ ì—†ìŒ - ì•„ë¬´ ë™ì‘ ì•ˆ í•¨
            console.log('ê³„ì•½ì„œ ëª©ë¡ ê¸°ëŠ¥ì´ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // ì„œëª… íŒ¨ë“œ ì´ˆê¸°í™”
        function initializeSignaturePads() {
            setTimeout(() => {
                ['CEO', 'Freelancer'].forEach(type => {
                    const canvas = document.getElementById(`signature${type}`);
                    if (!canvas) return;
                    
                    const ctx = canvas.getContext('2d', { willReadFrequently: true });
                    let isDrawing = false;
                    let lastX = 0;
                    let lastY = 0;
                    
                    // ìº”ë²„ìŠ¤ í¬ê¸° ì„¤ì •
                    const rect = canvas.getBoundingClientRect();
                    canvas.width = rect.width * 2;
                    canvas.height = rect.height * 2;
                    ctx.scale(2, 2);
                    
                    // ì„  ìŠ¤íƒ€ì¼
                    ctx.strokeStyle = '#000';
                    ctx.lineWidth = 2;
                    ctx.lineCap = 'round';
                    ctx.lineJoin = 'round';
                    
                    function startDrawing(e) {
                        isDrawing = true;
                        const pos = getPosition(e);
                        [lastX, lastY] = [pos.x, pos.y];
                    }
                    
                    function draw(e) {
                        if (!isDrawing) return;
                        e.preventDefault();
                        
                        const pos = getPosition(e);
                        ctx.beginPath();
                        ctx.moveTo(lastX, lastY);
                        ctx.lineTo(pos.x, pos.y);
                        ctx.stroke();
                        [lastX, lastY] = [pos.x, pos.y];
                    }
                    
                    function stopDrawing() {
                        isDrawing = false;
                    }
                    
                    function getPosition(e) {
                        const rect = canvas.getBoundingClientRect();
                        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                        return {
                            x: clientX - rect.left,
                            y: clientY - rect.top
                        };
                    }
                    
                    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                    canvas.addEventListener('mousedown', startDrawing);
                    canvas.addEventListener('mousemove', draw);
                    canvas.addEventListener('mouseup', stopDrawing);
                    canvas.addEventListener('mouseout', stopDrawing);
                    
                    canvas.addEventListener('touchstart', startDrawing);
                    canvas.addEventListener('touchmove', draw);
                    canvas.addEventListener('touchend', stopDrawing);
                    
                    signaturePads[type] = { canvas, ctx };
                });
            }, 100);
        }

        // ì„œëª… ì§€ìš°ê¸°
        window.clearSignature = function(type) {
            const pad = signaturePads[type];
            if (pad) {
                pad.ctx.clearRect(0, 0, pad.canvas.width, pad.canvas.height);
            }
        }

        // ìº”ë²„ìŠ¤ê°€ ë¹„ì–´ìˆëŠ”ì§€ í™•ì¸
        function isCanvasBlank(canvas) {
            const context = canvas.getContext('2d', { willReadFrequently: true });
            const pixelBuffer = new Uint32Array(
                context.getImageData(0, 0, canvas.width, canvas.height).data.buffer
            );
            return !pixelBuffer.some(color => color !== 0);
        }

        // ê³„ì•½ì„œ ë¯¸ë¦¬ë³´ê¸°
        window.previewContract = function() {
            // í•„ìˆ˜ í•­ëª© ê²€ì¦
            const name = document.getElementById('contractName').value;
            const address = document.getElementById('contractAddress').value;
            const jumin1 = document.getElementById('contractJumin1').value;
            const jumin2 = document.getElementById('contractJumin2').value;
            const phone = document.getElementById('contractPhone').value;
            const email = document.getElementById('contractEmail').value;
            const startDate = document.getElementById('contractStartDate').value;
            const endDate = document.getElementById('contractEndDate').value;
            
            if (!name || !address || !jumin1 || !jumin2 || !phone || !email || 
                !startDate || !endDate) {
                alert('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            // ì„œëª… í™•ì¸
            const ceoSigned = signaturePads['CEO'] && !isCanvasBlank(signaturePads['CEO'].canvas);
            const freelancerSigned = signaturePads['Freelancer'] && !isCanvasBlank(signaturePads['Freelancer'].canvas);
            
            if (!ceoSigned && !freelancerSigned) {
                alert('ìµœì†Œ í•œ ëª…ì€ ì„œëª…ì´ í•„ìš”í•©ë‹ˆë‹¤');
                return;
            }
            
            // ë¯¸ë¦¬ë³´ê¸° ìƒì„±
            const business = document.getElementById('contractBusiness').value;
            const notes = document.getElementById('contractNotes').value;
            
            // âœ… priceì™€ payDay ì •ì˜ ì¶”ê°€
            const price = 'ì¼ë‹¹ 1ë§Œ~50ë§Œì› (ì—…ë¬´ë³„ ìƒì´)';
            const payDay = 'ì—…ë¬´ ì™„ë£Œ í›„ 1ê°œì›” ì´ë‚´';
            
            // ì„œëª… ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°
            const signatureCEO = ceoSigned ? signaturePads['CEO'].canvas.toDataURL() : null;
            const signatureFreelancer = freelancerSigned ? signaturePads['Freelancer'].canvas.toDataURL() : null;
            
            const previewHTML = generateContractHTML({
                name, address, jumin1, jumin2, phone, email, business,
                startDate, endDate, price, payDay, notes,
                signatureCEO, signatureFreelancer
            });
            
            document.getElementById('contractPreviewContent').innerHTML = previewHTML;
            document.getElementById('contractPreviewModal').style.display = 'block';
        }

        // PDF ë‹¤ìš´ë¡œë“œ (HTMLì„ ì´ë¯¸ì§€ë¡œ ë³€í™˜)
        window.downloadContractPDF = async function() {
            const name = document.getElementById('contractName').value;
            const address = document.getElementById('contractAddress').value;
            const jumin1 = document.getElementById('contractJumin1').value;
            const jumin2 = document.getElementById('contractJumin2').value;
            const phone = document.getElementById('contractPhone').value;
            const email = document.getElementById('contractEmail').value;
            const startDate = document.getElementById('contractStartDate').value;
            const endDate = document.getElementById('contractEndDate').value;
            
            if (!name || !address || !jumin1 || !jumin2 || !phone || !email || !startDate || !endDate) {
                alert('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            const ceoSigned = signaturePads['CEO'] && !isCanvasBlank(signaturePads['CEO'].canvas);
            const freelancerSigned = signaturePads['Freelancer'] && !isCanvasBlank(signaturePads['Freelancer'].canvas);
            
            if (!ceoSigned && !freelancerSigned) {
                alert('ìµœì†Œ í•œ ëª…ì€ ì„œëª…ì´ í•„ìš”í•©ë‹ˆë‹¤');
                return;
            }
            
            try {
                showToast('PDF ìƒì„± ì¤‘...', 'info');
                
                const business = document.getElementById('contractBusiness').value;
                const notes = document.getElementById('contractNotes').value;
                const price = 'ì¼ë‹¹ 1ë§Œ~50ë§Œì› (ì—…ë¬´ë³„ ìƒì´)';
                const payDay = 'ì—…ë¬´ ì™„ë£Œ í›„ 1ê°œì›” ì´ë‚´';
                
                // ì„œëª… ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°
                const signatureCEO = ceoSigned ? signaturePads['CEO'].canvas.toDataURL() : null;
                const signatureFreelancer = freelancerSigned ? signaturePads['Freelancer'].canvas.toDataURL() : null;
                
                // HTML ìƒì„± (ì„œëª… í¬í•¨)
                const contractHTML = generateContractHTML({
                    name, address, jumin1, jumin2, phone, email, business,
                    startDate, endDate, price, payDay, notes,
                    signatureCEO, signatureFreelancer
                });
                
                // ì„ì‹œ div ìƒì„±
                const tempDiv = document.createElement('div');
                tempDiv.style.position = 'absolute';
                tempDiv.style.left = '-9999px';
                tempDiv.style.width = '794px';
                tempDiv.style.background = 'white';
                tempDiv.innerHTML = contractHTML;
                document.body.appendChild(tempDiv);
                
                // HTMLì„ ì´ë¯¸ì§€ë¡œ ë³€í™˜
                const canvas = await html2canvas(tempDiv, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });
                
                // div ì œê±°
                document.body.removeChild(tempDiv);
                
                // PDF ìƒì„±
                const { jsPDF } = window.jspdf;
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 210; // A4 width in mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                const doc = new jsPDF('p', 'mm', 'a4');
                let heightLeft = imgHeight;
                let position = 0;
                
                // ì²« í˜ì´ì§€
                doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= 297;
                
                // ì¶”ê°€ í˜ì´ì§€ (í•„ìš”ì‹œ)
                while (heightLeft > 0) {
                    position = heightLeft - imgHeight;
                    doc.addPage();
                    doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= 297;
                }
                
                const fileName = `í”„ë¦¬ëœì„œê³„ì•½ì„œ_${name}_${new Date().toISOString().split('T')[0]}.pdf`;
                doc.save(fileName);
                
                showToast('âœ… PDF ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!', 'success');
                
            } catch (error) {
                console.error('âŒ PDF ìƒì„± ì‹¤íŒ¨:', error);
                alert('PDF ìƒì„± ì‹¤íŒ¨: ' + error.message);
            }
        }


        // ë¯¸ë¦¬ë³´ê¸° ë‹«ê¸°
        window.closePreview = function() {
            document.getElementById('contractPreviewModal').style.display = 'none';
        }

        // ê³„ì•½ì„œ ì €ì¥
        window.saveContract = async function() {
            // ìœ íš¨ì„± ê²€ì‚¬
            const name = document.getElementById('contractName').value;
            if (!name) {
                alert('í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
                return;
            }
            
            const contractData = {
                name: document.getElementById('contractName').value,
                address: document.getElementById('contractAddress').value,
                jumin1: document.getElementById('contractJumin1').value,
                jumin2: document.getElementById('contractJumin2').value,
                phone: document.getElementById('contractPhone').value,
                email: document.getElementById('contractEmail').value,
                business: document.getElementById('contractBusiness').value,
                startDate: document.getElementById('contractStartDate').value,
                endDate: document.getElementById('contractEndDate').value,
                price: 'ì¼ë‹¹ 1ë§Œ~50ë§Œì› (ì—…ë¬´ë³„ ìƒì´)',
                payDay: 'ì—…ë¬´ ì™„ë£Œ í›„ 1ê°œì›” ì´ë‚´',
                notes: document.getElementById('contractNotes').value,
                signatureCEO: signaturePads['CEO'] ? signaturePads['CEO'].canvas.toDataURL() : null,
                signatureFreelancer: signaturePads['Freelancer'] ? signaturePads['Freelancer'].canvas.toDataURL() : null,
                createdAt: new Date().toISOString()
            };
            
            try {
                const db = await initContractDB();
                const tx = db.transaction('contracts', 'readwrite');
                const store = tx.objectStore('contracts');
                
                store.add(contractData);
                
                tx.oncomplete = () => {
                    showToast('âœ… ê³„ì•½ì„œê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                    showContractList();
                };
                
                tx.onerror = () => {
                    throw new Error('ì €ì¥ ì‹¤íŒ¨');
                };
            } catch (error) {
                console.error('ì €ì¥ ì‹¤íŒ¨:', error);
                alert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ê³„ì•½ì„œ HTML ìƒì„±
        function generateContractHTML(data) {
            return `
                <div style="font-family: 'ë§‘ì€ ê³ ë”•', sans-serif; line-height: 1.6; color: #333; max-width: 800px; margin: 0 auto; padding: 20px;">
                    <h2 style="text-align: center; margin-bottom: 25px; color: #10b981; font-size: 26px;">
                        í‘œì¤€ í”„ë¦¬ëœì„œ ê³„ì•½ì„œ
                    </h2>
                    
                    <div style="margin-bottom: 25px; text-align: justify; line-height: 1.7; font-size: 14px;">
                        <strong>ë”í™ˆì ê²€</strong> (ì´í•˜ "ê°‘"ì´ë¼ í•©ë‹ˆë‹¤)ì€ 
                        <strong>${data.name}</strong> (ì´í•˜ "ì„"ì´ë¼ í•©ë‹ˆë‹¤)ì—ê²Œ 
                        ì•„íŒŒíŠ¸ì‚¬ì „ì ê²€ ëŒ€í–‰ì—…ë¬´ë¥¼ ì˜ë¢°í•˜ë©´ì„œ ë‹¤ìŒê³¼ ê°™ì´ í”„ë¦¬ëœì„œ ê³„ì•½ì„ ì²´ê²°í•œë‹¤.
                    </div>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ1ì¡° ã€ëª©ì ã€‘
                    </h3>
                    <p style="text-align: justify; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        ë³¸ ê³„ì•½ì€ "ê°‘"ì´ "ì„"ì—ê²Œ ì—°êµ¬ ë° ìš©ì—­ì„ ì˜ë¢°í•¨ì— ìˆì–´ í•„ìš”í•œ ì‚¬í•­ì„ ì •í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•œë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ2ì¡° ã€ê³„ì•½ì—…ë¬´ã€‘
                    </h3>
                    <p style="text-align: justify; line-height: 1.6; font-size: 13px; margin-bottom: 5px;">
                        "ì„"ì€ "ê°‘"ì´ ì˜ë¢°í•œ ë‹¤ìŒ ê° í˜¸ì˜ ê³¼ì—…ì„ ìˆ˜í–‰í•˜ì—¬ì•¼ í•œë‹¤.
                    </p>
                    <p style="margin-left: 20px; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        1. ì•„íŒŒíŠ¸ì‚¬ì „ì ê²€ ëŒ€í–‰ ì„œë¹„ìŠ¤
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ3ì¡° ã€ê³„ì•½ê¸°ê°„ã€‘
                    </h3>
                    <p style="text-align: justify; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        ê³„ì•½ê¸°ê°„ì€ <strong>${data.startDate}</strong>ë¡œë¶€í„° <strong>${data.endDate}</strong>ê¹Œì§€ë¡œ í•˜ë©°, 
                        "ê°‘"ê³¼ "ì„"ì˜ í•©ì˜ í•˜ì— ë³¸ ê³„ì•½ê¸°ê°„ì€ ì—°ì¥ë˜ê±°ë‚˜ í•´ì§€ë  ìˆ˜ ìˆë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ4ì¡° ã€ê·¼ë¬´ì‹œê°„ ë° ì¥ì†Œã€‘
                    </h3>
                    <p style="text-align: justify; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        "ì„"ì€ "ê°‘"ì´ ì§€ì •í•˜ëŠ” ê·¼ë¬´ì‹œê°„ ë° ê·¼ë¬´ì¥ì†Œì—ì„œ ì—…ë¬´ë¥¼ ì„±ì‹¤íˆ ìˆ˜í–‰í•˜ì—¬ì•¼ í•œë‹¤. 
                        ë‹¤ë§Œ, "ê°‘"ê³¼ í•©ì˜í•˜ì—¬ ê·¼ë¬´ ì‹œê°„ê³¼ ê·¼ë¬´ì¥ì†Œë¥¼ ì¡°ì •í•  ìˆ˜ ìˆë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ5ì¡° ã€ê³„ì•½ê¸ˆì•¡ã€‘
                    </h3>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘  ì´ ê³„ì•½ê¸ˆì•¡ì€ ì¼ë‹¹ 1ë§Œì›~50ë§Œì›ìœ¼ë¡œ í•œë‹¤. 
                        <strong style="color: #ef4444;">(ì—…ë¬´ì— ë”°ë¼ ì§€ê¸‰ë¹„ìš©ì´ ë‹¤ë¥´ê²Œ ì§€ê¸‰ë¨)</strong>
                    </p>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘¡ "ê°‘"ì€ "ì„"ì—ê²Œ ì•„íŒŒíŠ¸ì‚¬ì „ì ê²€ ì—…ë¬´ ì™„ë£Œ í›„ 
                        <strong style="color: #ef4444;">1ê°œì›” ì´ë‚´ì—</strong> "ì„" ëª…ì˜ì˜ ê³„ì¢Œë¡œ ì´ì²´í•œë‹¤.
                    </p>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘¢ "ê°‘"ì€ ì „ í•­ì˜ ë³´ìˆ˜ ì¤‘ ì‚¬ì—…ì†Œë“ì„¸ìœ¨(3.3%)ì— ë”°ë¼ ì›ì²œì§•ìˆ˜ì˜ë¬´ë¥¼ ì´í–‰í•œ í›„ 
                        ë‚¨ì€ ê¸ˆì•¡ì„ "ì„"ì—ê²Œ ì§€ê¸‰í•œë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ6ì¡° ã€ì–‘ ë‹¹ì‚¬ìì˜ ê¶Œë¦¬ì™€ ì˜ë¬´ã€‘
                    </h3>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘  "ê°‘"ì€ "ì„"ì´ ê³¼ì—…í•˜ëŠ”ë° í•„ìš”í•œ ìë£Œ ë° ì •ë³´ ë“±ì„ ì œê³µí•˜ì—¬ì•¼ í•˜ë©°, 
                        ê³¼ì—…ìˆ˜í–‰ì„ ìœ„í•œ "ì„"ì˜ ìš”ì²­ì´ ìˆëŠ” ê²½ìš° ì´ì— ì ê·¹ì ìœ¼ë¡œ í˜‘ì¡°í•˜ì—¬ì•¼ í•œë‹¤.
                    </p>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘¡ "ì„"ì€ ë³¸ ê³„ì•½ìƒ ë¶€ë‹´í•˜ëŠ” ëª¨ë“  ì‚¬í•­ì„ "ê°‘"ê³¼ í•©ì˜í•œ ëŒ€ë¡œ ì´í–‰í•˜ì—¬ì•¼ í•˜ë©°, 
                        ì‹ ì˜ì„±ì‹¤ì˜ ì›ì¹™ì— ë”°ë¼ ê³„ì•½ ë‚´ìš©ì„ ì´í–‰í•˜ì—¬ì•¼ í•œë‹¤.
                    </p>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘¢ "ê°‘"ì€ "ì„"ì˜ ê³¼ì—…ê³¼ ê´€ë ¨í•˜ì—¬ í˜‘ì˜í•  ì‚¬í•­ì´ ìˆëŠ” ê²½ìš° "ì„"ì—ê²Œ í˜‘ì˜ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆê³  
                        "ì„"ì€ ì´ëŸ¬í•œ "ê°‘"ì˜ ìš”êµ¬ì— ìµœëŒ€í•œ í˜‘ì¡°í•œë‹¤.
                    </p>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘£ "ì„"ì€ ë³¸ ê³„ì•½ ì¢…ë£Œ í›„ ì§€ì²´ì—†ì´ "ê°‘"ìœ¼ë¡œë¶€í„° ì œê³µë°›ì€ ì„œë¥˜, ì •ë³´, ë°ì´í„° ê¸°íƒ€ 
                        ëª¨ë“  í˜•íƒœì˜ ìë£Œë¥¼ "ê°‘"ì—ê²Œ ë°˜í™˜í•˜ì—¬ì•¼ í•˜ê³ , ë°˜í™˜ì´ ì–´ë ¤ìš´ ê²½ìš° ì´ë¥¼ íŒŒê¸°í•˜ê³  
                        "ê°‘"ì˜ ìŠ¹ì¸ì„ ë°›ì•„ì•¼ í•œë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ7ì¡° ã€ë¹„ë°€ìœ ì§€ ë° ì§€ì‹ì¬ì‚°ê¶Œì˜ ê·€ì†ã€‘
                    </h3>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘  "ì„"ì€ ë³¸ ê³„ì•½ ë° ê³¼ì—…ê³¼ ê´€ë ¨í•˜ì—¬ ì•Œê²Œ ëœ ì¼ì²´ì˜ ì •ë³´ë¥¼ ì™¸ë¶€ì— ëˆ„ì„¤í•˜ê±°ë‚˜ 
                        ìœ ì¶œí•´ì„œëŠ” ì•„ë‹ˆë˜ë©°, ì´ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ì†í•´ì— ëŒ€í•´ ì±…ì„ì„ ì§€ê¸°ë¡œ í•œë‹¤.
                    </p>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘¡ "ì„"ì€ ì°½ì¡°, ê°œì„ , ì‘ì„±, ìƒì‚°í•œ ëª¨ë“  ê²°ê³¼ë¬¼ì˜ ì €ì‘ê¶Œì— ëŒ€í•œ ì±…ì„ì„ ë³´ì¦í•˜ë©°, 
                        ë³¸ ê³„ì•½ì— ì˜í•œ ê²°ê³¼ë¬¼ì˜ ê¶Œë¦¬ëŠ” "ê°‘"ì˜ ì†Œìœ ê°€ ëœë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ8ì¡° ã€ê·¼ë¬´ì¡°ê±´ã€‘
                    </h3>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘  ë³¸ ê³„ì•½ìƒì˜ ì—…ë¬´ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•˜ì—¬ í•„ìš”í•œ ê¸°íƒ€ì‚¬í•­ì€ ììœ ë¡œ í•œë‹¤.
                    </p>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘¡ ë³¸ ê³„ì•½ ë‚´ìš© ì™¸ì—ë„ ë‹¤ë¥¸ í•„ìš”í•œ ì—…ë¬´ê°€ í•„ìš”í•œ ê²½ìš° "ê°‘"ì€ "ì„"ì´ ì¶”ê°€ë¡œ 
                        ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•œ ì¸ê±´ë¹„ì™€ ê³„ì•½ ê¸°ê°„ì€ ìƒí˜¸ í˜‘ì˜ í•˜ì— ê²°ì •í•œë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ9ì¡° ã€ê¶Œë¦¬ì˜ ì´ì „Â·ì–‘ë„Â·ì²˜ë¶„Â·ì¬ìœ„íƒ ê¸ˆì§€ã€‘
                    </h3>
                    <p style="text-align: justify; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        "ê°‘" ë˜ëŠ” "ì„"ì€ ì„œë¡œ ìƒëŒ€ë°©ì˜ ì„œë©´ ë™ì˜ê°€ ìˆëŠ” ê²½ìš°ë¥¼ ì œì™¸í•˜ê³ ëŠ” ì–´ë– í•œ ì´ìœ ë¡œë„ 
                        ë³¸ ê³„ì•½ìƒ ìì‹ ì˜ ê¶Œë¦¬ë‚˜ ì˜ë¬´ë¥¼ ë‹¤ë¥¸ ì œ3ìì—ê²Œ ì´ì „Â·ì–‘ë„Â·ì²˜ë¶„Â·ì¬ìœ„íƒí•  ìˆ˜ ì—†ë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ10ì¡° ã€í•´ì§€ã€‘
                    </h3>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘  "ê°‘"ê³¼ "ì„"ì€ ë‹¤ìŒ ê° í˜¸ì— í•´ë‹¹ë  ê²½ìš° ë³¸ ê³„ì•½ì„ í•´ì§€í•  ìˆ˜ ìˆë‹¤.
                    </p>
                    <p style="margin-left: 20px; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        1. ì •ë‹¹í•œ ì´ìœ  ì—†ì´ ê³¼ì—… ì§„í–‰ì´ ì´ë£¨ì–´ì§€ì§€ ì•Šì„ ë•Œ<br>
                        2. ì •ë‹¹í•œ ì´ìœ  ì—†ì´ ê³„ì•½ê¸°ê°„ ë‚´ì— ê³¼ì—…ì™„ë£Œê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤ê³  íŒë‹¨ë  ë•Œ<br>
                        3. ìƒí˜¸ê°„ì— ê³„ì•½ì„ í•´ì§€í•˜ê¸°ë¡œ ì„œë©´í•©ì˜í•œ ë•Œ<br>
                        4. íšŒìƒì ˆì°¨, íŒŒì‚°ì ˆì°¨ì˜ ê°œì‹œì‹ ì²­, ì±„ë¬´ì íšŒìƒ ë° íŒŒì‚°ì— ê´€í•œ ë²•ë¥ ì— ì˜í•œ ë³´ì „ì²˜ë¶„ì˜ ì‹ ì²­, 
                           ê¸°íƒ€ ì´ì™€ ìœ ì‚¬í•œ ì‹ ì²­, íšŒì‚¬ì˜ í•´ì‚°ê²°ì˜ ë“±ì˜ ì‚¬ìœ ê°€ ë°œìƒí•œ ë•Œ<br>
                        5. ì••ë¥˜, ê°€ì••ë¥˜, ê°€ì²˜ë¶„, ê²½ë§¤ì˜ ì§‘í–‰ì„ ë°›ê±°ë‚˜ êµ­ì„¸ë‚˜ ì§€ë°©ì„¸ ì²´ë‚©, ê¸°íƒ€ ê³µë²•ìƒì˜ ì²˜ë¶„ì„ ë°›ê³  
                           7ì¼ ì´ë‚´ì— ì§‘í–‰ì·¨ì†Œë‚˜ ì²´ë‚© ë“± ì²˜ë¶„ì˜ ì·¨ì†Œë¥¼ ë°›ì§€ ì•Šì€ ë•Œ<br>
                        6. ê¸°íƒ€ ë³¸ ê³„ì•½ìƒì˜ ê³¼ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤ê³  ê°ê´€ì ìœ¼ë¡œ íŒë‹¨ë  ë•Œ
                    </p>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘¡ ë³¸ ì¡°ì— ë”°ë¥¸ ê³„ì•½ì˜ í•´ì§€ëŠ” ê³„ì•½ê¸°ê°„ ì¤‘ ë°œìƒí•œ ë‹¹ì‚¬ì ê°„ì˜ ê¶Œë¦¬ì˜ë¬´ì— ë”°ë¥¸ 
                        ì†í•´ë°°ìƒì˜ ì²­êµ¬ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠëŠ”ë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ11ì¡° ã€ì†í•´ë°°ìƒã€‘
                    </h3>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘  "ì„"ì˜ ê·€ì±…ì‚¬ìœ ë¡œ ì¸í•˜ì—¬ ë³¸ ê³„ì•½ì´ ë¶ˆì´í–‰ ë˜ì—ˆì„ ê²½ìš° "ì„"ì€ "ê°‘"ì´ ì œì‹œí•œ 
                        ì†í•´ë°°ìƒì˜ ì±…ì„ì„ ì§„ë‹¤(ì´ë•Œ, ì†í•´ë°°ìƒì•¡ì€ ìƒí˜¸ í˜‘ì˜ í•œë‹¤).
                    </p>
                    <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        â‘¡ "ì„"ì˜ ê·€ì±…ì‚¬ìœ ë¡œ ì¸í•˜ì—¬ ê¸°íƒ€ ì œ3ìì—ê²Œ ì†í•´ê°€ ë°œìƒí•˜ëŠ” ê²½ìš° ì´ëŠ” "ì„"ì´ ë¶€ë‹´í•˜ë©°, 
                        "ê°‘"ì´ ì „ë¶€ ë˜ëŠ” ì¼ë¶€ë¥¼ ë°°ìƒí•œ ë•Œì—ëŠ” "ê°‘"ì´ "ì„"ì—ê²Œ ì´ë¥¼ êµ¬ìƒí•  ìˆ˜ ìˆë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ12ì¡° ã€ì¼ë¶€ë¬´íš¨ã€‘
                    </h3>
                    <p style="text-align: justify; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        ë³¸ ê³„ì•½ì˜ ì¼ë¶€ ì¡°í•­ì´ ë²•ë ¹ ë˜ëŠ” íŒê²°ì— ì˜í•˜ì—¬ ë¬´íš¨ ë˜ëŠ” ë¶ˆë²•ìœ¼ë¡œ íŒì •ë˜ëŠ” ê²½ìš°ì—ë„ 
                        ë³¸ ê³„ì•½ ì „ì²´ê°€ ë¬´íš¨ë¡œ ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë©°, ë¬´íš¨ë¡œ ë˜ì§€ ì•ŠëŠ” ë‹¤ë¥¸ ì¡°í•­ì€ ë²•ë ¹ì— ì˜í•˜ì—¬ 
                        í—ˆìš©ë˜ëŠ” í•œë„ì—ì„œ ì—¬ì „íˆ ìœ íš¨í•˜ê²Œ ì¡´ì†í•˜ê³ , ë¬´íš¨ ë˜ëŠ” ë¶ˆë²•ì¡°í•­ì´ í¬í•¨ë˜ì§€ ì•Šì•˜ë˜ ê²ƒì²˜ëŸ¼ í•´ì„í•œë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ13ì¡° ã€ê³„ì•½ì˜ ë³€ê²½ã€‘
                    </h3>
                    <p style="text-align: justify; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        ë³¸ ê³„ì•½ì€ "ê°‘"ê³¼ "ì„"ì˜ ì„œë©´í•©ì˜ì— ë”°ë¼ ë³€ê²½ë  ìˆ˜ ìˆë‹¤.
                    </p>
                    
                    <h3 style="color: #10b981; margin-top: 20px; margin-bottom: 10px; border-bottom: 2px solid #10b981; padding-bottom: 5px; font-size: 15px;">
                        ì œ14ì¡° ã€ê´€í• ã€‘
                    </h3>
                    <p style="text-align: justify; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                        ë³¸ ê³„ì•½ê³¼ ê´€ë ¨í•˜ì—¬ ë¶„ìŸì´ ë°œìƒí•œ ê²½ìš° ë‹¹ì‚¬ìì˜ ìƒí˜¸ í˜‘ì˜ì— ì˜í•œ í•´ê²°ì„ ëª¨ìƒ‰í•˜ë˜, 
                        ë¶„ìŸì— ê´€í•œ í•©ì˜ê°€ ì´ë£¨ì–´ì§€ì§€ ì•„ë‹ˆí•œ ê²½ìš°ì—ëŠ” "ê°‘"ì˜ ë³¸ì  ì†Œì¬ì§€ ê´€í• ë²•ì›ì„ 
                        ì œ1ì‹¬ ê´€í• ë²•ì›ìœ¼ë¡œ í•˜ì—¬ ì†Œì†¡ì„ í†µí•´ ë¶„ìŸì„ í•´ê²°í•˜ê¸°ë¡œ í•œë‹¤.
                    </p>
                    
                    <div style="margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                        <p style="text-align: center; margin-bottom: 30px; line-height: 1.6; font-size: 13px; margin-bottom: 15px;">
                            ê° ë‹¹ì‚¬ìëŠ” ìœ„ ê³„ì•½ì„ ì¦ëª…í•˜ê¸° ìœ„í•˜ì—¬ ë³¸ ê³„ì•½ì„œ 2í†µì„ ì‘ì„±í•˜ì—¬,<br>
                            ê°ê° ì„œëª…(ë˜ëŠ” ê¸°ëª…)ë‚ ì¸ í›„ "ê°‘"ê³¼ "ì„"ì´ ê°ê° 1í†µì”©ì„ ë³´ê´€í•œë‹¤.
                        </p>
                        
                        <p style="text-align: center; font-size: 20px; font-weight: bold; margin-bottom: 40px;">
                            ${new Date().getFullYear()}ë…„ ${new Date().getMonth() + 1}ì›” ${new Date().getDate()}ì¼
                        </p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 30px;">
                            <div style="border: 2px solid #10b981; padding: 15px; border-radius: 8px; background: white;">
                                <h4 style="color: #10b981; margin-bottom: 10px; text-align: center; font-size: 16px;">ã€ê°‘ã€‘</h4>
                                <p style="line-height: 1.6; font-size: 13px;">
                                    <strong>ëŒ€í‘œì:</strong> ë°•ì§€í˜„ (ë”í™ˆì ê²€)<br>
                                    <strong>ì£¼ì†Œ:</strong> ê²½ê¸°ë„ ë¶€ì²œì‹œ ì›ë¯¸êµ¬ ì†¡ë‚´ëŒ€ë¡œ265ë²ˆê¸¸ 23, 201í˜¸<br>
                                    <strong>ì‚¬ì—…ìë²ˆí˜¸:</strong> 531-42-01293<br>
                                    <strong>ì—°ë½ì²˜:</strong> 070-8019-1456
                                </p>
                                ${data.signatureCEO ? `
                                    <div style="margin-top: 10px; text-align: center;">
                                        <img src="${data.signatureCEO}" style="max-width: 150px; max-height: 60px; border: 1px solid #ddd; padding: 5px; background: white;" alt="CEO ì„œëª…">
                                        <p style="font-size: 11px; color: #333; margin-top: 5px;">(ì„œëª…)</p>
                                    </div>
                                ` : `
                                    <div style="margin-top: 10px; padding: 30px; border: 1px dashed #ddd; text-align: center; color: #333; font-size: 12px;">
                                        ì„œëª… ì—†ìŒ
                                    </div>
                                `}
                            </div>
                            
                            <div style="border: 2px solid #10b981; padding: 15px; border-radius: 8px; background: white;">
                                <h4 style="color: #10b981; margin-bottom: 10px; text-align: center; font-size: 16px;">ã€ì„ã€‘</h4>
                                <p style="line-height: 1.6; font-size: 13px;">
                                    <strong>ì„±ëª…:</strong> ${data.name}<br>
                                    <strong>ì£¼ì†Œ:</strong> ${data.address}<br>
                                    <strong>ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸:</strong> ${data.jumin1}-${data.jumin2}******<br>
                                    <strong>ì—°ë½ì²˜:</strong> ${data.phone}<br>
                                    <strong>ì´ë©”ì¼:</strong> ${data.email}
                                    ${data.business ? `<br><strong>ì‚¬ì—…ìë²ˆí˜¸:</strong> ${data.business}` : ''}
                                </p>
                                ${data.signatureFreelancer ? `
                                    <div style="margin-top: 10px; text-align: center;">
                                        <img src="${data.signatureFreelancer}" style="max-width: 150px; max-height: 60px; border: 1px solid #ddd; padding: 5px; background: white;" alt="í”„ë¦¬ëœì„œ ì„œëª…">
                                        <p style="font-size: 11px; color: #333; margin-top: 5px;">(ì„œëª…)</p>
                                    </div>
                                ` : `
                                    <div style="margin-top: 10px; padding: 30px; border: 1px dashed #ddd; text-align: center; color: #333; font-size: 12px;">
                                        ì„œëª… ì—†ìŒ
                                    </div>
                                `}
                            </div>
                        </div>
                    </div>
                    
                    ${data.notes ? `
                        <div style="margin-top: 30px; padding: 20px; background: #fffbeb; border-radius: 8px; border-left: 5px solid #fbbf24;">
                            <h4 style="color: #92400e; margin-bottom: 10px;">ğŸ“Œ íŠ¹ì´ì‚¬í•­</h4>
                            <p style="line-height: 1.6; font-size: 13px; margin-bottom: 15px; color: #92400e;">${data.notes}</p>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // ê³„ì•½ì„œ ë³´ê¸°
        window.viewContract = async function(id) {
            try {
                const db = await initContractDB();
                const tx = db.transaction('contracts', 'readonly');
                const store = tx.objectStore('contracts');
                const request = store.get(id);
                
                request.onsuccess = () => {
                    const contract = request.result;
                    if (!contract) {
                        alert('ê³„ì•½ì„œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                        return;
                    }
                    
                    const html = generateContractHTML(contract);
                    document.getElementById('contractPreviewContent').innerHTML = html;
                    document.getElementById('contractPreviewModal').style.display = 'block';
                };
            } catch (error) {
                console.error('ì¡°íšŒ ì‹¤íŒ¨:', error);
                alert('ê³„ì•½ì„œë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
            }
        }

        // PDF ìƒì„±
        window.generateContractPDF = function() {
            showToast('ğŸ“„ ì¸ì‡„ í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤', 'info');
            setTimeout(() => {
                window.print();
            }, 500);
        }



        // ê³„ì•½ì„œ ì‚­ì œ
        window.deleteContract = async function(id) {
            if (!confirm('ì •ë§ ì´ ê³„ì•½ì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }
            
            try {
                const db = await initContractDB();
                const tx = db.transaction('contracts', 'readwrite');
                const store = tx.objectStore('contracts');
                
                store.delete(id);
                
                tx.oncomplete = () => {
                    showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
                    loadContracts();
                };
            } catch (error) {
                console.error('ì‚­ì œ ì‹¤íŒ¨:', error);
                alert('ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê³„ì•½ì„œ ë°ì´í„° ë¡œë“œ
        document.addEventListener('DOMContentLoaded', () => {
            if (document.getElementById('contract')) {
                loadContracts();
            }
            
            // í…Œë§ˆ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
            loadTheme();
        });

        // ==================== í…Œë§ˆ í† ê¸€ ê¸°ëŠ¥ ====================
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            
            if (body.classList.contains('light-mode')) {
                // ë¼ì´íŠ¸ ëª¨ë“œ â†’ ë‹¤í¬ ëª¨ë“œ
                body.classList.remove('light-mode');
                themeToggle.textContent = 'ğŸŒ™';
                localStorage.setItem('theme', 'dark');
            } else {
                // ë‹¤í¬ ëª¨ë“œ â†’ ë¼ì´íŠ¸ ëª¨ë“œ
                body.classList.add('light-mode');
                themeToggle.textContent = 'â˜€ï¸';
                localStorage.setItem('theme', 'light');
            }
        }

        // ì €ì¥ëœ í…Œë§ˆ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            
            if (savedTheme === 'light') {
                body.classList.add('light-mode');
                themeToggle.textContent = 'â˜€ï¸';
            } else {
                body.classList.remove('light-mode');
                themeToggle.textContent = 'ğŸŒ™';
            }
        }
// ==========================================================================
    // [ë”í™ˆì ê²€] ìµœì¢… ì™„ê²° íŒ¨ì¹˜ v5.2 (ì¥ë¹„ì ê²€ ìŠ¤ë§ˆíŠ¸ í•©ì¹˜ê¸° + ê°€ì´ë“œ ë¦¬ë‰´ì–¼ ë³µêµ¬)
    // - ì¥ë¹„ì ê²€: ì‚¬ì§„ ìˆ˜(1~2ì¥)ì— ë”°ë¼ 1í˜ì´ì§€ì— 2ê°œ í•­ëª© ìë™ ë°°ì¹˜
    // - ì‚¬ì§„ì •ë ¬: 1ì¥(ì¤‘ì•™), 2ì¥(ë‚˜ë€íˆ), ë¹ˆì¹¸ ìë™ ì œê±°
    // - ê°€ì´ë“œ: ëˆ„ë½ëœ ê°€ì´ë“œ í˜ì´ì§€ ë³µêµ¬ ë° í”„ë¦¬ë¯¸ì—„ ë””ìì¸ ì ìš©
    // ==========================================================================

    // 1. [ë¡œê·¸ì¸ ì‹œìŠ¤í…œ]
    const FIXED_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS4Tz0-NgXyWR36c9hkZ4ko0ll4g-oj5YGHZysuH0c1Mngr4Ev9-VgiryTHHcMd2Zq5NuOmOI6dMZeh/pub?output=csv';

    window.verifyAccessCode = async function(code, pin) {
        try {
            const response = await fetch(FIXED_CSV_URL);
            if (!response.ok) throw new Error('Network response was not ok');
            const csvText = await response.text();
            const lines = csvText.split('\n');
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                const cols = line.split(',').map(c => c.trim().replace(/^"|"$/g, ''));
                if (cols[0] === code && cols[3] === 'í™œì„±' && cols[4] === pin) {
                    return { success: true, name: cols[1], team: cols[2] };
                }
            }
            return { success: false, message: 'ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•Šê±°ë‚˜ ë¹„í™œì„± ê³„ì •ì…ë‹ˆë‹¤.' };
        } catch (error) {
            const lastLogin = localStorage.getItem('dhLoginData');
            if (lastLogin) {
                const data = JSON.parse(lastLogin);
                if (data.code === code && data.pin === pin) return { success: true, name: data.name, team: data.team, offline: true };
            }
            return { success: false, message: 'ì„œë²„ ì—°ê²° ì‹¤íŒ¨' };
        }
    };

    // 2. [ë””ìì¸ í…Œë§ˆ]
    const R_THEME = {
        primary: "#10b981",      // í•˜ìì ê²€ (ë…¹ìƒ‰)
        equipment: "#2c3e50",    // ì¥ë¹„ì ê²€ (ë„¤ì´ë¹„)
        dark: "#1f2937",
        light: "#6b7280",
        border: "#e5e7eb",
        bg: "#f9fafb",
        contact: "ë¬¸ì˜: 070-8019-1456 / 010-9985-0128"
    };

    // [ë¡œê³ ] 100ì–µ ìŠ¤íƒ€ì¼
    function getPremiumLogo() {
        return `
            <div style="display: flex; align-items: center; gap: 10px;">
                <svg width="40" height="40" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 40 L50 10 L90 40" stroke="url(#paint0_linear)" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M20 32 V80 H40" stroke="#0ea5e9" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M80 32 V80 H60" stroke="#f43f5e" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M40 80 V60 C40 50 60 50 60 60 V80" stroke="#a855f7" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/>
                    <defs>
                        <linearGradient id="paint0_linear" x1="10" y1="40" x2="90" y2="40" gradientUnits="userSpaceOnUse">
                            <stop stop-color="#22d3ee"/>
                            <stop offset="1" stop-color="#3b82f6"/>
                        </linearGradient>
                    </defs>
                </svg>
                <div style="font-family: 'Malgun Gothic', sans-serif; font-weight: 900; font-size: 26px; color: #111827; letter-spacing: -0.5px;">
                    ë”í™ˆì ê²€
                </div>
            </div>
        `;
    }

    // 3. [ì¥ë¹„ ì ê²€ í˜ì´ì§€] (âš ï¸ìŠ¤ë§ˆíŠ¸ í•©ì¹˜ê¸° ë¡œì§ ì ìš©)
    window.createEquipmentPage = function(items) {
        let contentHTML = '';
        
        // itemsëŠ” 1ê°œ ë˜ëŠ” 2ê°œì˜ ì¥ë¹„ì ê²€ í•­ëª© ë°°ì—´ì„
        items.forEach((item, idx) => {
            const space = item.space || (item.spaces ? item.spaces.join(', ') : '-');
            const rawPhotos = item.photos || {};
            
            // ì‚¬ì§„ ë°ì´í„° ì¶”ì¶œ (ìˆëŠ” ê²ƒë§Œ)
            let photos = [];
            if(rawPhotos['ì¢Œì¸¡']) photos.push({label:'ì¢Œì¸¡', src:rawPhotos['ì¢Œì¸¡'], color:'#3b82f6'});
            if(rawPhotos['ìš°ì¸¡']) photos.push({label:'ìš°ì¸¡', src:rawPhotos['ìš°ì¸¡'], color:'#ef4444'});
            if(rawPhotos['ë°”ë‹¥1']) photos.push({label:'ë°”ë‹¥1', src:rawPhotos['ë°”ë‹¥1'], color:'#f59e0b'});
            if(rawPhotos['ë°”ë‹¥2']) photos.push({label:'ë°”ë‹¥2', src:rawPhotos['ë°”ë‹¥2'], color:'#f59e0b'});

            // ì‚¬ì§„ ë Œë”ë§ HTML ìƒì„± (ìë™ ì •ë ¬)
            let photoGridHtml = '';
            
            if (photos.length === 0) {
                photoGridHtml = `<div style="text-align:center; padding:30px; color:#ccc;">ì‚¬ì§„ ì—†ìŒ</div>`;
            } else if (photos.length === 1) {
                // 1ì¥: ì¤‘ì•™ ì •ë ¬ (ìµœëŒ€ í¬ê¸°)
                photoGridHtml = `
                    <div style="display: flex; justify-content: center;">
                        <div style="flex: 1; background: white; position: relative; max-width: 550px; height: 400px;">
                            <img src="${photos[0].src}" style="width: 100%; height: 100%; object-fit: contain;" />
                            <div style="position: absolute; bottom: 8px; left: 8px; background: rgba(44, 62, 80, 0.85); color: white; font-size: 11px; padding: 3px 8px; border-radius: 4px; font-weight: 700;">${photos[0].label}</div>
                        </div>
                    </div>
                `;
            } else if (photos.length === 2) {
                // 2ì¥: ë‚˜ë€íˆ (ìµœëŒ€ í¬ê¸°)
                photoGridHtml = `
                    <div style="display: flex; gap: 2px; background: ${R_THEME.border};">
                        ${photos.map((p, i) => `
                            <div style="flex: 1; background: white; position: relative; height: 350px;">
                                <img src="${p.src}" style="width: 100%; height: 100%; object-fit: contain;" />
                                <div style="position: absolute; bottom: 8px; left: 8px; background: ${i === 0 ? 'rgba(44, 62, 80, 0.85)' : R_THEME.equipment}; color: white; font-size: 11px; padding: 3px 8px; border-radius: 4px; font-weight: 700;">${p.label}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            } else {
                // 3~4ì¥: 2x2 ê²©ì (ìµœëŒ€ í¬ê¸°)
                photoGridHtml = `
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2px; background: ${R_THEME.border};">
                        ${photos.map((p, i) => `
                            <div style="background: white; position: relative; height: 280px;">
                                <img src="${p.src}" style="width: 100%; height: 100%; object-fit: contain;" />
                                <div style="position: absolute; bottom: 6px; left: 6px; background: ${i % 2 === 0 ? 'rgba(44, 62, 80, 0.85)' : R_THEME.equipment}; color: white; font-size: 10px; padding: 2px 6px; border-radius: 3px; font-weight: 700;">${p.label}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            contentHTML += `
                <div style="margin-bottom: 25px; break-inside: avoid; background: white; border: 1px solid ${R_THEME.border}; border-radius: 8px; overflow: hidden;">
                    <div style="display: flex; align-items: center; padding: 10px 15px; background: ${R_THEME.bg}; border-bottom: 1px solid ${R_THEME.border};">
                        <div style="background: ${R_THEME.equipment}; color: white; font-weight: 800; font-size: 12px; padding: 3px 10px; border-radius: 20px; margin-right: 15px;">#${String(item._originalIndex).padStart(2, '0')}</div>
                        <div style="font-size: 15px; font-weight: 800; color: ${R_THEME.dark}; margin-right: 12px;">${space}</div>
                        <div style="color: #cbd5e1; margin-right: 12px;">|</div>
                        <div style="font-size: 13px; color: #4b5563; font-weight: 600; flex: 1;">${item.inspection || 'íŠ¹ì´ì‚¬í•­ ì—†ìŒ'}</div>
                    </div>
                    <div style="padding: 15px;">
                         ${photoGridHtml}
                    </div>
                </div>
            `;
        });

        return `
            <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 45px; box-sizing: border-box; position: relative;">
                <div style="border-bottom: 2px solid ${R_THEME.equipment}; padding-bottom: 15px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: flex-end;">
                    <div style="font-size: 22px; font-weight: 900; color: ${R_THEME.dark};">ì¥ë¹„ ì ê²€ ë¦¬í¬íŠ¸</div>
                    <div style="font-size: 12px; font-weight: 700; color: ${R_THEME.light};">${projectData.apartmentName}</div>
                </div>

                ${contentHTML}

                <div style="position: absolute; bottom: 40px; left: 45px; right: 45px; padding-top: 15px; border-top: 1px solid ${R_THEME.border}; display: flex; justify-content: space-between; align-items: center; color: ${R_THEME.light}; font-size: 11px;">
                    <div style="font-weight: 800; color: ${R_THEME.dark};">THE HOME INSPECTION</div>
                    <div style="font-weight: 800; color: ${R_THEME.dark};">${R_THEME.contact}</div>
                </div>
            </div>
        `;
    }

    // 4. [ê°€ì´ë“œ í˜ì´ì§€] (ëˆ„ë½ëœ ë¶€ë¶„ ë³µêµ¬ + ë””ìì¸ ë¦¬ë‰´ì–¼)
    function createGuidePage(title, color, content) {
        return `
            <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 50px; box-sizing: border-box; position: relative;">
                <div style="border-bottom: 3px solid ${color}; padding-bottom: 15px; margin-bottom: 30px; display: flex; align-items: center; justify-content: space-between;">
                    <div>${getPremiumLogo()}</div>
                    <div style="font-size: 20px; font-weight: 900; color: ${color};">${title}</div>
                </div>
                <div style="font-size: 14px; line-height: 1.8; color: #374151;">
                    ${content}
                </div>
                <div style="position: absolute; bottom: 40px; left: 50px; right: 50px; padding-top: 15px; border-top: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center; color: ${R_THEME.light}; font-size: 11px;">
                    <div style="font-weight: 800; color: ${R_THEME.dark};">THE HOME INSPECTION</div>
                    <div style="font-weight: 800; color: ${R_THEME.dark};">${R_THEME.contact}</div>
                </div>
            </div>
        `;
    }

    window.createWarrantyGuidePage1 = function() {
        return createGuidePage("í•˜ìë³´ìˆ˜ ì²­êµ¬ ê°€ì´ë“œ", "#ef4444", `
            <div style="background:#fef2f2; padding:20px; border-radius:8px; margin-bottom:20px; font-weight:600; color:#b91c1c;">
                í•˜ìë¥¼ ë°œê²¬í•˜ì…¨ë‚˜ìš”? í•˜ìë‹´ë³´ì±…ì„ ê¸°ê°„ ë‚´ì— ì ì ˆí•œ ì ˆì°¨ë¡œ ë³´ìˆ˜ ì²­êµ¬í•˜ì‹œë©´ ë¬´ìƒìœ¼ë¡œ ìˆ˜ë¦¬ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
            <h3 style="color:#111827; margin-top:20px;">1ë‹¨ê³„: í•˜ì ë°œê²¬ ì¦‰ì‹œ ì‚¬ì§„ ì´¬ì˜ ë° ê¸°ë¡</h3>
            <ul style="margin-bottom:20px;">
                <li><strong>ì›ê²½ ì‚¬ì§„:</strong> í•˜ìê°€ ì–´ëŠ ìœ„ì¹˜ì— ìˆëŠ”ì§€ ì „ì²´ì ì¸ ê³µê°„ ì´¬ì˜</li>
                <li><strong>ê·¼ì ‘ ì‚¬ì§„:</strong> í•˜ì ë¶€ìœ„ë¥¼ í™•ëŒ€í•˜ì—¬ ìƒì„¸í•˜ê²Œ ì´¬ì˜ (ì, ë³¼íœ ë“±ìœ¼ë¡œ í¬ê¸° ë¹„êµ)</li>
                <li><strong>ê¸°ë¡ ì‚¬í•­:</strong> ë°œê²¬ ë‚ ì§œ, ìœ„ì¹˜(ê³µê°„), í•˜ì ë‚´ìš© ìƒì„¸ ë©”ëª¨</li>
            </ul>
            <h3 style="color:#111827; margin-top:20px;">2ë‹¨ê³„: í•˜ìë³´ìˆ˜ ì‹ ì²­</h3>
            <p>ê´€ë¦¬ì‚¬ë¬´ì†Œ ë˜ëŠ” ì‹œê³µì‚¬ A/Sì„¼í„°ì— ì ‘ìˆ˜í•©ë‹ˆë‹¤. (ì…ì£¼ì ì •ë³´, í•˜ì ì‚¬ì§„, ì‹ ì²­ì„œ ì œì¶œ)</p>
        `);
    }

    window.createAirQualityManagementGuidePage = function() {
        return createGuidePage("ì‹¤ë‚´ ê³µê¸°ì§ˆ ê´€ë¦¬ ê°€ì´ë“œ", "#10b981", `
            <div style="background:#f0fdf4; padding:20px; border-radius:8px; margin-bottom:20px; font-weight:600; color:#15803d;">
                ìƒˆ ì•„íŒŒíŠ¸ëŠ” ìì¬ì—ì„œ ë‚˜ì˜¤ëŠ” ìœ í•´ë¬¼ì§ˆ ê´€ë¦¬ê°€ í•„ìˆ˜ì…ë‹ˆë‹¤. ì…ì£¼ ì „í›„ ì ì ˆí•œ í™˜ê¸°ë¡œ ì¾Œì í•œ í™˜ê²½ì„ ë§Œë“œì„¸ìš”.
            </div>
            <h3 style="color:#111827; margin-top:20px;">1. ë² ì´í¬ì•„ì›ƒ (Bake-Out)</h3>
            <p>ì‹¤ë‚´ ì˜¨ë„ë¥¼ ë†’ì—¬ ìœ í•´ë¬¼ì§ˆì„ ë°°ì¶œì‹œí‚¤ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>
            <ul>
                <li>ëª¨ë“  ì°½ë¬¸ê³¼ ë¬¸ì„ ë‹«ê³  ìˆ˜ë‚©ì¥ ë¬¸ì€ ì—½ë‹ˆë‹¤.</li>
                <li>ë‚œë°©ì„ 30~35ë„ë¡œ ì„¤ì •í•˜ì—¬ 6~8ì‹œê°„ ìœ ì§€í•©ë‹ˆë‹¤.</li>
                <li>ì´í›„ ëª¨ë“  ë¬¸ì„ ì—´ì–´ 1~2ì‹œê°„ ë™ì•ˆ ì¶©ë¶„íˆ í™˜ê¸°í•©ë‹ˆë‹¤. (3~5íšŒ ë°˜ë³µ)</li>
            </ul>
            <h3 style="color:#111827; margin-top:20px;">2. ì§€ì†ì ì¸ í™˜ê¸°</h3>
            <p>ì…ì£¼ í›„ì—ë„ í•˜ë£¨ 3íšŒ, 30ë¶„ ì´ìƒ ë§ë°”ëŒì´ ì¹˜ë„ë¡ í™˜ê¸°í•´ì£¼ì„¸ìš”.</p>
        `);
    }

    window.createCondensationGuidePage = function() {
        return createGuidePage("ê²°ë¡œ ì˜ˆë°© ë° ê´€ë¦¬ ê°€ì´ë“œ", "#3b82f6", `
            <div style="background:#eff6ff; padding:20px; border-radius:8px; margin-bottom:20px; font-weight:600; color:#1d4ed8;">
                ê²°ë¡œëŠ” ì‹¤ë‚´ì™¸ ì˜¨ë„ì°¨ì™€ ìŠµë„ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ìì—°í˜„ìƒì…ë‹ˆë‹¤. ìƒí™œ ìŠµê´€ìœ¼ë¡œ ì˜ˆë°©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </div>
            <h3 style="color:#111827; margin-top:20px;">ê²°ë¡œ ì˜ˆë°© ìˆ˜ì¹™</h3>
            <ul>
                <li><strong>í™˜ê¸°:</strong> í•˜ë£¨ 2~3íšŒ, 10ë¶„ ì´ìƒ í™˜ê¸°í•˜ì—¬ ë‚´ë¶€ ìŠµê¸°ë¥¼ ë°°ì¶œí•˜ì„¸ìš”.</li>
                <li><strong>ê°€êµ¬ ë°°ì¹˜:</strong> ì™¸ë²½ê³¼ ê°€êµ¬ ì‚¬ì´ëŠ” 5~10cm ê°„ê²©ì„ ë‘ì–´ ê³µê¸°ê°€ í†µí•˜ê²Œ í•˜ì„¸ìš”.</li>
                <li><strong>ìŠµë„ ì¡°ì ˆ:</strong> ì‹¤ë‚´ ìŠµë„ëŠ” 40~60%ê°€ ì ë‹¹í•©ë‹ˆë‹¤. ë¹¨ë˜ ê±´ì¡° ì‹œ ë°˜ë“œì‹œ í™˜ê¸°í•˜ì„¸ìš”.</li>
            </ul>
            <h3 style="color:#111827; margin-top:20px;">ê²°ë¡œ ë°œìƒ ì‹œ</h3>
            <p>ì¦‰ì‹œ ë¬¼ê¸°ë¥¼ ë‹¦ì•„ë‚´ê³  ê±´ì¡°ì‹œí‚¨ í›„, ê³°íŒ¡ì´ ë°©ì§€ì œë¥¼ ë„í¬í•˜ê±°ë‚˜ í™˜ê¸°ë¥¼ ì‹œì¼œì£¼ì„¸ìš”.</p>
        `);
    }

    // 5. [PDF ìƒì„± ë¡œì§] (ìˆ˜ì •ë¨)
    window.generatePDF = async function() {
        if (!projectData.apartmentName) return alert('í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”');
        document.getElementById('loading').classList.add('active');

        try {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            const W = 210, H = 297;

            // 1. í‘œì§€ (ë¯¸ë‹ˆë©€ ëª¨ë˜ ë ˆë“œ)
            await window.addHTMLPageToPDF(doc, window.createSummaryFirstPage(), W, H);

            // 2. í•˜ì ëª©ë¡ (18ê°œì”©, 0ë²ˆë¶€í„°)
            if (projectData.defects.length > 0) {
                const itemsPerPage = 18;
                for (let i = 0; i < projectData.defects.length; i += itemsPerPage) {
                    doc.addPage();
                    await window.addHTMLPageToPDF(doc, window.createDefectListPage(i, itemsPerPage), W, H);
                }
            }

            // 3. í•˜ì ì‚¬ì§„
            const defectsWithPhotos = projectData.defects.filter(d => d.photos && d.photos.length > 0);
            for (let i = 0; i < defectsWithPhotos.length; i += 3) {
                doc.addPage();
                await window.addHTMLPageToPDF(doc, await window.createDefectDetailPage(defectsWithPhotos.slice(i, i+3), i), W, H);
            }

            // 4. ì¥ë¹„ ì ê²€ (1í˜ì´ì§€ì— 1ê°œ í•­ëª©ì”©)
            const equipmentWithPhotos = projectData.equipment.filter(e => (e.photos && Object.values(e.photos).some(p=>p)) || e.photo);
            
            // ì¸ë±ìŠ¤ ë¶€ì—¬ (í‘œì‹œìš©)
            equipmentWithPhotos.forEach((item, i) => item._originalIndex = i + 1);
            
            // ê° ì¥ë¹„ë¥¼ ë…ë¦½ì ì¸ í˜ì´ì§€ì— í‘œì‹œ
            for (let i = 0; i < equipmentWithPhotos.length; i++) {
                doc.addPage();
                await window.addHTMLPageToPDF(doc, window.createEquipmentPage([equipmentWithPhotos[i]]), W, H);
            }

            // 4-1. ê³µê¸°ì§ˆ ì¸¡ì • í˜ì´ì§€ ì¶”ê°€
            const airQualityWithData = projectData.airQuality.filter(room => 
                room.radon || room.formaldehyde || room.vocs
            );
            if (airQualityWithData.length > 0) {
                doc.addPage();
                const airQualityHTML = window.createAirQualityDetailPage();
                await window.addHTMLPageToPDF(doc, airQualityHTML, W, H);
            }

            // ê²¬ì ì„œ í˜ì´ì§€ ì¶”ê°€ (ì‹¤ë‚´ê³µê¸°ì§ˆì¸¡ì •ê²°ê³¼ ë°”ë¡œ ë‹¤ìŒ)
            doc.addPage(); await window.addHTMLPageToPDF(doc, window.createQuotationPage(), W, H);

            // ì‹œê³µì•ˆë‚´ í˜ì´ì§€ ì¶”ê°€ (ê²¬ì ì„œ ë‹¤ìŒ)
            doc.addPage(); await window.addHTMLPageToPDF(doc, window.createServiceGuidePage(), W, H);

            // 5. ê°€ì´ë“œ í˜ì´ì§€ ì¶”ê°€
            doc.addPage(); await window.addHTMLPageToPDF(doc, window.createWarrantyGuidePage1(), W, H);
            doc.addPage(); await window.addHTMLPageToPDF(doc, window.createAirQualityManagementGuidePage(), W, H);
            doc.addPage(); await window.addHTMLPageToPDF(doc, window.createCondensationGuidePage(), W, H);

            const filename = `ë”í™ˆì ê²€_${projectData.apartmentName}_${projectData.dong}${projectData.ho}.pdf`;
            doc.save(filename);
            
        } catch (e) {
            alert('PDF ìƒì„± ì˜¤ë¥˜: ' + e.message);
            console.error(e);
        } finally {
            document.getElementById('loading').classList.remove('active');
        }
    }

    // [í•˜ìì ê²€ ê´€ë ¨ í•¨ìˆ˜ë“¤ - ê¸°ì¡´ ë””ìì¸ ìœ ì§€]
    // v5.1ê³¼ ë™ì¼í•˜ë¯€ë¡œ ê°„ëµíˆ í¬í•¨ (í•„ìˆ˜)
    window.createSummaryFirstPage = function() {
        // ==================== ë¯¸ë‹ˆë©€ ëª¨ë˜ í‘œì§€ (ë ˆë“œ ì•…ì„¼íŠ¸) ====================
        return `
            <div style="width: 794px; height: 1123px; background: #ffffff; display: flex; flex-direction: column; font-family: 'Malgun Gothic', sans-serif; position: relative; box-sizing: border-box;">
                
                <!-- ìƒë‹¨ ë ˆë“œ ì•…ì„¼íŠ¸ ë°” -->
                <div style="height: 8px; background: linear-gradient(90deg, #e74c3c 0%, #c0392b 100%);"></div>
                
                <!-- ì¢Œì¸¡ ì‚¬ì´ë“œ ì•…ì„¼íŠ¸ -->
                <div style="position: absolute; left: 0; top: 0; width: 6px; height: 100%; background: linear-gradient(180deg, #e74c3c 0%, #c0392b 100%);"></div>
                
                <!-- ë©”ì¸ ì»¨í…ì¸  -->
                <div style="flex: 1; padding: 100px 60px 45px 80px; display: flex; flex-direction: column;">
                    
                    <!-- ìƒë‹¨ ë¡œê³ /íƒ€ì… ì˜ì—­ -->
                    <div style="margin-bottom: 30px;">
                        <div style="display: inline-flex; align-items: center; gap: 12px; padding: 10px 20px; background: #fee2e2; border-radius: 30px;">
                            <div style="width: 8px; height: 8px; background: #e74c3c; border-radius: 50%;"></div>
                            <span style="color: #991b1b; font-size: 13px; font-weight: 600; letter-spacing: 1px;">INSPECTION REPORT</span>
                        </div>
                    </div>
                    
                    <!-- íƒ€ì´í‹€ -->
                    <div style="margin-bottom: 35px;">
                        <h1 style="font-size: 48px; font-weight: 800; color: #2c3e50; margin: 0 0 12px 0; line-height: 1.2;">
                            ì‚¬ì „ì ê²€<br/>ë³´ê³ ì„œ
                        </h1>
                        <div style="width: 70px; height: 4px; background: #e74c3c; border-radius: 3px;"></div>
                    </div>
                    
                    <!-- í”„ë¡œì íŠ¸ ì •ë³´ + í‰ë©´ë„ (í‰ë©´ë„ ìœ ë¬´ì— ë”°ë¼ ìë™ ë°°ì¹˜) -->
                    ${projectData.floorplan ? `
                        <!-- í‰ë©´ë„ ìˆìŒ: ê°€ë¡œ ë°°ì¹˜ -->
                        <div style="display: flex; gap: 20px; margin-bottom: 25px;">
                            <!-- ì¢Œì¸¡: í”„ë¡œì íŠ¸ ì •ë³´ ì¹´ë“œ -->
                            <div style="flex: 1; background: #fef2f2; border-left: 4px solid #e74c3c; padding: 25px 25px; border-radius: 0 8px 8px 0;">
                                <div style="display: flex; flex-direction: column; gap: 14px;">
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #6b7280; font-size: 12px; width: 80px; font-weight: 600;">PROJECT</span>
                                        <span style="color: #2c3e50; font-size: 22px; font-weight: 700;">${projectData.apartmentName}</span>
                                    </div>
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #6b7280; font-size: 12px; width: 80px; font-weight: 600;">UNIT</span>
                                        <span style="color: #2c3e50; font-size: 26px; font-weight: 700;">${projectData.dong}ë™ ${projectData.ho}í˜¸</span>
                                    </div>
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #6b7280; font-size: 12px; width: 80px; font-weight: 600;">DATE</span>
                                        <span style="color: #2c3e50; font-size: 16px; font-weight: 500;">${projectData.inspectionDate || '-'}</span>
                                    </div>
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #6b7280; font-size: 12px; width: 80px; font-weight: 600;">CLIENT</span>
                                        <span style="color: #2c3e50; font-size: 16px; font-weight: 500;">${projectData.customerName || '-'}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ìš°ì¸¡: í‰ë©´ë„ -->
                            <div style="flex: 1; border: 2px solid #fee2e2; border-radius: 12px; overflow: hidden; background: #fef2f2; display: flex; align-items: center; justify-content: center;">
                                <img src="${projectData.floorplan}" style="width: 100%; height: 180px; object-fit: contain; background: #ffffff;" />
                            </div>
                        </div>
                    ` : `
                        <!-- í‰ë©´ë„ ì—†ìŒ: í”„ë¡œì íŠ¸ ì •ë³´ë§Œ ì „ì²´ ë„ˆë¹„ -->
                        <div style="margin-bottom: 25px;">
                            <div style="background: #fef2f2; border-left: 4px solid #e74c3c; padding: 30px 35px; border-radius: 0 8px 8px 0;">
                                <div style="display: flex; flex-direction: column; gap: 18px;">
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #6b7280; font-size: 13px; width: 100px; font-weight: 600;">PROJECT</span>
                                        <span style="color: #2c3e50; font-size: 26px; font-weight: 700;">${projectData.apartmentName}</span>
                                    </div>
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #6b7280; font-size: 13px; width: 100px; font-weight: 600;">UNIT</span>
                                        <span style="color: #2c3e50; font-size: 32px; font-weight: 700;">${projectData.dong}ë™ ${projectData.ho}í˜¸</span>
                                    </div>
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #6b7280; font-size: 13px; width: 100px; font-weight: 600;">DATE</span>
                                        <span style="color: #2c3e50; font-size: 20px; font-weight: 500;">${projectData.inspectionDate || '-'}</span>
                                    </div>
                                    <div style="display: flex; align-items: baseline;">
                                        <span style="color: #6b7280; font-size: 13px; width: 100px; font-weight: 600;">CLIENT</span>
                                        <span style="color: #2c3e50; font-size: 20px; font-weight: 500;">${projectData.customerName || '-'}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `}
                    
                    <!-- í•˜ì ìš”ì•½ -->
                    <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 12px; padding: 18px 22px; margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                            <div style="width: 20px; height: 20px; background: #e74c3c; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px;">!</div>
                            <span style="color: #991b1b; font-size: 14px; font-weight: 700;">ì…ì£¼ ì „ ì‚¬ì „ì ê²€ ì™„ë£Œ</span>
                        </div>
                        <p style="color: #b91c1c; font-size: 11px; margin: 0 0 10px 0; line-height: 1.4; padding-left: 30px;">
                            ì „ë¬¸ ì¥ë¹„ë¥¼ í™œìš©í•œ ê¼¼ê¼¼í•œ í•˜ì ì ê²€ìœ¼ë¡œ ì•ˆì‹¬í•˜ê³  ì…ì£¼í•˜ì‹¤ ìˆ˜ ìˆë„ë¡ ë„ì™€ë“œë¦½ë‹ˆë‹¤.
                        </p>
                        <div style="display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #fecaca;">
                            <div style="text-align: center;">
                                <div style="color: #6b7280; font-size: 10px; margin-bottom: 3px; font-weight: 600;">ì´ í•˜ì</div>
                                <div style="color: #e74c3c; font-size: 24px; font-weight: 800;">${projectData.defects.length}</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="color: #6b7280; font-size: 10px; margin-bottom: 3px; font-weight: 600;">ì¦ë¹™ ì‚¬ì§„</div>
                                <div style="color: #dc2626; font-size: 24px; font-weight: 800;">${projectData.defects.filter(d => d.photos && d.photos.length > 0).reduce((sum, d) => sum + d.photos.length, 0)}</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ì ê²€ í•­ëª© -->
                    <div style="padding: 15px 0; border-top: 2px solid #e5e7eb; border-bottom: 2px solid #e5e7eb; margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 5px; height: 5px; background: #e74c3c; border-radius: 50%;"></div>
                            <span style="color: #374151; font-size: 12px; font-weight: 600;">ë²½ì²´ ìˆ˜ì§ ë° ë°”ë‹¥ ìˆ˜í‰ ì ê²€</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <div style="width: 5px; height: 5px; background: #e74c3c; border-radius: 50%;"></div>
                            <span style="color: #374151; font-size: 12px; font-weight: 600;">ì‹¤ë‚´ ê³µê¸°ì§ˆ ì¸¡ì •</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 5px; height: 5px; background: #e74c3c; border-radius: 50%;"></div>
                            <span style="color: #374151; font-size: 12px; font-weight: 600;">ë§ˆê° í’ˆì§ˆ ë° ì‹œê³µ ìƒíƒœ ì ê²€</span>
                        </div>
                    </div>
                    
                    <!-- ì‚¬í›„ ê´€ë¦¬ ì•ˆë‚´ -->
                    <div style="background: #fef9c3; border: 1px solid #fcd34d; border-radius: 8px; padding: 12px 16px; margin-bottom: 15px;">
                        <div style="display: flex; align-items: flex-start; gap: 8px;">
                            <span style="font-size: 14px;">âš ï¸</span>
                            <div>
                                <span style="color: #92400e; font-size: 11px; font-weight: 700;">ì‚¬í›„ ê´€ë¦¬ ì•ˆë‚´</span>
                                <p style="color: #78350f; font-size: 10px; margin: 4px 0 0 0; line-height: 1.5;">
                                    í•˜ìì‚¬í•­ì€ ì¤€ê³µ ì´í›„ì—ë„ ì£¼ê¸°ì ìœ¼ë¡œ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ, í•˜ìë‹´ë³´ì±…ì„ê¸°ê°„ ë‚´ ì •ê¸°ì ì¸ ì ê²€ê³¼ ê´€ë¦¬ë¥¼ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- í•˜ë‹¨ íšŒì‚¬ ì •ë³´ -->
                    <div style="margin-top: auto;">
                        <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                            <div>
                                <h3 style="font-size: 24px; font-weight: 700; color: #2c3e50; margin: 0 0 6px 0;">ë”í™ˆì ê²€</h3>
                                <p style="font-size: 13px; color: #6b7280; margin: 0;">The Home Inspection</p>
                            </div>
                            <div style="text-align: right;">
                                <p style="font-size: 14px; color: #34495e; margin: 5px 0; font-weight: 500;">ğŸ“ 070-8019-1456</p>
                                <p style="font-size: 12px; color: #6b7280; margin: 5px 0;">010-9985-0128</p>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        `;
    }

    window.createDefectListPage = function(startIndex, itemsPerPage=18) {
        // ... (ê¸°ì¡´ ì½”ë“œì™€ ë™ì¼)
        let defectRows = '';
        const defectsToDisplay = projectData.defects.slice(startIndex, startIndex + itemsPerPage);
        defectsToDisplay.forEach((defect, index) => {
            const globalIndex = startIndex + index + 1;
            defectRows += `<tr style="border-bottom:1px solid ${R_THEME.border};"><td style="padding:11px;text-align:center;font-weight:800;color:${R_THEME.primary};border-right:1px solid ${R_THEME.border};">${String(globalIndex).padStart(2,'0')}</td><td style="padding:11px;text-align:center;font-weight:700;color:${R_THEME.dark};border-right:1px solid ${R_THEME.border};">${defect.spaces||'-'}</td><td style="padding:11px;text-align:center;font-weight:600;color:${R_THEME.dark};border-right:1px solid ${R_THEME.border};">${defect.locations||'-'}</td><td style="padding:11px;text-align:center;font-weight:600;color:${R_THEME.dark};border-right:1px solid ${R_THEME.border};">${defect.types||'-'}</td><td style="padding:11px 15px;color:#4b5563;font-weight:500;">${defect.description||'-'}</td></tr>`;
        });
        const totalPages = Math.ceil((projectData.defects.length-12)/18)+1;
        const currentPage = Math.floor((startIndex-12)/18)+2;
        return `<div style="width:794px;min-height:1123px;background:white;font-family:'Malgun Gothic',sans-serif;padding:45px;box-sizing:border-box;position:relative;"><div style="border-bottom:2px solid ${R_THEME.bg};padding-bottom:15px;margin-bottom:25px;display:flex;justify-content:space-between;align-items:center;"><div style="display:flex;align-items:center;gap:10px;"><div style="font-size:20px;font-weight:800;color:${R_THEME.primary};">ë”í™ˆì ê²€</div><div style="height:14px;width:1px;background:${R_THEME.border};"></div><div style="font-size:16px;font-weight:700;color:${R_THEME.dark};">í•˜ì ì ê²€ ë‚´ì—­ ìƒì„¸</div></div><div style="font-size:12px;font-weight:600;color:${R_THEME.light};">${projectData.apartmentName}</div></div><table style="width:100%;border-collapse:collapse;font-size:12px;table-layout:fixed;border:1px solid ${R_THEME.border};"><thead><tr style="background:${R_THEME.bg};border-bottom:1px solid ${R_THEME.border};"><th style="padding:12px;width:50px;font-weight:800;color:${R_THEME.dark};border-right:1px solid ${R_THEME.border};">NO</th><th style="padding:12px;width:100px;font-weight:800;color:${R_THEME.dark};border-right:1px solid ${R_THEME.border};">ê³µê°„</th><th style="padding:12px;width:100px;font-weight:800;color:${R_THEME.dark};border-right:1px solid ${R_THEME.border};">ìœ„ì¹˜</th><th style="padding:12px;width:120px;font-weight:800;color:${R_THEME.dark};border-right:1px solid ${R_THEME.border};">ìœ í˜•</th><th style="padding:12px;text-align:left;font-weight:800;color:${R_THEME.dark};padding-left:15px;">ìƒì„¸ ë‚´ìš©</th></tr></thead><tbody>${defectRows}</tbody></table><div style="position:absolute;bottom:40px;left:45px;right:45px;padding-top:15px;border-top:1px solid ${R_THEME.border};display:flex;justify-content:space-between;align-items:center;color:${R_THEME.light};font-size:11px;"><div style="font-weight:800;">THE HOME INSPECTION</div><div style="font-weight:800;">${R_THEME.contact}</div><div style="font-weight:700;">Page ${currentPage} / ${totalPages}</div></div></div>`;
    }

    window.createDefectDetailPage = async function(defects, startIndex) {
        // ... (ê¸°ì¡´ ì½”ë“œì™€ ë™ì¼)
        let contentHTML = '';
        for (let idx = 0; idx < defects.length; idx++) {
            const defect = defects[idx];
            const globalIndex = startIndex + idx + 1;
            const dongHo = `${projectData.dong}ë™${projectData.ho}í˜¸`;
            const farPhoto = defect.photos && defect.photos[0] ? await window.addWatermarkToPhoto(defect.photos[0], `${dongHo}_${globalIndex}`) : '';
            const closePhoto = defect.photos && defect.photos[1] ? await window.addWatermarkToPhoto(defect.photos[1], `${dongHo}_${globalIndex}-1`) : '';
            const spaces = defect.spaces ? defect.spaces.join(', ') : '-';
            const description = defect.description || '-';
            contentHTML += `<div style="margin-bottom:25px;break-inside:avoid;background:white;border:1px solid ${R_THEME.border};border-radius:8px;overflow:hidden;"><div style="display:flex;align-items:center;padding:10px 15px;background:${R_THEME.bg};border-bottom:1px solid ${R_THEME.border};"><div style="background:${R_THEME.primary};color:white;font-weight:800;font-size:12px;padding:3px 10px;border-radius:20px;margin-right:15px;">#${String(globalIndex).padStart(2,'0')}</div><div style="font-size:15px;font-weight:800;color:${R_THEME.dark};margin-right:12px;">${spaces}</div><div style="color:#cbd5e1;margin-right:12px;">|</div><div style="font-size:13px;color:#4b5563;font-weight:600;flex:1;">${description}</div></div><div style="display:flex;gap:2px;padding:2px;background:${R_THEME.border};"><div style="flex:1;background:white;position:relative;height:210px;">${farPhoto?`<img src="${farPhoto}" style="width:100%;height:100%;object-fit:contain;"/>`:`<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#ccc;font-size:12px;">ì‚¬ì§„ ì—†ìŒ</div>`}<div style="position:absolute;bottom:8px;left:8px;background:rgba(0,0,0,0.7);color:white;font-size:11px;padding:3px 8px;border-radius:4px;font-weight:700;">ì›ê²½</div></div><div style="flex:1;background:white;position:relative;height:210px;">${closePhoto?`<img src="${closePhoto}" style="width:100%;height:100%;object-fit:contain;"/>`:`<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#ccc;font-size:12px;">ì‚¬ì§„ ì—†ìŒ</div>`}<div style="position:absolute;bottom:8px;left:8px;background:${R_THEME.primary};color:white;font-size:11px;padding:3px 8px;border-radius:4px;font-weight:700;">ê·¼ê²½</div></div></div></div>`;
        }
        return `<div style="width:794px;min-height:1123px;background:white;font-family:'Malgun Gothic',sans-serif;padding:45px;box-sizing:border-box;position:relative;"><div style="border-bottom:2px solid ${R_THEME.primary};padding-bottom:15px;margin-bottom:30px;display:flex;justify-content:space-between;align-items:flex-end;"><div style="font-size:22px;font-weight:900;color:${R_THEME.dark};">í•˜ì ìƒì„¸ ë¦¬í¬íŠ¸ (ì‚¬ì§„)</div><div style="font-size:12px;font-weight:700;color:${R_THEME.light};">${projectData.apartmentName}</div></div>${contentHTML}<div style="position:absolute;bottom:40px;left:45px;right:45px;padding-top:15px;border-top:1px solid ${R_THEME.border};display:flex;justify-content:space-between;align-items:center;color:${R_THEME.light};font-size:11px;"><div style="font-weight:800;color:${R_THEME.dark};">THE HOME INSPECTION</div><div style="font-weight:800;color:${R_THEME.dark};">${R_THEME.contact}</div></div></div>`;
    }
// ==========================================================================
    // [ë”í™ˆì ê²€] ì¶”ê°€ íŒ¨ì¹˜ v5.3 (ê°€ì´ë“œë¶ ë””ìì¸ ë¦¬ë‰´ì–¼)
    // - í…ìŠ¤íŠ¸ ìœ„ì£¼ì˜ ê°€ì´ë“œë¥¼ ì´ë¯¸ì§€/ì•„ì´ì½˜ì´ í¬í•¨ëœ ì „ë¬¸ ë¸Œë¡œìŠˆì–´ ìŠ¤íƒ€ì¼ë¡œ ë³€ê²½
    // - SVG ì¼ëŸ¬ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë³„ë„ ì´ë¯¸ì§€ íŒŒì¼ ì—†ì´ë„ ê³ í™”ì§ˆ ì¶œë ¥ ì§€ì›
    // ==========================================================================

    // [ê³µí†µ] ê°€ì´ë“œ í—¤ë” ìƒì„± í•¨ìˆ˜
    function getGuideHeaderHTML(title, iconPath, color) {
        return `
            <div style="display: flex; align-items: center; margin-bottom: 30px; border-bottom: 3px solid ${color}; padding-bottom: 15px;">
                <div style="width: 50px; height: 50px; background: ${color}; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 15px; color: white;">
                    <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        ${iconPath}
                    </svg>
                </div>
                <div>
                    <div style="font-size: 12px; color: ${color}; font-weight: 800; letter-spacing: 1px;">THE HOME GUIDE</div>
                    <div style="font-size: 24px; font-weight: 900; color: #1f2937;">${title}</div>
                </div>
            </div>
        `;
    }

    // 1. [í•˜ìë³´ìˆ˜ ê°€ì´ë“œ] (ì ˆì°¨ + ê¸°ê°„ í†µí•© ë””ìì¸)
    window.createWarrantyGuidePage1 = function() {
        const header = getGuideHeaderHTML("í•˜ìë³´ìˆ˜ ì²­êµ¬ & ë‹´ë³´ì±…ì„ ê°€ì´ë“œ", "M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z", "#ef4444");
        
        return `
            <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 45px; box-sizing: border-box; position: relative;">
                ${header}

                <div style="margin-bottom: 35px;">
                    <h3 style="margin: 0 0 15px 0; font-size: 18px; color: #111827; font-weight: 800;">ğŸ“Œ í•˜ìë³´ìˆ˜ ì²­êµ¬ ì ˆì°¨ (3 Step)</h3>
                    
                    <div style="display: flex; gap: 15px;">
                        <div style="flex: 1; background: #fef2f2; border: 1px solid #fecaca; border-radius: 12px; padding: 20px; position: relative;">
                            <div style="position: absolute; top: -10px; left: 15px; background: #ef4444; color: white; font-size: 12px; font-weight: bold; padding: 4px 10px; border-radius: 20px;">STEP 01</div>
                            <div style="font-size: 16px; font-weight: 800; color: #b91c1c; margin-top: 5px; margin-bottom: 10px;">ê¸°ë¡ ë° ì´¬ì˜</div>
                            <div style="font-size: 12px; color: #4b5563; line-height: 1.6;">
                                ğŸ“¸ <strong>ì‚¬ì§„ ì´¬ì˜ í•„ìˆ˜</strong><br>
                                - ì›ê²½(ìœ„ì¹˜í™•ì¸) + ê·¼ê²½(í•˜ìì‹ë³„)<br>
                                - ì/ë³¼íœ ë“±ìœ¼ë¡œ í¬ê¸° ë¹„êµ<br>
                                ğŸ“ <strong>ë‚´ìš© ê¸°ë¡</strong><br>
                                - ë°œê²¬ ë‚ ì§œ, ìœ„ì¹˜, í˜„ìƒ ë©”ëª¨
                            </div>
                        </div>

                        <div style="flex: 1; background: #fff7ed; border: 1px solid #fed7aa; border-radius: 12px; padding: 20px; position: relative;">
                            <div style="position: absolute; top: -10px; left: 15px; background: #f97316; color: white; font-size: 12px; font-weight: bold; padding: 4px 10px; border-radius: 20px;">STEP 02</div>
                            <div style="font-size: 16px; font-weight: 800; color: #c2410c; margin-top: 5px; margin-bottom: 10px;">ì ‘ìˆ˜ ë° ì‹ ì²­</div>
                            <div style="font-size: 12px; color: #4b5563; line-height: 1.6;">
                                ğŸ¢ <strong>ì ‘ìˆ˜ì²˜</strong><br>
                                - ì…ì£¼ì§€ì›ì„¼í„° / ê´€ë¦¬ì‚¬ë¬´ì†Œ<br>
                                - ì‹œê³µì‚¬ ëª¨ë°”ì¼ ì•±<br>
                                ğŸ“‚ <strong>ì œì¶œ ì„œë¥˜</strong><br>
                                - í•˜ìë³´ìˆ˜ ì‹ ì²­ì„œ, ì‚¬ì§„ìë£Œ
                            </div>
                        </div>

                        <div style="flex: 1; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 12px; padding: 20px; position: relative;">
                            <div style="position: absolute; top: -10px; left: 15px; background: #22c55e; color: white; font-size: 12px; font-weight: bold; padding: 4px 10px; border-radius: 20px;">STEP 03</div>
                            <div style="font-size: 16px; font-weight: 800; color: #15803d; margin-top: 5px; margin-bottom: 10px;">ë³´ìˆ˜ ë° í™•ì¸</div>
                            <div style="font-size: 12px; color: #4b5563; line-height: 1.6;">
                                ğŸ› ï¸ <strong>ë³´ìˆ˜ ê³µì‚¬</strong><br>
                                - ì‹œê³µì‚¬ ë°©ë¬¸ ì¼ì • í˜‘ì˜<br>
                                - ë³´ìˆ˜ ì‘ì—… ì§„í–‰<br>
                                âœ… <strong>ìµœì¢… í™•ì¸</strong><br>
                                - ë³´ìˆ˜ ì™„ë£Œ í™•ì¸ì„œ ì„œëª…
                            </div>
                        </div>
                    </div>
                </div>

                <div style="background: #f9fafb; border-radius: 16px; padding: 25px; border: 1px solid #e5e7eb;">
                    <h3 style="margin: 0 0 20px 0; font-size: 18px; color: #111827; font-weight: 800;">â° ì£¼ìš” í•˜ì ë‹´ë³´ì±…ì„ ê¸°ê°„ (ê³µë™ì£¼íƒê´€ë¦¬ë²•)</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                        <div style="background: white; border-radius: 10px; padding: 15px; text-align: center; border: 1px solid #e5e7eb; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="font-size: 32px; font-weight: 900; color: #3b82f6; margin-bottom: 5px;">2<span style="font-size: 16px;">ë…„</span></div>
                            <div style="font-size: 14px; font-weight: 800; color: #1f2937; margin-bottom: 8px;">ë§ˆê° ê³µì‚¬</div>
                            <div style="font-size: 11px; color: #6b7280; line-height: 1.4;">
                                ë„ë°°, íƒ€ì¼, ì£¼ë°©ê°€êµ¬,<br>ìˆ˜ì „, ì°½í˜¸, ë„ì¥ ë“±<br><strong>(ëˆˆì— ë³´ì´ëŠ” ë§ˆê°ì¬)</strong>
                            </div>
                        </div>

                        <div style="background: white; border-radius: 10px; padding: 15px; text-align: center; border: 1px solid #e5e7eb; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="font-size: 32px; font-weight: 900; color: #f59e0b; margin-bottom: 5px;">3<span style="font-size: 16px;">ë…„</span></div>
                            <div style="font-size: 14px; font-weight: 800; color: #1f2937; margin-bottom: 8px;">ê¸°ëŠ¥ ì„¤ë¹„</div>
                            <div style="font-size: 11px; color: #6b7280; line-height: 1.4;">
                                ë‚œë°©, ê°€ìŠ¤, ì „ê¸°, ë°°ê´€,<br>ì†Œë°©, í™˜ê¸° ì„¤ë¹„ ë“±<br><strong>(ê¸°ëŠ¥ì  ì¤‘ìš” ì„¤ë¹„)</strong>
                            </div>
                        </div>

                         <div style="background: white; border-radius: 10px; padding: 15px; text-align: center; border: 1px solid #e5e7eb; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div style="font-size: 32px; font-weight: 900; color: #ef4444; margin-bottom: 5px;">5<span style="font-size: 16px;">ë…„~</span></div>
                            <div style="font-size: 14px; font-weight: 800; color: #1f2937; margin-bottom: 8px;">êµ¬ì¡° ì•ˆì „</div>
                            <div style="font-size: 11px; color: #6b7280; line-height: 1.4;">
                                ì² ê·¼, ì½˜í¬ë¦¬íŠ¸, ì§€ë¶•,<br>ë°©ìˆ˜, ì¡°ì  ë“±<br><strong>(ê±´ë¬¼ êµ¬ì¡° ì•ˆì „)</strong>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; font-size: 11px; color: #6b7280; background: #e5e7eb; padding: 10px; border-radius: 6px;">
                        ğŸ’¡ <strong>Tip:</strong> ì…ì£¼ ì´ˆê¸°ì— ë°œê²¬ëœ í•˜ìëŠ” ê°€ëŠ¥í•œ ë¹¨ë¦¬ ì ‘ìˆ˜í•´ì•¼ ë¶„ìŸì„ í”¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 2ë…„ ì°¨ í•˜ìëŠ” ê¸°ê°„ ë§Œë£Œ ì „ ì¼ê´„ ì ‘ìˆ˜í•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.
                    </div>
                </div>

                <div style="position: absolute; bottom: 40px; left: 45px; right: 45px; border-top: 1px solid #e5e7eb; padding-top: 15px; display: flex; justify-content: space-between; align-items: center; font-size: 10px; color: #9ca3af;">
                    <div style="font-weight: 700;">THE HOME INSPECTION GUIDE</div>
                    <div>ë”í™ˆì ê²€</div>
                </div>
            </div>
        `;
    }

    // 2. [ì‹¤ë‚´ê³µê¸°ì§ˆ ê°€ì´ë“œ] (ë² ì´í¬ì•„ì›ƒ ì¸í¬ê·¸ë˜í”½)
    window.createAirQualityManagementGuidePage = function() {
        const header = getGuideHeaderHTML("ìƒˆì§‘ì¦í›„êµ° & ê³µê¸°ì§ˆ ê´€ë¦¬", "M3.055 11H5a2 2 0 0 1 2 2v1a2 2 0 0 0 2 2 2 2 0 0 1 2 2v2.945M8 3.935V5.5A2.5 2.5 0 0 0 10.5 8h.5a2 2 0 0 1 2 2 2 2 0 0 0 2 2h.455M18 6a3 3 0 0 0-3-3H4a3 3 0 0 0-3 3v15a3 3 0 0 0 3 3h13a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3z", "#10b981");

        return `
            <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 45px; box-sizing: border-box; position: relative;">
                ${header}

                <div style="border: 2px solid #10b981; border-radius: 16px; padding: 0; overflow: hidden; margin-bottom: 30px;">
                    <div style="background: #10b981; color: white; padding: 12px 20px; font-weight: 800; font-size: 16px;">
                        ğŸ”¥ ë² ì´í¬ì•„ì›ƒ (Bake-Out) í‘œì¤€ ë ˆì‹œí”¼
                    </div>
                    <div style="padding: 25px;">
                        <div style="display: flex; align-items: center; margin-bottom: 20px;">
                            <div style="font-size: 40px; margin-right: 20px;">ğŸŒ¡ï¸</div>
                            <div>
                                <div style="font-weight: 800; font-size: 14px; color: #1f2937; margin-bottom: 5px;">ì‹¤ë‚´ ìœ í•´ë¬¼ì§ˆ ì œê±°ì˜ í•µì‹¬</div>
                                <div style="font-size: 12px; color: #4b5563;">
                                    ë‚œë°©ì„ í†µí•´ ì‹¤ë‚´ ì˜¨ë„ë¥¼ ë†’ì—¬ ê±´ì¶• ìì¬ ì†ì˜ ìœ í•´ë¬¼ì§ˆ(í¬ë¦„ì•Œë°íˆë“œ ë“±)ì„ ê°•ì œë¡œ ë°°ì¶œì‹œí‚¤ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.
                                </div>
                            </div>
                        </div>

                        <div style="display: flex; justify-content: space-between; gap: 10px; text-align: center;">
                            <div style="flex: 1; background: #f0fdf4; padding: 15px 10px; border-radius: 8px;">
                                <div style="font-size: 24px; margin-bottom: 10px;">ğŸªŸâŒ</div>
                                <div style="font-weight: 800; font-size: 13px; color: #166534;">1. ë°€í</div>
                                <div style="font-size: 11px; color: #166534; margin-top: 5px;">ì°½ë¬¸ ëª¨ë‘ ë‹«ê¸°<br>ìˆ˜ë‚©ì¥ ë¬¸ ì—´ê¸°</div>
                            </div>
                            <div style="display: flex; align-items: center; color: #cbd5e1;">â–¶</div>
                            <div style="flex: 1; background: #fef2f2; padding: 15px 10px; border-radius: 8px;">
                                <div style="font-size: 24px; margin-bottom: 10px;">ğŸ”¥ğŸ“ˆ</div>
                                <div style="font-weight: 800; font-size: 13px; color: #991b1b;">2. ê°€ì—´</div>
                                <div style="font-size: 11px; color: #991b1b; margin-top: 5px;">35~40â„ƒ ìœ ì§€<br>6~10ì‹œê°„ ì§€ì†</div>
                            </div>
                            <div style="display: flex; align-items: center; color: #cbd5e1;">â–¶</div>
                            <div style="flex: 1; background: #eff6ff; padding: 15px 10px; border-radius: 8px;">
                                <div style="font-size: 24px; margin-bottom: 10px;">ğŸŒ¬ï¸âœ…</div>
                                <div style="font-weight: 800; font-size: 13px; color: #1e40af;">3. í™˜ê¸°</div>
                                <div style="font-size: 11px; color: #1e40af; margin-top: 5px;">ëª¨ë“  ë¬¸ ì—´ê¸°<br>1~2ì‹œê°„ í™˜ê¸°</div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 15px; font-size: 12px; font-weight: 700; color: #10b981; background: #ecfdf5; padding: 8px; border-radius: 20px;">
                            ğŸ”„ ìœ„ ê³¼ì •ì„ ìµœì†Œ 3íšŒ ì´ìƒ ë°˜ë³µí•´ì£¼ì„¸ìš”!
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <h3 style="margin: 0 0 15px 0; font-size: 18px; color: #111827; font-weight: 800;">ğŸ“Š ì‹¤ë‚´ê³µê¸°ì§ˆ ê´€ë¦¬ë²• ê¶Œê³ ê¸°ì¤€ (ì‹ ì¶• ê³µë™ì£¼íƒ)</h3>
                    <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                        <thead style="background: #1f2937; color: white;">
                            <tr>
                                <th style="padding: 12px; border-top-left-radius: 8px;">ë¬¼ì§ˆëª…</th>
                                <th style="padding: 12px;">ê¸°ì¤€ì¹˜</th>
                                <th style="padding: 12px; border-top-right-radius: 8px;">ì¸ì²´ ì˜í–¥</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid #e5e7eb;">
                                <td style="padding: 12px; text-align: center; font-weight: 800; color: #374151;">ë¼ëˆ (Rn)</td>
                                <td style="padding: 12px; text-align: center; color: #ef4444; font-weight: 800;">148 Bq/mÂ³ ì´í•˜</td>
                                <td style="padding: 12px; color: #4b5563; font-size: 12px;">íì•” ìœ ë°œ (1ê¸‰ ë°œì•”ë¬¼ì§ˆ)</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #e5e7eb; background: #f9fafb;">
                                <td style="padding: 12px; text-align: center; font-weight: 800; color: #374151;">í¬ë¦„ì•Œë°íˆë“œ</td>
                                <td style="padding: 12px; text-align: center; color: #ef4444; font-weight: 800;">0.21 mg/mÂ³ ì´í•˜</td>
                                <td style="padding: 12px; color: #4b5563; font-size: 12px;">ëˆˆ/ì½”/ëª© ìê·¹, ì•Œë ˆë¥´ê¸°</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #e5e7eb;">
                                <td style="padding: 12px; text-align: center; font-weight: 800; color: #374151;">ì´íœ˜ë°œì„±ìœ ê¸°í™”í•©ë¬¼</td>
                                <td style="padding: 12px; text-align: center; color: #ef4444; font-weight: 800;">0.5 mg/mÂ³ ì´í•˜</td>
                                <td style="padding: 12px; color: #4b5563; font-size: 12px;">ë‘í†µ, í˜„ê¸°ì¦, í”¼ë¡œê°</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="position: absolute; bottom: 40px; left: 45px; right: 45px; border-top: 1px solid #e5e7eb; padding-top: 15px; display: flex; justify-content: space-between; align-items: center; font-size: 10px; color: #9ca3af;">
                    <div style="font-weight: 700;">THE HOME INSPECTION GUIDE</div>
                    <div>ë”í™ˆì ê²€</div>
                </div>
            </div>
        `;
    }

    // 3. [ê²°ë¡œ ì˜ˆë°© ê°€ì´ë“œ] (ë¬¼ë°©ìš¸ í…Œë§ˆ)
    window.createCondensationGuidePage = function() {
        const header = getGuideHeaderHTML("ê²°ë¡œ(ì´ìŠ¬ë§ºí˜) ì˜ˆë°© ê°€ì´ë“œ", "M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z", "#3b82f6");

        return `
             <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 45px; box-sizing: border-box; position: relative;">
                ${header}

                <div style="background: #eff6ff; border-radius: 12px; padding: 25px; margin-bottom: 30px; border-left: 5px solid #3b82f6;">
                    <h3 style="margin: 0 0 10px 0; font-size: 18px; color: #1e40af;">ğŸ’§ ê²°ë¡œë€?</h3>
                    <p style="margin: 0; font-size: 13px; color: #374151; line-height: 1.6;">
                        ì‹¤ë‚´ì™¸ ì˜¨ë„ ì°¨ì´ê°€ ì‹¬í•  ë•Œ, ì‹¤ë‚´ì˜ ë”°ëœ»í•˜ê³  ìŠµí•œ ê³µê¸°ê°€ ì°¨ê°€ìš´ ë²½ë©´ì´ë‚˜ ì°½ë¬¸ì— ë‹¿ì•„ ë¬¼ë°©ìš¸ë¡œ ë³€í•˜ëŠ” í˜„ìƒì…ë‹ˆë‹¤. ë°©ì¹˜í•˜ë©´ <strong>ê³°íŒ¡ì´ì˜ ì›ì¸</strong>ì´ ë©ë‹ˆë‹¤.
                    </p>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                    <div style="border: 1px solid #e5e7eb; border-radius: 12px; overflow: hidden;">
                        <div style="background: #3b82f6; color: white; padding: 12px; font-weight: 800; text-align: center;">âœ… ì˜ˆë°© ìƒí™œ ìˆ˜ì¹™</div>
                        <div style="padding: 20px;">
                            <ul style="margin: 0; padding-left: 20px; font-size: 13px; color: #374151; line-height: 2.2;">
                                <li><strong>í™˜ê¸°:</strong> í•˜ë£¨ 2íšŒ ì´ìƒ, 10ë¶„ì”© ì°½ë¬¸ ì—´ê¸°</li>
                                <li><strong>ë¹¨ë˜:</strong> ì‹¤ë‚´ ê±´ì¡° ìì œ (ì œìŠµê¸° ì‚¬ìš© ê¶Œì¥)</li>
                                <li><strong>ê°€êµ¬:</strong> ì™¸ë²½ê³¼ 5cm ì´ìƒ ë„ì›Œì„œ ë°°ì¹˜</li>
                                <li><strong>ìš”ë¦¬/ìƒ¤ì›Œ:</strong> í™˜í’ê¸° ë°˜ë“œì‹œ ê°€ë™</li>
                            </ul>
                        </div>
                    </div>

                    <div style="border: 1px solid #e5e7eb; border-radius: 12px; overflow: hidden;">
                        <div style="background: #60a5fa; color: white; padding: 12px; font-weight: 800; text-align: center;">ğŸŒ¡ï¸ ì ì • ì‹¤ë‚´ í™˜ê²½</div>
                        <div style="padding: 20px; display: flex; flex-direction: column; justify-content: center; height: 100%; box-sizing: border-box;">
                            <div style="margin-bottom: 20px; text-align: center;">
                                <div style="font-size: 30px;">ğŸŒ¡ï¸</div>
                                <div style="font-weight: 800; color: #1f2937;">ì˜¨ë„: 20 ~ 22â„ƒ</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 30px;">ğŸ’§</div>
                                <div style="font-weight: 800; color: #1f2937;">ìŠµë„: 40 ~ 60%</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="background: #fff7ed; border: 1px solid #fdba74; border-radius: 12px; padding: 20px;">
                    <h3 style="margin: 0 0 15px 0; font-size: 16px; color: #c2410c;">ğŸš¨ ê²°ë¡œ ë°œìƒ ì‹œ ëŒ€ì²˜ë²•</h3>
                    <div style="display: flex; gap: 15px;">
                        <div style="flex: 1; background: white; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #fed7aa;">
                            <div style="font-weight: 800; color: #ea580c; margin-bottom: 5px;">1. ë‹¦ì•„ë‚´ê¸°</div>
                            <div style="font-size: 11px; color: #4b5563;">ë§ˆë¥¸ ìˆ˜ê±´ìœ¼ë¡œ ë¬¼ê¸° ì¦‰ì‹œ ì œê±°</div>
                        </div>
                        <div style="flex: 1; background: white; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #fed7aa;">
                            <div style="font-weight: 800; color: #ea580c; margin-bottom: 5px;">2. ê±´ì¡°í•˜ê¸°</div>
                            <div style="font-size: 11px; color: #4b5563;">í—¤ì–´ë“œë¼ì´ì–´, ì„ í’ê¸°ë¡œ ë§ë¦¬ê¸°</div>
                        </div>
                        <div style="flex: 1; background: white; padding: 15px; border-radius: 8px; text-align: center; border: 1px solid #fed7aa;">
                            <div style="font-weight: 800; color: #ea580c; margin-bottom: 5px;">3. ì œê±°í•˜ê¸°</div>
                            <div style="font-size: 11px; color: #4b5563;">ê³°íŒ¡ì´ëŠ” ì•Œì½”ì˜¬/ë½ìŠ¤ë¡œ ë‹¦ê¸°</div>
                        </div>
                    </div>
                </div>

                <div style="position: absolute; bottom: 40px; left: 45px; right: 45px; border-top: 1px solid #e5e7eb; padding-top: 15px; display: flex; justify-content: space-between; align-items: center; font-size: 10px; color: #9ca3af;">
                    <div style="font-weight: 700;">THE HOME INSPECTION GUIDE</div>
                    <div>ë”í™ˆì ê²€</div>
                </div>
            </div>
        `;
    }

    // [ì°¸ê³ ] createSummaryFirstPage, createDefectListPage, createDefectDetailPage, createEquipmentPageëŠ” 
    // ì´ì „ v5.1 íŒ¨ì¹˜ì— ìˆëŠ” ì½”ë“œê°€ ê·¸ëŒ€ë¡œ ìœ ì§€ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
    // (ì´ ì½”ë“œ ë¸”ë¡ì€ ê°€ì´ë“œ í˜ì´ì§€ ì¶”ê°€ìš©ì´ë¯€ë¡œ, ë§Œì•½ ì•ì„  v5.1 íŒ¨ì¹˜ë¥¼ ì§€ìš°ì…¨ë‹¤ë©´ 
    // v5.1 íŒ¨ì¹˜ ì½”ë“œ + ì´ ì½”ë“œ ë‚´ìš©ì„ í•©ì³ì„œ ë„£ìœ¼ì…”ì•¼ í•©ë‹ˆë‹¤.)
    </script>
</body>
</html>