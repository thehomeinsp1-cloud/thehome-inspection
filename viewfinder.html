<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0A1628">
    <meta name="google" content="notranslate">
    <title>Î∑∞ÌååÏù∏Îçî | Ïä§ÎßàÌä∏ ÏÖÄÌîÑ ÌôàÏ≤¥ÌÅ¨</title>
    
    <!-- Pretendard Ìè∞Ìä∏ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css">
    
    <!-- jsPDF + html2canvas for PDF ÏÉùÏÑ± -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        :root {
            /* Î∑∞ÌååÏù∏Îçî Î∏åÎûúÎìú Ïª¨Îü¨ */
            --primary: #0A1628;
            --primary-light: #1A2D4A;
            --accent: #00D4AA;
            --accent-glow: rgba(0, 212, 170, 0.3);
            --warning: #FF6B6B;
            --success: #00D4AA;
            --text: #FFFFFF;
            --text-muted: #8892A0;
            --card-bg: rgba(26, 45, 74, 0.6);
            --card-border: rgba(0, 212, 170, 0.2);
            --overlay: rgba(10, 22, 40, 0.95);
            
            /* ÏÇ¨Ïù¥Ï¶à */
            --header-height: 60px;
            --nav-height: 70px;
            --radius: 16px;
            --radius-sm: 10px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--primary);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ==================== Î∞∞Í≤Ω Ìö®Í≥º ==================== */
        .bg-gradient {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(ellipse at 20% 0%, rgba(0, 212, 170, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 100%, rgba(0, 100, 200, 0.1) 0%, transparent 50%),
                var(--primary);
            z-index: -1;
        }

        /* ==================== Ìó§Îçî ==================== */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            background: rgba(10, 22, 40, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 100;
            border-bottom: 1px solid var(--card-border);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--accent), #00A080);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent), #00FFD4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .tier-badge {
            padding: 6px 12px;
            background: var(--card-bg);
            border: 1px solid var(--accent);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: var(--accent);
        }

        /* ==================== Î©îÏù∏ Ïª®ÌÖêÏ∏† ==================== */
        .main-content {
            padding-top: calc(var(--header-height) + 20px);
            padding-bottom: calc(var(--nav-height) + 30px);
            padding-left: 20px;
            padding-right: 20px;
            max-width: 500px;
            margin: 0 auto;
        }

        /* ==================== ÏÑπÏÖò ==================== */
        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ==================== Ìôà ÏÑπÏÖò ==================== */
        .welcome-card {
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }

        .welcome-card.compact {
            padding: 14px 20px;
            margin-bottom: 16px;
            text-align: center;
            background: linear-gradient(135deg, var(--accent), #00A080);
            border: none;
        }

        .welcome-card.compact .welcome-subtitle {
            margin-bottom: 2px;
            font-size: 12px;
            color: rgba(10, 22, 40, 0.7);
        }

        .welcome-card.compact .welcome-title {
            font-size: 20px;
            margin: 0;
            color: var(--primary);
        }

        .welcome-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, var(--accent-glow) 0%, transparent 70%);
            opacity: 0.5;
        }

        .welcome-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            position: relative;
        }

        .welcome-subtitle {
            color: var(--text-muted);
            font-size: 14px;
            position: relative;
        }

        .progress-section {
            margin-bottom: 24px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-title {
            font-size: 16px;
            font-weight: 600;
        }

        .progress-percent {
            color: var(--accent);
            font-weight: 700;
        }

        .progress-bar {
            height: 8px;
            background: var(--primary-light);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), #00FFD4);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .action-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-card:hover, .action-card:active {
            transform: translateY(-2px);
            border-color: var(--accent);
            box-shadow: 0 8px 30px var(--accent-glow);
        }

        .action-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 12px;
            background: linear-gradient(135deg, var(--accent), #00A080);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .action-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .action-desc {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* ==================== Í∞ÄÍ≤©Ìëú ÏÑπÏÖò ==================== */
        .pricing-section {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 20px;
            margin-top: 24px;
        }

        .pricing-header {
            text-align: center;
            margin-bottom: 16px;
        }

        .pricing-title {
            display: block;
            font-size: 16px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 4px;
        }

        .pricing-subtitle {
            font-size: 12px;
            color: var(--text-muted);
        }

        .pricing-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 16px;
        }

        .pricing-card {
            background: var(--primary-light);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            padding: 14px 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .pricing-card:active {
            transform: scale(0.98);
        }

        .pricing-card.current {
            border-color: var(--accent);
            background: rgba(0, 212, 170, 0.1);
            cursor: default;
        }

        .pricing-card.popular {
            border-color: #FFB800;
            background: rgba(255, 184, 0, 0.1);
        }

        .pricing-badge {
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            padding: 2px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 700;
            white-space: nowrap;
        }

        .pricing-card.current .pricing-badge {
            background: var(--accent);
            color: var(--primary);
        }

        .pricing-card.popular .pricing-badge {
            background: #FFB800;
            color: var(--primary);
        }

        .pricing-name {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 6px;
            margin-top: 4px;
        }

        .pricing-card.current .pricing-name {
            color: var(--accent);
        }

        .pricing-card.popular .pricing-name {
            color: #FFB800;
        }

        .pricing-price {
            font-size: 24px;
            font-weight: 800;
            color: var(--text);
            margin-bottom: 4px;
        }

        .pricing-price span {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-muted);
        }

        .pricing-desc {
            font-size: 11px;
            color: var(--text-muted);
            line-height: 1.4;
        }

        .pricing-extra {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px dashed var(--card-border);
            font-size: 10px;
            color: var(--accent);
            font-weight: 500;
        }

        .pricing-contact {
            text-align: center;
            font-size: 12px;
            color: var(--text-muted);
            padding-top: 12px;
            border-top: 1px solid var(--card-border);
        }

        .pricing-contact a {
            color: var(--accent);
            text-decoration: none;
            font-weight: 600;
        }

        /* Ïï†ÎìúÏò® ÏÑπÏÖò */
        .addon-section {
            margin-top: 16px;
            padding: 14px;
            background: rgba(0, 212, 170, 0.08);
            border: 1px dashed var(--accent);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .addon-section:active {
            transform: scale(0.98);
            background: rgba(0, 212, 170, 0.15);
        }

        .addon-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .addon-badge {
            padding: 2px 6px;
            background: var(--accent);
            border-radius: 4px;
            font-size: 9px;
            font-weight: 700;
            color: var(--primary);
        }

        .addon-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text);
        }

        .addon-desc {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 10px;
        }

        .addon-prices {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .addon-price {
            padding: 4px 8px;
            background: var(--primary-light);
            border-radius: 6px;
            font-size: 10px;
            color: var(--text-muted);
        }

        .addon-price b {
            color: var(--accent);
            font-weight: 700;
        }

        /* ==================== ÌîÑÎ°úÏ†ùÌä∏ Ï†ïÎ≥¥ Ïπ¥Îìú ==================== */
        .project-info-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 20px;
        }

        .project-info-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 14px;
        }

        .project-info-icon {
            font-size: 18px;
        }

        .project-info-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent);
        }

        .project-info-form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .project-input {
            padding: 12px 14px;
            background: var(--primary-light);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            color: var(--text);
            font-size: 14px;
            font-family: inherit;
            box-sizing: border-box;
        }

        .project-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .project-input::placeholder {
            color: var(--text-muted);
        }

        .project-input.full {
            width: 100%;
        }

        .project-input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .project-input-row .project-input {
            width: 100%;
            box-sizing: border-box;
        }

        /* ==================== Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ ==================== */
        .checklist-spaces {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .checklist-space-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checklist-space-card:active {
            transform: scale(0.98);
        }

        .checklist-space-card.completed {
            border-color: var(--accent);
            opacity: 0.7;
        }

        .checklist-space-icon {
            width: 44px;
            height: 44px;
            background: var(--primary-light);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
        }

        .checklist-space-info {
            flex: 1;
        }

        .checklist-space-name {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .checklist-space-status {
            font-size: 12px;
            color: var(--text-muted);
        }

        .checklist-space-arrow {
            color: var(--text-muted);
            font-size: 18px;
        }

        .checklist-detail-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .checklist-detail-header h2 {
            flex: 1;
            font-size: 20px;
            font-weight: 700;
        }

        .back-btn {
            width: 40px;
            height: 40px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            color: var(--text);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checklist-progress {
            padding: 6px 12px;
            background: var(--accent);
            border-radius: 12px;
            font-size: 13px;
            font-weight: 600;
            color: var(--primary);
        }

        .checklist-item {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius-sm);
            padding: 14px;
            margin-bottom: 10px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .checklist-item.checked {
            border-color: var(--accent);
            opacity: 0.6;
        }

        .checklist-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--text-muted);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .checklist-item.checked .checklist-checkbox {
            background: var(--accent);
            border-color: var(--accent);
            color: var(--primary);
        }

        .checklist-item-content {
            flex: 1;
        }

        .checklist-item-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .checklist-item-desc {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.5;
        }

        .checklist-item-tip {
            margin-top: 8px;
            padding: 8px 10px;
            background: rgba(0, 212, 170, 0.1);
            border-radius: 6px;
            font-size: 11px;
            color: var(--accent);
        }

        /* ==================== ÌïòÏûêÏ†êÍ≤Ä ÏãúÏûë Î≤ÑÌäº ==================== */
        .start-inspection-btn {
            display: flex;
            align-items: center;
            gap: 16px;
            background: linear-gradient(135deg, var(--accent), #00A080);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .start-inspection-btn:active {
            transform: scale(0.98);
        }

        .start-inspection-icon {
            width: 56px;
            height: 56px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
        }

        .start-inspection-content {
            flex: 1;
        }

        .start-inspection-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 4px;
        }

        .start-inspection-desc {
            font-size: 13px;
            color: rgba(10, 22, 40, 0.7);
        }

        .start-inspection-arrow {
            font-size: 24px;
            color: var(--primary);
            font-weight: 700;
        }

        /* ==================== Ï†êÍ≤Ä Ìó§Îçî ==================== */
        .inspection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .inspection-count {
            padding: 8px 16px;
            background: var(--accent);
            border-radius: 20px;
            font-size: 16px;
            font-weight: 700;
            color: var(--primary);
        }

        /* ==================== ÌïòÏûê Í∏∞Î°ù ÏÑπÏÖò ==================== */
        .defect-list {
            margin-bottom: 24px;
        }

        .defect-empty {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .defect-empty-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .defect-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 14px;
            margin-bottom: 12px;
            position: relative;
        }

        .defect-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-right: 36px;
        }

        .defect-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: var(--accent);
            color: var(--primary);
            border-radius: 50%;
            font-size: 12px;
            font-weight: 700;
            margin-right: 8px;
        }

        .defect-location {
            font-size: 14px;
            font-weight: 600;
            flex: 1;
        }

        .defect-type {
            padding: 4px 8px;
            background: rgba(255, 184, 0, 0.2);
            color: #FFB800;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        .defect-photos {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }

        .defect-photo {
            width: 70px;
            height: 70px;
            background: var(--primary-light);
            border-radius: 8px;
            object-fit: cover;
        }

        .defect-desc {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.4;
        }

        .defect-delete-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 32px;
            height: 32px;
            background: rgba(255, 107, 107, 0.15);
            border: none;
            border-radius: 8px;
            color: var(--warning);
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
        }

        .defect-delete-btn:active {
            background: rgba(255, 107, 107, 0.3);
            transform: scale(0.95);
        }

        .add-defect-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent), #00A080);
            border: none;
            border-radius: var(--radius);
            color: var(--primary);
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .add-defect-btn:active {
            transform: scale(0.98);
            opacity: 0.9;
        }

        /* ==================== ÌïòÎã® ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ==================== */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--nav-height);
            background: rgba(10, 22, 40, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid var(--card-border);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 0 10px;
            padding-bottom: env(safe-area-inset-bottom);
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            cursor: pointer;
            opacity: 0.6;
            transition: all 0.3s ease;
        }

        .nav-item.active {
            opacity: 1;
        }

        .nav-item.active .nav-icon {
            color: var(--accent);
        }

        .nav-icon {
            font-size: 24px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }

        /* ==================== ÌïòÏûê Îì±Î°ù Ï†ÑÏ≤¥ ÌôîÎ©¥ ==================== */
        .defect-register-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--primary);
            z-index: 1000;
            display: none;
            flex-direction: column;
            overflow: hidden;
        }

        .defect-register-screen.active {
            display: flex;
        }

        .defect-register-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 20px;
            background: rgba(10, 22, 40, 0.95);
            border-bottom: 1px solid var(--card-border);
        }

        .defect-register-title {
            font-size: 18px;
            font-weight: 700;
        }

        .defect-register-close {
            width: 36px;
            height: 36px;
            background: var(--card-bg);
            border: none;
            border-radius: 10px;
            color: var(--text);
            font-size: 18px;
            cursor: pointer;
        }

        .defect-register-body {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            padding-bottom: 120px;
        }

        .defect-register-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 16px 20px;
            padding-bottom: calc(16px + env(safe-area-inset-bottom));
            background: rgba(10, 22, 40, 0.98);
            border-top: 1px solid var(--card-border);
            z-index: 1001;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        /* ==================== Ìèº ÏöîÏÜå ==================== */
        .form-section {
            margin-bottom: 24px;
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--accent);
        }

        .form-label-icon {
            font-size: 18px;
        }

        .form-sublabel {
            font-size: 12px;
            color: var(--text-muted);
            font-weight: 400;
            margin-left: auto;
        }

        /* ==================== ÏÇ¨ÏßÑ Ï¥¨ÏòÅ ÏòÅÏó≠ ==================== */
        .photo-capture-area {
            display: flex;
            gap: 10px;
            margin-bottom: 8px;
        }

        .photo-capture-box {
            flex: 1;
            aspect-ratio: 5/4;
            background: var(--card-bg);
            border: 2px dashed var(--card-border);
            border-radius: var(--radius-sm);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            padding: 12px;
        }

        .photo-capture-box:active {
            transform: scale(0.98);
        }

        .photo-capture-box.far {
            border-color: var(--accent);
        }

        .photo-capture-box.near {
            border-color: #FFB800;
        }

        .photo-capture-box.has-photo {
            border-style: solid;
        }

        .photo-capture-box.has-photo.far {
            border-color: var(--accent);
        }

        .photo-capture-box.has-photo.near {
            border-color: #FFB800;
        }

        .photo-capture-icon {
            font-size: 28px;
            margin-bottom: 6px;
            opacity: 0.7;
        }

        .photo-capture-label {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .photo-capture-sublabel {
            font-size: 10px;
            color: var(--text-muted);
        }

        .photo-capture-box.far .photo-capture-label {
            color: var(--accent);
        }

        .photo-capture-box.near .photo-capture-label {
            color: #FFB800;
        }

        .photo-preview {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-retake-btn {
            position: absolute;
            bottom: 8px;
            right: 8px;
            padding: 6px 12px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 12px;
            cursor: pointer;
        }

        .photo-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 700;
        }

        .photo-badge.far {
            background: var(--accent);
            color: var(--primary);
        }

        .photo-badge.near {
            background: #FFB800;
            color: var(--primary);
        }

        /* ==================== ÌÑ∞Ïπò Î≤ÑÌäº Í∑∏Î¶¨Îìú ==================== */
        .touch-btn-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .touch-btn {
            padding: 12px 16px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            color: var(--text);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .touch-btn:active {
            transform: scale(0.95);
        }

        .touch-btn.selected {
            background: var(--accent);
            border-color: var(--accent);
            color: var(--primary);
            font-weight: 700;
        }

        .touch-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .selected-count {
            font-size: 12px;
            color: var(--accent);
            margin-left: auto;
        }

        /* ==================== ÏùåÏÑ± ÏûÖÎ†• ÏòÅÏó≠ ==================== */
        .voice-input-area {
            position: relative;
        }

        .voice-textarea {
            width: 100%;
            min-height: 100px;
            padding: 14px;
            padding-right: 60px;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            color: var(--text);
            font-size: 14px;
            line-height: 1.6;
            resize: none;
            font-family: inherit;
        }

        .voice-textarea::placeholder {
            color: var(--text-muted);
        }

        .voice-textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .voice-hint {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 8px;
            padding: 8px 12px;
            background: var(--primary-light);
            border-radius: 6px;
        }

        /* ==================== Ï†ÄÏû• Î≤ÑÌäº ==================== */
        .save-defect-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent), #00A080);
            border: none;
            border-radius: var(--radius);
            color: var(--primary);
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .save-defect-btn:active {
            transform: scale(0.98);
            opacity: 0.9;
        }

        .save-defect-btn:disabled {
            background: var(--card-bg);
            color: var(--text-muted);
            cursor: not-allowed;
        }

        /* ==================== Ïπ¥Î©îÎùº Î™®Îã¨ ==================== */
        .camera-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: black;
            z-index: 2000;
            display: none;
            flex-direction: column;
        }

        .camera-modal.active {
            display: flex;
        }

        .camera-preview-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        #cameraPreview {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .camera-guide {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 300px;
            aspect-ratio: 4/3;
            border: 2px dashed rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            pointer-events: none;
        }

        .camera-guide-text {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 16px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 20px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            white-space: nowrap;
        }

        .camera-guide-text.far {
            background: var(--accent);
            color: var(--primary);
        }

        .camera-guide-text.near {
            background: #FFB800;
            color: var(--primary);
        }

        .camera-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            padding: 30px;
            padding-bottom: calc(30px + env(safe-area-inset-bottom));
            background: rgba(0, 0, 0, 0.8);
        }

        .camera-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            transition: all 0.2s ease;
        }

        .camera-btn:active {
            transform: scale(0.9);
        }

        .camera-btn.capture {
            background: white;
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.3);
        }

        .camera-btn.close {
            background: rgba(255, 255, 255, 0.2);
            width: 50px;
            height: 50px;
            color: white;
        }

        .camera-btn.gallery {
            background: rgba(255, 255, 255, 0.2);
            width: 50px;
            height: 50px;
            color: white;
            font-size: 22px;
        }

        .camera-bottom-hint {
            display: flex;
            justify-content: center;
            gap: 80px;
            padding-bottom: 10px;
            background: rgba(0, 0, 0, 0.8);
        }

        .camera-bottom-hint span {
            color: rgba(255, 255, 255, 0.6);
            font-size: 11px;
        }

        /* Ï§å Ïª®Ìä∏Î°§ */
        .zoom-controls {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .zoom-btn {
            width: 44px;
            height: 44px;
            background: rgba(0, 0, 0, 0.5);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }

        .zoom-level {
            text-align: center;
            color: white;
            font-size: 12px;
            font-weight: 600;
        }

        /* ÎßàÏª§ Ï∫îÎ≤ÑÏä§ */
        .marker-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }

        .marker-hint {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 16px;
            background: rgba(0, 212, 170, 0.9);
            border-radius: 20px;
            color: #0A1628;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
            opacity: 1;
            transition: opacity 0.3s ease;
        }

        .marker-hint.hidden {
            opacity: 0;
        }

        .camera-btn.reset {
            background: rgba(255, 255, 255, 0.2);
            width: 50px;
            height: 50px;
            color: white;
            font-size: 20px;
        }

        /* ==================== ÌÜ†Ïä§Ìä∏ ==================== */
        .toast {
            position: fixed;
            bottom: calc(var(--nav-height) + 20px);
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--primary-light);
            border: 1px solid var(--accent);
            border-radius: 10px;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 500;
            z-index: 400;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .toast.error {
            border-color: var(--warning);
            color: var(--warning);
        }

        /* ==================== ÏÇ¨ÏßÑ ÏòµÏÖò Ïï°ÏÖòÏãúÌä∏ ==================== */
        .photo-action-sheet {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 3000;
            display: none;
        }

        .photo-action-sheet.active {
            display: block;
        }

        .photo-action-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
        }

        .photo-action-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--card-bg);
            border-radius: 20px 20px 0 0;
            padding: 20px;
            padding-bottom: calc(20px + env(safe-area-inset-bottom));
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .photo-action-sheet.active .photo-action-content {
            transform: translateY(0);
        }

        .photo-action-title {
            text-align: center;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-muted);
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--card-border);
        }

        .photo-action-btn {
            width: 100%;
            padding: 16px;
            background: var(--primary-light);
            border: none;
            border-radius: var(--radius);
            color: var(--text);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
            -webkit-tap-highlight-color: transparent;
        }

        .photo-action-btn:active {
            background: var(--card-border);
        }

        .photo-action-btn.cancel {
            background: transparent;
            color: var(--text-muted);
            margin-bottom: 0;
        }

        /* ==================== ÏóÖÏÖÄÎßÅ Ïπ¥Îìú ==================== */
        .upsell-card {
            background: linear-gradient(135deg, #1A2D4A, #0A1628);
            border: 2px solid var(--accent);
            border-radius: var(--radius);
            padding: 24px;
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }

        .upsell-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(ellipse at 0% 0%, var(--accent-glow) 0%, transparent 50%),
                radial-gradient(ellipse at 100% 100%, rgba(255, 107, 107, 0.1) 0%, transparent 50%);
        }

        .upsell-badge {
            display: inline-block;
            padding: 4px 12px;
            background: var(--warning);
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
            margin-bottom: 12px;
            position: relative;
        }

        .upsell-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
            position: relative;
        }

        .upsell-desc {
            font-size: 14px;
            color: var(--text-muted);
            margin-bottom: 16px;
            position: relative;
            line-height: 1.6;
        }

        .upsell-btn {
            width: 100%;
            padding: 14px;
            background: var(--accent);
            border: none;
            border-radius: 10px;
            color: var(--primary);
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            position: relative;
        }

        /* ==================== Î¶¨Ìè¨Ìä∏ ÏÑπÏÖò ==================== */
        .report-project-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 16px;
            margin-bottom: 16px;
        }

        .report-project-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--card-border);
        }

        .report-project-row:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .report-project-row:first-child {
            padding-top: 0;
        }

        .report-project-label {
            font-size: 13px;
            color: var(--text-muted);
        }

        .report-project-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
        }

        .report-info-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 16px;
        }

        .report-info-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 16px;
        }

        .report-info-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .report-input-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .report-input-group label {
            font-size: 12px;
            color: var(--text-muted);
        }

        .report-input-group input {
            padding: 12px 14px;
            background: var(--primary-light);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            color: var(--text);
            font-size: 14px;
        }

        .report-input-group input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .report-input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .report-summary-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 20px;
        }

        .report-summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .report-summary-header span:first-child {
            font-size: 14px;
            color: var(--text-muted);
        }

        .report-summary-count {
            font-size: 28px;
            font-weight: 800;
            color: var(--accent);
        }

        .report-summary-bar {
            height: 6px;
            background: var(--primary-light);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 16px;
        }

        .report-summary-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), #00FFD4);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .report-summary-detail {
            display: flex;
            justify-content: space-around;
        }

        .report-stat {
            text-align: center;
        }

        .report-stat-value {
            display: block;
            font-size: 20px;
            font-weight: 700;
            color: var(--text);
        }

        .report-stat-label {
            font-size: 11px;
            color: var(--text-muted);
        }

        .report-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .report-btn {
            padding: 16px;
            border-radius: var(--radius);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .report-btn.primary {
            background: linear-gradient(135deg, var(--accent), #00A080);
            border: none;
            color: var(--primary);
        }

        .report-btn.secondary {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text);
        }

        .report-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* ==================== Î°úÎî© Ïò§Î≤ÑÎ†àÏù¥ ==================== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 22, 40, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 20px;
            z-index: 500;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--card-border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: var(--text);
            font-size: 14px;
        }

    </style>
</head>
<body>
    <div class="bg-gradient"></div>

    <!-- ==================== Ìó§Îçî ==================== -->
    <header class="header">
        <div class="logo">
            <div class="logo-icon">üè†</div>
            <span class="logo-text">Î∑∞ÌååÏù∏Îçî</span>
        </div>
        <div class="header-right">
            <span class="tier-badge" id="tierBadge">ÏÖÄÌîÑ ÏóêÎîîÏÖò</span>
        </div>
    </header>

    <!-- ==================== Î©îÏù∏ Ïª®ÌÖêÏ∏† ==================== -->
    <main class="main-content">

        <!-- ==================== Ìôà ÏÑπÏÖò ==================== -->
        <section class="section active" id="homeSection">
            <div class="welcome-card compact">
                <p class="welcome-subtitle">ÎàÑÍµ¨ÎÇò ÏÖÄÌîÑÎ°ú Ï†êÍ≤ÄÌï† Ïàò ÏûàÎäî ÏãúÏä§ÌÖú</p>
                <h1 class="welcome-title">Î∑∞ÌååÏù∏Îçî üîç</h1>
            </div>

            <!-- ÌîÑÎ°úÏ†ùÌä∏ Ï†ïÎ≥¥ ÏûÖÎ†• -->
            <div class="project-info-card">
                <div class="project-info-header">
                    <span class="project-info-icon">üè†</span>
                    <span class="project-info-title">Ï†êÍ≤Ä Ï†ïÎ≥¥</span>
                </div>
                <div class="project-info-form">
                    <input type="text" id="apartmentName" class="project-input full" placeholder="ÏïÑÌååÌä∏Î™Ö (Ïòà: ÎûòÎØ∏Ïïà ÌçºÏä§Ìä∏ÌïòÏûÑ)" />
                    <div class="project-input-row">
                        <input type="text" id="dongNumber" class="project-input" placeholder="Îèô (Ïòà: 101)" />
                        <input type="text" id="hoNumber" class="project-input" placeholder="Ìò∏ (Ïòà: 1201)" />
                    </div>
                    <input type="date" id="inspectionDate" class="project-input full" />
                </div>
            </div>

            <div class="progress-section">
                <div class="progress-header">
                    <span class="progress-title">Î∞úÍ≤¨Îêú ÌïòÏûê</span>
                    <span class="progress-percent" id="defectCountHome">0Í±¥</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="totalProgressBar" style="width: 0%"></div>
                </div>
            </div>

            <!-- ÌïòÏûêÏ†êÍ≤Ä ÏãúÏûë Î≤ÑÌäº (Î©îÏù∏) -->
            <div class="start-inspection-btn" onclick="showSection('defectSection')" ontouchend="showSection('defectSection')">
                <div class="start-inspection-icon">üîç</div>
                <div class="start-inspection-content">
                    <div class="start-inspection-title">ÌïòÏûêÏ†êÍ≤Ä ÏãúÏûëÌïòÍ∏∞</div>
                    <div class="start-inspection-desc">ÏÇ¨ÏßÑ Ï¥¨ÏòÅ Î∞è ÌïòÏûê Ï∂îÍ∞Ä</div>
                </div>
                <div class="start-inspection-arrow">‚Üí</div>
            </div>

            <div class="quick-actions">
                <div class="action-card" onclick="showSection('checklistSection')">
                    <div class="action-icon">‚úì</div>
                    <div class="action-title">Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏</div>
                    <div class="action-desc">Ï†êÍ≤Ä Í∞ÄÏù¥Îìú</div>
                </div>
                <div class="action-card" onclick="showSection('equipmentSection')">
                    <div class="action-icon">üîß</div>
                    <div class="action-title">Ïû•ÎπÑ Í∞ÄÏù¥Îìú</div>
                    <div class="action-desc">ÏÇ¨Ïö©Î≤ï ÏïàÎÇ¥</div>
                </div>
                <div class="action-card" onclick="showSection('reportSection')">
                    <div class="action-icon">üìä</div>
                    <div class="action-title">Î¶¨Ìè¨Ìä∏</div>
                    <div class="action-desc" id="defectCount">0Í±¥ Î∞úÍ≤¨</div>
                </div>
            </div>

            <!-- ÏÑúÎπÑÏä§ Í∞ÄÍ≤©Ìëú -->
            <div class="pricing-section">
                <div class="pricing-header">
                    <span class="pricing-title">üíé Î∑∞ÌååÏù∏Îçî ÏÑúÎπÑÏä§</span>
                    <span class="pricing-subtitle">ÎÇòÏóêÍ≤å ÎßûÎäî Ï†êÍ≤Ä ÏÑúÎπÑÏä§Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</span>
                </div>
                
                <div class="pricing-cards">
                    <div class="pricing-card current">
                        <div class="pricing-badge">ÌòÑÏû¨ Ïù¥Ïö©Ï§ë</div>
                        <div class="pricing-name">ÏÖÄÌîÑ</div>
                        <div class="pricing-price">3.9<span>ÎßåÏõê</span></div>
                        <div class="pricing-desc">PROÌÇ§Ìä∏ ÎåÄÏó¨ (1ÏãúÍ∞Ñ)<br/>Ïï± Ïù¥Ïö©Í∂å + Í≤∞Í≥º Î¶¨Ìè¨Ìä∏</div>
                        <div class="pricing-extra">+1ÏãúÍ∞Ñ Ï∂îÍ∞Ä Ïãú 1ÎßåÏõê</div>
                    </div>
                    
                    <div class="pricing-card" onclick="showUpgradeModal('assist')">
                        <div class="pricing-name">Ïñ¥ÏãúÏä§Ìä∏</div>
                        <div class="pricing-price">7.9<span>ÎßåÏõê</span></div>
                        <div class="pricing-desc">ÏÖÄÌîÑ Ìè¨Ìï®<br/>+ Îß§ÎãàÏ†Ä ÌòÑÏû• Î≥¥Ï°∞ (1ÏãúÍ∞Ñ)</div>
                    </div>
                    
                    <div class="pricing-card popular" onclick="showUpgradeModal('pro')">
                        <div class="pricing-badge">Ïù∏Í∏∞</div>
                        <div class="pricing-name">ÌîÑÎ°ú</div>
                        <div class="pricing-price">9.9<span>ÎßåÏõê</span></div>
                        <div class="pricing-desc">ÏÖÄÌîÑ Ìè¨Ìï®<br/>+ Í±¥Ï∂ïÏ†ÑÎ¨∏Í∞Ä ÎèôÌñâ (1ÏãúÍ∞Ñ)</div>
                    </div>
                    
                    <div class="pricing-card" onclick="showUpgradeModal('onecare')">
                        <div class="pricing-name">ÏõêÏä§ÌÜ±</div>
                        <div class="pricing-price">Í≤¨Ï†ÅÍ∞Ä</div>
                        <div class="pricing-desc">ÌîÑÎ°ú Ìè¨Ìï®<br/>+ ÏûÖÏ£ºÏ≤≠ÏÜå/Ï§ÑÎàà Ìå®ÌÇ§ÏßÄ</div>
                    </div>
                </div>
                
                <!-- ÌïòÏûê Ï†ëÏàò ÎåÄÌñâ Ïï†ÎìúÏò® -->
                <div class="addon-section" onclick="requestAddon()">
                    <div class="addon-header">
                        <span class="addon-badge">ADD-ON</span>
                        <span class="addon-title">ÌïòÏûê Ï†ëÏàò ÎåÄÌñâ</span>
                    </div>
                    <div class="addon-desc">Í±¥ÏÑ§ÏÇ¨ ÌïòÏûêÏ†ëÏàò ÏãúÏä§ÌÖú Îì±Î°ù ÎåÄÌñâ</div>
                    <div class="addon-prices">
                        <span class="addon-price">30Í±¥‚Üì <b>2Îßå</b></span>
                        <span class="addon-price">50Í±¥‚Üì <b>3Îßå</b></span>
                        <span class="addon-price">70Í±¥‚Üì <b>5Îßå</b></span>
                        <span class="addon-price">100Í±¥‚Üì <b>6Îßå</b></span>
                        <span class="addon-price">150Í±¥‚Üë <b>7Îßå</b></span>
                    </div>
                </div>
                
                <div class="pricing-contact">
                    ÏóÖÍ∑∏Î†àÏù¥Îìú Î¨∏Ïùò <a href="tel:010-9985-0128">010-9985-0128</a>
                </div>
            </div>
        </section>

        <!-- ==================== ÌïòÏûêÏ†êÍ≤Ä ÏÑπÏÖò (ÌÜµÌï©) ==================== -->
        <section class="section" id="defectSection">
            <div class="inspection-header">
                <div>
                    <h2 style="font-size: 20px; font-weight: 700;">ÌïòÏûêÏ†êÍ≤Ä</h2>
                    <p style="font-size: 13px; color: var(--text-muted); margin-top: 4px;">Î∞úÍ≤¨Îêú ÌïòÏûêÎ•º Í∏∞Î°ùÌïòÏÑ∏Ïöî</p>
                </div>
                <div class="inspection-count" id="inspectionCount">0Í±¥</div>
            </div>
            
            <div class="defect-list" id="defectList">
                <div class="defect-empty">
                    <div class="defect-empty-icon">üîç</div>
                    <p>ÏïÑÏßÅ Î∞úÍ≤¨Îêú ÌïòÏûêÍ∞Ä ÏóÜÏäµÎãàÎã§</p>
                    <p style="font-size: 12px; margin-top: 8px;">ÏïÑÎûò Î≤ÑÌäºÏùÑ ÎàåÎü¨ ÌïòÏûêÎ•º Í∏∞Î°ùÌïòÏÑ∏Ïöî</p>
                </div>
            </div>
            
            <button class="add-defect-btn" onclick="openDefectRegister()" ontouchend="openDefectRegister()">
                <span>+</span> ÌïòÏûê Ï∂îÍ∞ÄÌïòÍ∏∞
            </button>
        </section>

        <!-- ==================== Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ ÏÑπÏÖò ==================== -->
        <section class="section" id="checklistSection">
            <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 20px;">Í≥µÍ∞ÑÎ≥Ñ Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏</h2>
            
            <div class="checklist-spaces" id="checklistSpaces">
                <!-- ÎèôÏ†Å ÏÉùÏÑ± -->
            </div>
        </section>

        <!-- ==================== Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ ÏÉÅÏÑ∏ ==================== -->
        <section class="section" id="checklistDetailSection">
            <div class="checklist-detail-header">
                <button class="back-btn" onclick="showSection('checklistSection')">‚Üê</button>
                <h2 id="checklistDetailTitle">Í±∞Ïã§</h2>
                <span class="checklist-progress" id="checklistProgress">0/0</span>
            </div>
            
            <div id="checklistItems">
                <!-- ÎèôÏ†Å ÏÉùÏÑ± -->
            </div>
        </section>

        <!-- ==================== Ïû•ÎπÑ Í∞ÄÏù¥Îìú ÏÑπÏÖò ==================== -->
        <section class="section" id="equipmentSection">
            <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 20px;">Ïû•ÎπÑ ÏÇ¨Ïö© Í∞ÄÏù¥Îìú</h2>
            <div id="equipmentList"></div>
        </section>

        <!-- ==================== Î¶¨Ìè¨Ìä∏ ÏÑπÏÖò ==================== -->
        <section class="section" id="reportSection">
            <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 20px;">Ï†êÍ≤Ä Í≤∞Í≥º Î¶¨Ìè¨Ìä∏</h2>
            
            <!-- ÌîÑÎ°úÏ†ùÌä∏ Ï†ïÎ≥¥ ÌëúÏãú -->
            <div class="report-project-card">
                <div class="report-project-row">
                    <span class="report-project-label">ÏïÑÌååÌä∏</span>
                    <span class="report-project-value" id="reportAptName">-</span>
                </div>
                <div class="report-project-row">
                    <span class="report-project-label">Îèô/Ìò∏Ïàò</span>
                    <span class="report-project-value" id="reportDongHo">-</span>
                </div>
                <div class="report-project-row">
                    <span class="report-project-label">Ï†êÍ≤ÄÏùº</span>
                    <span class="report-project-value" id="reportDate">-</span>
                </div>
            </div>
            
            <!-- Ï†êÍ≤Ä ÏöîÏïΩ -->
            <div class="report-summary-card">
                <div class="report-summary-header">
                    <span>Î∞úÍ≤¨Îêú ÌïòÏûê</span>
                    <span class="report-summary-count" id="reportDefectCount">0Í±¥</span>
                </div>
                <div class="report-summary-bar">
                    <div class="report-summary-fill" id="reportProgressBar" style="width: 0%"></div>
                </div>
                <div class="report-summary-detail">
                    <div class="report-stat">
                        <span class="report-stat-value" id="reportCheckedCount">0</span>
                        <span class="report-stat-label">Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ ÏôÑÎ£å</span>
                    </div>
                    <div class="report-stat">
                        <span class="report-stat-value" id="reportPhotoCount">0</span>
                        <span class="report-stat-label">Ï¥¨ÏòÅ ÏÇ¨ÏßÑ</span>
                    </div>
                </div>
            </div>

            <!-- Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Î≤ÑÌäºÎì§ -->
            <div class="report-actions">
                <button class="report-btn primary" onclick="generatePDF()">
                    üìÑ PDF Î≥¥Í≥†ÏÑú ÏÉùÏÑ±
                </button>
                <button class="report-btn secondary" onclick="shareReport()">
                    üì§ Ïπ¥Ïπ¥Ïò§ÌÜ° Í≥µÏú†
                </button>
            </div>
            
            <!-- ÏóÖÏÖÄÎßÅ -->
            <div class="upsell-card" style="margin-top: 24px;">
                <span class="upsell-badge">üîç Ï†ÑÎ¨∏Í∞Ä Ï†êÍ≤Ä</span>
                <h3 class="upsell-title">Îçî ÍººÍººÌïú Ï†êÍ≤ÄÏù¥ ÌïÑÏöîÌïòÏÑ∏Ïöî?</h3>
                <p class="upsell-desc">ÏÖÄÌîÑ Ï†êÍ≤ÄÏóêÏÑú Î∞úÍ≤¨ÌïòÍ∏∞ Ïñ¥Î†§Ïö¥ Ïà®ÏùÄ ÌïòÏûêÍπåÏßÄ Ï†ÑÎ¨∏Í∞ÄÍ∞Ä ÌôïÏù∏Ìï¥ÎìúÎ¶ΩÎãàÎã§.</p>
                <button class="upsell-btn" onclick="showUpgradeModal('pro')">ÌîÑÎ°ú Ï†êÍ≤Ä Ïã†Ï≤≠ 8.9ÎßåÏõê ‚Üí</button>
            </div>
        </section>

    </main>

    <!-- ==================== ÌïòÎã® ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ==================== -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="showSection('homeSection')" data-section="homeSection">
            <span class="nav-icon">üè†</span>
            <span class="nav-label">Ìôà</span>
        </div>
        <div class="nav-item" onclick="showSection('defectSection')" data-section="defectSection">
            <span class="nav-icon">üîç</span>
            <span class="nav-label">ÌïòÏûêÏ†êÍ≤Ä</span>
        </div>
        <div class="nav-item" onclick="showSection('equipmentSection')" data-section="equipmentSection">
            <span class="nav-icon">üîß</span>
            <span class="nav-label">Ïû•ÎπÑ</span>
        </div>
        <div class="nav-item" onclick="showSection('reportSection')" data-section="reportSection">
            <span class="nav-icon">üìä</span>
            <span class="nav-label">Î¶¨Ìè¨Ìä∏</span>
        </div>
    </nav>

    <!-- ==================== ÌïòÏûê Îì±Î°ù Ï†ÑÏ≤¥ÌôîÎ©¥ ==================== -->
    <div class="defect-register-screen" id="defectRegisterScreen">
        <div class="defect-register-header">
            <h2 class="defect-register-title">ÌïòÏûê Ï∂îÍ∞Ä</h2>
            <button class="defect-register-close" onclick="closeDefectRegister()">‚úï</button>
        </div>
        
        <div class="defect-register-body">
            <!-- ÏÇ¨ÏßÑ Ï¥¨ÏòÅ -->
            <div class="form-section">
                <div class="form-label">
                    <span class="form-label-icon">üì∑</span>
                    ÏÇ¨ÏßÑ Ï¥¨ÏòÅ
                    <span class="form-sublabel">ÌïÑÏàò 2Ïû•</span>
                </div>
                <div class="photo-capture-area">
                    <div class="photo-capture-box far" id="photoBoxFar" onclick="showPhotoOptions('far')">
                        <span class="photo-capture-icon">üì∏</span>
                        <span class="photo-capture-label">ÏõêÍ≤Ω Ï¥¨ÏòÅ</span>
                        <span class="photo-capture-sublabel">Î©ÄÎ¶¨ÏÑú Ï†ÑÏ≤¥ Î™®Ïäµ</span>
                    </div>
                    <div class="photo-capture-box near" id="photoBoxNear" onclick="showPhotoOptions('near')">
                        <span class="photo-capture-icon">üîç</span>
                        <span class="photo-capture-label">Í∑ºÍ≤Ω Ï¥¨ÏòÅ</span>
                        <span class="photo-capture-sublabel">Í∞ÄÍπåÏù¥ÏÑú ÏÉÅÏÑ∏Ìûà</span>
                    </div>
                </div>
            </div>

            <!-- Í≥µÍ∞Ñ ÏÑ†ÌÉù -->
            <div class="form-section">
                <div class="form-label">
                    <span class="form-label-icon">üè†</span>
                    Í≥µÍ∞Ñ ÏÑ†ÌÉù
                    <span class="form-sublabel selected-count" id="spaceCount">0/4 ÏÑ†ÌÉù</span>
                </div>
                <div class="touch-btn-grid" id="spaceButtons">
                    <!-- ÎèôÏ†Å ÏÉùÏÑ± -->
                </div>
            </div>

            <!-- ÌïòÏûê ÎÇ¥Ïö© -->
            <div class="form-section">
                <div class="form-label">
                    <span class="form-label-icon">üìù</span>
                    ÌïòÏûê ÎÇ¥Ïö©
                </div>
                <div class="voice-input-area">
                    <textarea class="voice-textarea" id="defectDescription" placeholder="ÌïòÏûê ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"></textarea>
                </div>
                <div class="voice-hint">
                    üí° ÌÇ§Î≥¥ÎìúÏùò üé§ Î≤ÑÌäºÏùÑ ÎàÑÎ•¥Î©¥ ÏùåÏÑ±ÏúºÎ°ú ÏûÖÎ†•Ìï† Ïàò ÏûàÏäµÎãàÎã§
                </div>
            </div>
        </div>

        <div class="defect-register-footer">
            <button class="save-defect-btn" id="saveDefectBtn" onclick="saveDefect()" ontouchend="saveDefect()">
                + ÌïòÏûê Ï∂îÍ∞ÄÌïòÍ∏∞
            </button>
        </div>
    </div>

    <!-- ==================== Ïπ¥Î©îÎùº Î™®Îã¨ ==================== -->
    <div class="camera-modal" id="cameraModal">
        <div class="camera-preview-container">
            <video id="cameraPreview" autoplay playsinline muted></video>
            <canvas id="markerCanvas" class="marker-canvas"></canvas>
            <div class="camera-guide"></div>
            <div class="camera-guide-text" id="cameraGuideText">ÏõêÍ≤Ω Ï¥¨ÏòÅ - Î©ÄÎ¶¨ÏÑú Ï†ÑÏ≤¥ Î™®Ïäµ</div>
            
            <div class="zoom-controls">
                <button class="zoom-btn" onclick="adjustZoom(0.5)">+</button>
                <div class="zoom-level" id="zoomLevel">1.0x</div>
                <button class="zoom-btn" onclick="adjustZoom(-0.5)">-</button>
            </div>
            
            <div class="marker-hint" id="markerHint">ÌôîÎ©¥ÏùÑ ÌÑ∞ÏπòÌïòÎ©¥ ÎßàÏª§Í∞Ä ÌëúÏãúÎê©ÎãàÎã§</div>
        </div>
        
        <div class="camera-controls">
            <button class="camera-btn close" onclick="closeCamera()">‚úï</button>
            <button class="camera-btn capture" onclick="capturePhoto()">üì∏</button>
            <button class="camera-btn gallery" onclick="openGalleryFromCamera()">üñºÔ∏è</button>
        </div>
        <div class="camera-bottom-hint">
            <span>Ï¥¨ÏòÅ</span>
            <span>Í∞§Îü¨Î¶¨</span>
        </div>
    </div>

    <!-- ==================== ÌÜ†Ïä§Ìä∏ ==================== -->
    <div class="toast" id="toast">Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§</div>

    <!-- ==================== ÏÇ¨ÏßÑ ÏòµÏÖò Ïï°ÏÖòÏãúÌä∏ ==================== -->
    <div class="photo-action-sheet" id="photoActionSheet">
        <div class="photo-action-overlay" onclick="closePhotoOptions()"></div>
        <div class="photo-action-content">
            <div class="photo-action-title" id="photoActionTitle">ÏõêÍ≤Ω ÏÇ¨ÏßÑ</div>
            <button class="photo-action-btn" onclick="selectPhotoOption('camera')">
                <span>üì∏</span> Ï¥¨ÏòÅÌïòÍ∏∞
            </button>
            <button class="photo-action-btn" onclick="selectPhotoOption('gallery')">
                <span>üñºÔ∏è</span> Í∞§Îü¨Î¶¨ÏóêÏÑú ÏÑ†ÌÉù
            </button>
            <button class="photo-action-btn cancel" onclick="closePhotoOptions()">
                Ï∑®ÏÜå
            </button>
        </div>
    </div>

    <!-- ==================== Î°úÎî© Ïò§Î≤ÑÎ†àÏù¥ ==================== -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loadingText">PDF ÏÉùÏÑ± Ï§ë...</div>
    </div>

    <!-- ==================== Ï∫îÎ≤ÑÏä§ (ÏÇ¨ÏßÑ ÏïïÏ∂ïÏö©) ==================== -->
    <canvas id="photoCanvas" style="display: none;"></canvas>

    <script>
        // ==================== Îç∞Ïù¥ÌÑ∞ ====================
        const APP_DATA = {
            defects: [],
            customSpaces: [],
            checkedItems: {}, // Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ Ï≤¥ÌÅ¨ ÏÉÅÌÉú
            projectInfo: {    // ÌîÑÎ°úÏ†ùÌä∏ Ï†ïÎ≥¥
                apartmentName: '',
                dong: '',
                ho: '',
                inspectionDate: ''
            }
        };

        // Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ Îç∞Ïù¥ÌÑ∞
        const CHECKLIST_DATA = {
            living: {
                name: 'Í±∞Ïã§',
                icon: 'üõãÔ∏è',
                items: [
                    { id: 'l1', title: 'Î∞îÎã• Ïä§ÌÅ¨ÎûòÏπò', desc: 'ÎßàÎ£® Ï†ÑÏ≤¥Î•º ÎπÑÏä§Îì¨Ìïú ÎπõÏúºÎ°ú ÌôïÏù∏', tip: 'üí° Ï∞ΩÎ¨∏ Ï™ΩÏóêÏÑú ÎπõÏùÑ Î∞õÏïÑ ÌôïÏù∏ÌïòÎ©¥ Ïûò Î≥¥Ïó¨Ïöî' },
                    { id: 'l2', title: 'Î≤ΩÎ©¥ ÎèÑÎ∞∞', desc: 'Ïù¥ÏùåÏÉà Î≤åÏñ¥Ïßê, Í∏∞Ìè¨, Ï∞¢Ïñ¥Ïßê ÌôïÏù∏' },
                    { id: 'l3', title: 'Ï∞ΩÎ¨∏ Í∞úÌèê', desc: 'Ïó¥Î¶º/Îã´Ìûò, Ïû†Í∏àÏû•Ïπò ÏûëÎèô ÌôïÏù∏' },
                    { id: 'l4', title: 'ÏΩòÏÑºÌä∏ ÏûëÎèô', desc: 'Ï∂©Ï†ÑÍ∏∞Î°ú Î™®Îì† ÏΩòÏÑºÌä∏ ÌÖåÏä§Ìä∏' },
                    { id: 'l5', title: 'Ï°∞Î™Ö Ïä§ÏúÑÏπò', desc: 'ON/OFF ÏûëÎèô ÌôïÏù∏' },
                    { id: 'l6', title: 'Ï≤úÏû• ÏÉÅÌÉú', desc: 'Í∑†Ïó¥, ÏñºÎ£© ÌôïÏù∏' }
                ]
            },
            kitchen: {
                name: 'Ï£ºÎ∞©',
                icon: 'üç≥',
                items: [
                    { id: 'k1', title: 'Ïã±ÌÅ¨ÎåÄ ÎàÑÏàò', desc: 'Î¨º ÌãÄÍ≥† ÌïòÎ∂ÄÏû• ÎàÑÏàò ÌôïÏù∏', tip: 'üí° Ìú¥ÏßÄÎ•º Î∞∞Í¥ÄÏóê Í∞êÏïÑÎëêÎ©¥ ÌôïÏù∏Ïù¥ Ïâ¨ÏõåÏöî' },
                    { id: 'k2', title: 'ÏÉÅÌïòÎ∂ÄÏû• Í∞úÌèê', desc: 'Î™®Îì† Î¨∏Ïßù/ÏÑúÎûç Ïó¥Î¶ºÎã´Ìûò' },
                    { id: 'k3', title: 'Í∞ÄÏä§Î†àÏù∏ÏßÄ', desc: 'Ï†êÌôî Î∞è ÌôîÎ†• Ï°∞Ï†à ÌÖåÏä§Ìä∏' },
                    { id: 'k4', title: 'ÌôòÌíçÍ∏∞', desc: 'Î†àÏù∏ÏßÄÌõÑÎìú Ìù°ÏûÖÎ†• ÌôïÏù∏' },
                    { id: 'k5', title: 'ÏàòÏ†Ñ ÏàòÏïï', desc: 'Ïò®Ïàò/ÎÉâÏàò Ï†ÑÌôò ÌÖåÏä§Ìä∏' }
                ]
            },
            bedroom: {
                name: 'Ïπ®Ïã§',
                icon: 'üõèÔ∏è',
                items: [
                    { id: 'b1', title: 'Î∞îÎã• ÏÉÅÌÉú', desc: 'ÎßàÎ£® Ïä§ÌÅ¨ÎûòÏπò, Îì§Îú∏ ÌôïÏù∏' },
                    { id: 'b2', title: 'Î∂ôÎ∞ïÏù¥Ïû•', desc: 'Î¨∏Ïßù, ÏÑúÎûç, Î†àÏùº ÏÉÅÌÉú' },
                    { id: 'b3', title: 'Ï∞ΩÎ¨∏ Í≤∞Î°ú', desc: 'Ï∞ΩÌãÄ Ï£ºÎ≥Ä Í≤∞Î°ú ÌùîÏ†Å', tip: 'üí° Ïó¥ÌôîÏÉÅ Ïπ¥Î©îÎùºÎ°ú ÌôïÏù∏ÌïòÏÑ∏Ïöî' },
                    { id: 'b4', title: 'ÏΩòÏÑºÌä∏ ÏúÑÏπò', desc: 'Ïπ®ÎåÄ Ìó§Îìú Ï™Ω ÌôïÏù∏' }
                ]
            },
            bathroom: {
                name: 'ÌôîÏû•Ïã§',
                icon: 'üöø',
                items: [
                    { id: 'bt1', title: 'ÏÑ∏Î©¥ÎåÄ Î∞∞Ïàò', desc: 'Î¨º Îπ†Ïßê ÏÜçÎèÑ ÌôïÏù∏', tip: 'üí° Î¨ºÏùÑ Í∞ÄÎìù Ï±ÑÏö¥ ÌõÑ ÌïúÎ≤àÏóê ÎπºÎ≥¥ÏÑ∏Ïöî' },
                    { id: 'bt2', title: 'Î≥ÄÍ∏∞ Î¨ºÎÇ¥Î¶º', desc: 'ÌîåÎü¨Ïãú Í∞ïÎèÑ ÌôïÏù∏' },
                    { id: 'bt3', title: 'ÏÉ§ÏõåÍ∏∞ ÏàòÏïï', desc: 'Ïò®Ïàò/ÎÉâÏàò, ÏàòÏïï ÌÖåÏä§Ìä∏' },
                    { id: 'bt4', title: 'Î∞îÎã• Î∞©Ïàò', desc: 'ÌÉÄÏùº Í∑†Ïó¥, Î∞∞ÏàòÍµ¨ Ï£ºÎ≥Ä' },
                    { id: 'bt5', title: 'ÌôòÌíçÍ∏∞', desc: 'Ìù°ÏûÖÎ†• ÌôïÏù∏' }
                ]
            },
            balcony: {
                name: 'Î∞úÏΩîÎãà',
                icon: 'üåø',
                items: [
                    { id: 'bl1', title: 'Ï∞ΩÌò∏ Í∏∞Î∞ÄÏÑ±', desc: 'ÏÉ∑Ïãú ÌãàÏÉà, Î∞îÎûå Ïú†ÏûÖ', tip: 'üí° Ïó¥ÌôîÏÉÅ Ïπ¥Î©îÎùºÎ°ú Ïô∏Í∏∞ Ïπ®Ìà¨ ÌôïÏù∏' },
                    { id: 'bl2', title: 'Î∞∞ÏàòÍµ¨', desc: 'ÎßâÌûò Î∞è Í∏∞Ïö∏Í∏∞ ÌôïÏù∏' },
                    { id: 'bl3', title: 'Î∞îÎã• ÌÉÄÏùº', desc: 'Îì§Îú∏, Í∑†Ïó¥ ÌôïÏù∏' }
                ]
            },
            entrance: {
                name: 'ÌòÑÍ¥Ä',
                icon: 'üö™',
                items: [
                    { id: 'e1', title: 'ÌòÑÍ¥ÄÎ¨∏ Í∞úÌèê', desc: 'Ïó¥Î¶º/Îã´Ìûò, Ïû†Í∏àÏû•Ïπò' },
                    { id: 'e2', title: 'ÎèÑÏñ¥ÎùΩ', desc: 'ÎπÑÎ∞ÄÎ≤àÌò∏, ÏßÄÎ¨∏, Ïπ¥Îìú ÌÖåÏä§Ìä∏' },
                    { id: 'e3', title: 'Ïã†Î∞úÏû•', desc: 'Î¨∏Ïßù, ÏÑúÎûç, ÌôòÍ∏∞Íµ¨' },
                    { id: 'e4', title: 'Ïù∏ÌÑ∞Ìè∞', desc: 'ÏòÅÏÉÅ/ÏùåÏÑ± ÌÜµÌôî ÌÖåÏä§Ìä∏' }
                ]
            }
        };

        // Í∏∞Î≥∏ Í≥µÍ∞Ñ Î™©Î°ù (ÎçîÌôàÏ†êÍ≤Ä ÎèôÏùº)
        const DEFAULT_SPACES = [
            'ÌòÑÍ¥Ä', 'ÏïàÎ∞©', 'Ïπ®Ïã§1', 'Ïπ®Ïã§2', 'Ïπ®Ïã§3', 'Ïπ®Ïã§4', 
            'Î≥µÎèÑ', 'Í±∞Ïã§', 'Ï£ºÎ∞©', 'Ìå¨Ìä∏Î¶¨', 'Ïô∏Î∂Ä', 'ÏïåÌååÎ£∏',
            'Î∞úÏΩîÎãà', 'ÎåÄÌîºÍ≥µÍ∞Ñ', 'Ïã§Ïô∏Í∏∞Ïã§', 'ÌååÏö∞ÎçîÎ£∏', 
            'ÎìúÎ†àÏä§Î£∏', 'Í≥µÏö©ÏöïÏã§', 'Î∂ÄÎ∂ÄÏöïÏã§'
        ];

        // ==================== ÌòÑÏû¨ Îì±Î°ù Ï§ëÏù∏ ÌïòÏûê ====================
        let currentDefect = {
            spaces: [],
            description: '',
            photos: { far: null, near: null }
        };

        // ==================== Ïπ¥Î©îÎùº Í¥ÄÎ†® (ÎçîÌôàÏ†êÍ≤Ä ÎèôÏùº) ====================
        let cameraStream = null;
        let currentPhotoType = null; // 'far' or 'near'
        let currentZoom = 1.0;
        let markers = [];
        let markerCanvas = null;
        let markerCtx = null;

        // ==================== Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ ====================
        let currentChecklistSpace = null;

        function renderChecklistSpaces() {
            const container = document.getElementById('checklistSpaces');
            
            container.innerHTML = Object.keys(CHECKLIST_DATA).map(key => {
                const space = CHECKLIST_DATA[key];
                const checked = space.items.filter(item => APP_DATA.checkedItems[item.id]).length;
                const total = space.items.length;
                const isCompleted = checked === total;
                
                return `
                    <div class="checklist-space-card ${isCompleted ? 'completed' : ''}" onclick="openChecklistDetail('${key}')">
                        <div class="checklist-space-icon">${space.icon}</div>
                        <div class="checklist-space-info">
                            <div class="checklist-space-name">${space.name}</div>
                            <div class="checklist-space-status">${checked}/${total} ÏôÑÎ£å</div>
                        </div>
                        <div class="checklist-space-arrow">${isCompleted ? '‚úì' : '‚Üí'}</div>
                    </div>
                `;
            }).join('');
        }

        function openChecklistDetail(spaceKey) {
            currentChecklistSpace = spaceKey;
            const space = CHECKLIST_DATA[spaceKey];
            
            document.getElementById('checklistDetailTitle').textContent = space.name;
            renderChecklistItems();
            showSection('checklistDetailSection');
        }

        function renderChecklistItems() {
            const space = CHECKLIST_DATA[currentChecklistSpace];
            const checked = space.items.filter(item => APP_DATA.checkedItems[item.id]).length;
            
            document.getElementById('checklistProgress').textContent = `${checked}/${space.items.length}`;
            
            const container = document.getElementById('checklistItems');
            container.innerHTML = space.items.map(item => {
                const isChecked = APP_DATA.checkedItems[item.id];
                return `
                    <div class="checklist-item ${isChecked ? 'checked' : ''}" onclick="toggleChecklistItem('${item.id}')">
                        <div class="checklist-checkbox">${isChecked ? '‚úì' : ''}</div>
                        <div class="checklist-item-content">
                            <div class="checklist-item-title">${item.title}</div>
                            <div class="checklist-item-desc">${item.desc}</div>
                            ${item.tip ? `<div class="checklist-item-tip">${item.tip}</div>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function toggleChecklistItem(itemId) {
            APP_DATA.checkedItems[itemId] = !APP_DATA.checkedItems[itemId];
            saveData();
            renderChecklistItems();
            renderChecklistSpaces();
        }

        // ==================== Ï¥àÍ∏∞Ìôî ====================
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            renderSpaceButtons();
            renderDefectList();
            renderEquipmentList();
            renderChecklistSpaces();
            initProjectInfoListeners();
            
            // Ïò§Îäò ÎÇ†Ïßú Í∏∞Î≥∏Í∞í
            const dateInput = document.getElementById('inspectionDate');
            if (dateInput && !dateInput.value) {
                dateInput.value = new Date().toISOString().split('T')[0];
            }
        });

        // ÌîÑÎ°úÏ†ùÌä∏ Ï†ïÎ≥¥ ÏûêÎèô Ï†ÄÏû•
        function initProjectInfoListeners() {
            const inputs = ['apartmentName', 'dongNumber', 'hoNumber', 'inspectionDate'];
            inputs.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.addEventListener('change', saveProjectInfo);
                    el.addEventListener('blur', saveProjectInfo);
                }
            });
        }

        function saveProjectInfo() {
            APP_DATA.projectInfo = {
                apartmentName: document.getElementById('apartmentName').value,
                dong: document.getElementById('dongNumber').value,
                ho: document.getElementById('hoNumber').value,
                inspectionDate: document.getElementById('inspectionDate').value
            };
            saveData();
        }

        // ==================== IndexedDB Ï†ÄÏû•/Î°úÎìú ====================
        const DB_NAME = 'viewfinder_db';
        const DB_VERSION = 1;
        const STORE_NAME = 'app_data';
        let db = null;

        // IndexedDB Ï¥àÍ∏∞Ìôî
        function initDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);
                
                request.onerror = () => reject(request.error);
                request.onsuccess = () => {
                    db = request.result;
                    resolve(db);
                };
                
                request.onupgradeneeded = (e) => {
                    const database = e.target.result;
                    if (!database.objectStoreNames.contains(STORE_NAME)) {
                        database.createObjectStore(STORE_NAME, { keyPath: 'id' });
                    }
                };
            });
        }

        // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• (IndexedDB)
        function saveData() {
            if (!db) {
                console.warn('DB not initialized');
                return;
            }
            
            try {
                const transaction = db.transaction([STORE_NAME], 'readwrite');
                const store = transaction.objectStore(STORE_NAME);
                
                const dataToSave = {
                    id: 'main',
                    ...APP_DATA
                };
                
                store.put(dataToSave);
                
                transaction.onerror = (e) => {
                    console.error('Ï†ÄÏû• Ïò§Î•ò:', e);
                    showToast('Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§', 'error');
                };
                
                updateCounts();
            } catch (err) {
                console.error('saveData Ïò§Î•ò:', err);
                showToast('Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§', 'error');
            }
        }

        // Îç∞Ïù¥ÌÑ∞ Î°úÎìú (IndexedDB)
        async function loadData() {
            try {
                await initDB();
                
                // localStorageÏóêÏÑú ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò ÏãúÎèÑ
                const oldData = localStorage.getItem('viewfinder_data');
                if (oldData) {
                    try {
                        const parsed = JSON.parse(oldData);
                        Object.assign(APP_DATA, parsed);
                        saveData(); // IndexedDBÎ°ú Ï†ÄÏû•
                        localStorage.removeItem('viewfinder_data'); // Í∏∞Ï°¥ Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú
                        console.log('localStorageÏóêÏÑú IndexedDBÎ°ú ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò ÏôÑÎ£å');
                    } catch (e) {
                        console.warn('ÎßàÏù¥Í∑∏Î†àÏù¥ÏÖò Ïã§Ìå®:', e);
                    }
                }
                
                // IndexedDBÏóêÏÑú Î°úÎìú
                const transaction = db.transaction([STORE_NAME], 'readonly');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.get('main');
                
                request.onsuccess = () => {
                    if (request.result) {
                        const { id, ...data } = request.result;
                        Object.assign(APP_DATA, data);
                        
                        // ÌîÑÎ°úÏ†ùÌä∏ Ï†ïÎ≥¥ inputÏóê ÏÑ∏ÌåÖ
                        if (APP_DATA.projectInfo) {
                            const aptInput = document.getElementById('apartmentName');
                            const dongInput = document.getElementById('dongNumber');
                            const hoInput = document.getElementById('hoNumber');
                            const dateInput = document.getElementById('inspectionDate');
                            
                            if (aptInput) aptInput.value = APP_DATA.projectInfo.apartmentName || '';
                            if (dongInput) dongInput.value = APP_DATA.projectInfo.dong || '';
                            if (hoInput) hoInput.value = APP_DATA.projectInfo.ho || '';
                            if (dateInput) dateInput.value = APP_DATA.projectInfo.inspectionDate || '';
                        }
                    }
                    updateCounts();
                    renderDefectList();
                };
                
                request.onerror = () => {
                    console.error('Î°úÎìú Ïò§Î•ò:', request.error);
                    updateCounts();
                };
                
            } catch (err) {
                console.error('loadData Ïò§Î•ò:', err);
                updateCounts();
            }
        }

        function updateCounts() {
            const count = APP_DATA.defects.length;
            document.getElementById('defectCount').textContent = `${count}Í±¥ Î∞úÍ≤¨`;
            document.getElementById('defectCountHome').textContent = `${count}Í±¥`;
            document.getElementById('reportDefectCount').textContent = `${count}Í±¥`;
            document.getElementById('inspectionCount').textContent = `${count}Í±¥`;
            
            // Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ ÏôÑÎ£å Ïàò
            const checkedCount = Object.keys(APP_DATA.checkedItems).filter(k => APP_DATA.checkedItems[k]).length;
            const reportChecked = document.getElementById('reportCheckedCount');
            if (reportChecked) reportChecked.textContent = checkedCount;
            
            // Ï¥¨ÏòÅ ÏÇ¨ÏßÑ Ïàò
            const photoCount = APP_DATA.defects.reduce((sum, d) => {
                return sum + (d.photos ? d.photos.filter(p => p).length : 0);
            }, 0);
            const reportPhoto = document.getElementById('reportPhotoCount');
            if (reportPhoto) reportPhoto.textContent = photoCount;
            
            // ÌîÑÎ°úÍ∑∏Î†àÏä§ Î∞î (ÏµúÎåÄ 20Í±¥ Í∏∞Ï§Ä)
            const progress = Math.min(count * 5, 100);
            document.getElementById('totalProgressBar').style.width = `${progress}%`;
            
            const reportBar = document.getElementById('reportProgressBar');
            if (reportBar) reportBar.style.width = `${progress}%`;
        }

        // ==================== ÏÑπÏÖò Ï†ÑÌôò ====================
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');

            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.section === sectionId) {
                    item.classList.add('active');
                }
            });

            if (sectionId === 'homeSection') {
                document.querySelector('.nav-item').classList.add('active');
            }
            
            // Î¶¨Ìè¨Ìä∏ ÏÑπÏÖò ÌëúÏãú Ïãú ÌîÑÎ°úÏ†ùÌä∏ Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
            if (sectionId === 'reportSection') {
                updateReportProjectInfo();
            }
        }
        
        function updateReportProjectInfo() {
            const aptName = document.getElementById('apartmentName').value || '-';
            const dong = document.getElementById('dongNumber').value || '-';
            const ho = document.getElementById('hoNumber').value || '-';
            const date = document.getElementById('inspectionDate').value || '-';
            
            document.getElementById('reportAptName').textContent = aptName;
            document.getElementById('reportDongHo').textContent = (dong !== '-' && ho !== '-') ? `${dong}Îèô ${ho}Ìò∏` : '-';
            document.getElementById('reportDate').textContent = date;
        }

        // ==================== ÌïòÏûê Îì±Î°ù ÌôîÎ©¥ ====================
        function openDefectRegister() {
            // Ï¥àÍ∏∞Ìôî
            currentDefect = {
                spaces: [],
                description: '',
                photos: { far: null, near: null }
            };
            
            renderSpaceButtons();
            resetPhotoBoxes();
            document.getElementById('defectDescription').value = '';
            document.getElementById('spaceCount').textContent = '0/4 ÏÑ†ÌÉù';
            
            document.getElementById('defectRegisterScreen').classList.add('active');
        }

        function closeDefectRegister() {
            document.getElementById('defectRegisterScreen').classList.remove('active');
        }

        // ==================== Í≥µÍ∞Ñ Î≤ÑÌäº Î†åÎçîÎßÅ ====================
        function renderSpaceButtons() {
            const container = document.getElementById('spaceButtons');
            const allSpaces = [...DEFAULT_SPACES, ...APP_DATA.customSpaces];
            
            container.innerHTML = allSpaces.map(space => `
                <button class="touch-btn ${currentDefect.spaces.includes(space) ? 'selected' : ''}"
                        ${currentDefect.spaces.length >= 4 && !currentDefect.spaces.includes(space) ? 'disabled' : ''}
                        onclick="toggleSpace('${space}')">
                    ${space}
                </button>
            `).join('');
        }

        function toggleSpace(space) {
            const idx = currentDefect.spaces.indexOf(space);
            if (idx > -1) {
                currentDefect.spaces.splice(idx, 1);
            } else {
                if (currentDefect.spaces.length >= 4) {
                    showToast('ÏµúÎåÄ 4Í∞úÍπåÏßÄ ÏÑ†ÌÉù Í∞ÄÎä•Ìï©ÎãàÎã§', 'error');
                    return;
                }
                currentDefect.spaces.push(space);
            }
            document.getElementById('spaceCount').textContent = `${currentDefect.spaces.length}/4 ÏÑ†ÌÉù`;
            renderSpaceButtons();
        }

        // ==================== ÏÇ¨ÏßÑ Î∞ïÏä§ Ï¥àÍ∏∞Ìôî ====================
        function resetPhotoBoxes() {
            const farBox = document.getElementById('photoBoxFar');
            const nearBox = document.getElementById('photoBoxNear');
            
            farBox.innerHTML = `
                <span class="photo-capture-icon">üì∏</span>
                <span class="photo-capture-label">ÏõêÍ≤Ω Ï¥¨ÏòÅ</span>
                <span class="photo-capture-sublabel">Î©ÄÎ¶¨ÏÑú Ï†ÑÏ≤¥ Î™®Ïäµ</span>
            `;
            farBox.classList.remove('has-photo');
            
            nearBox.innerHTML = `
                <span class="photo-capture-icon">üîç</span>
                <span class="photo-capture-label">Í∑ºÍ≤Ω Ï¥¨ÏòÅ</span>
                <span class="photo-capture-sublabel">Í∞ÄÍπåÏù¥ÏÑú ÏÉÅÏÑ∏Ìûà</span>
            `;
            nearBox.classList.remove('has-photo');
        }

        // ==================== Ïπ¥Î©îÎùº ====================
        async function openCamera(photoType) {
            if (!photoType) return; // ÏïàÏ†ÑÏû•Ïπò
            currentPhotoType = photoType;
            currentZoom = 1.0;
            markers = [];
            
            const guideText = document.getElementById('cameraGuideText');
            if (photoType === 'far') {
                guideText.textContent = 'üì∏ ÏõêÍ≤Ω Ï¥¨ÏòÅ - Î©ÄÎ¶¨ÏÑú Ï†ÑÏ≤¥ Î™®Ïäµ';
                guideText.className = 'camera-guide-text far';
            } else {
                guideText.textContent = 'üîç Í∑ºÍ≤Ω Ï¥¨ÏòÅ - Í∞ÄÍπåÏù¥ÏÑú ÏÉÅÏÑ∏Ìûà';
                guideText.className = 'camera-guide-text near';
            }
            
            try {
                // Ïπ¥Î©îÎùº API ÏßÄÏõê ÌôïÏù∏
                if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                    throw new Error('Ïπ¥Î©îÎùº ÎØ∏ÏßÄÏõê');
                }
                
                // ÎîîÎ∞îÏù¥Ïä§Î≥Ñ ÏµúÏ†ÅÌôî
                const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
                
                let constraints = {
                    video: { facingMode: 'environment' },
                    audio: false
                };
                
                // iOS: Ï§ëÍ∞Ñ Ìï¥ÏÉÅÎèÑ (Î©îÎ™®Î¶¨ ÏµúÏ†ÅÌôî)
                if (isIOS) {
                    constraints.video.width = { ideal: 1280 };
                    constraints.video.height = { ideal: 720 };
                } else {
                    constraints.video.width = { ideal: 1920 };
                    constraints.video.height = { ideal: 1080 };
                }
                
                cameraStream = await navigator.mediaDevices.getUserMedia(constraints);
                
                const video = document.getElementById('cameraPreview');
                video.srcObject = cameraStream;
                
                // iOS Safari ÌïÑÏàò ÏÜçÏÑ±
                video.setAttribute('playsinline', 'true');
                video.setAttribute('webkit-playsinline', 'true');
                video.muted = true;
                
                // ÎπÑÎîîÏò§ Î°úÎìú ÎåÄÍ∏∞
                await new Promise((resolve) => {
                    video.onloadedmetadata = () => {
                        video.play().then(resolve).catch(resolve);
                    };
                    setTimeout(resolve, 3000);
                });
                
                // Ï§å Ï¥àÍ∏∞Ìôî
                video.style.transform = 'scale(1)';
                document.getElementById('zoomLevel').textContent = '1.0x';
                
                // ÎßàÏª§ Ï∫îÎ≤ÑÏä§ Ï¥àÍ∏∞Ìôî
                markerCanvas = document.getElementById('markerCanvas');
                markerCtx = markerCanvas.getContext('2d');
                resizeMarkerCanvas();
                
                // Ïª®ÌÖçÏä§Ìä∏ Î©îÎâ¥ Ï∞®Îã® (Google Lens Î∞©ÏßÄ)
                video.addEventListener('contextmenu', preventEvent, { passive: false });
                
                // ÌÑ∞Ïπò Ïù¥Î≤§Ìä∏ ÏÑ§Ï†ï
                setupTouchEvents(video);
                
                document.getElementById('cameraModal').classList.add('active');
                document.getElementById('markerHint').classList.remove('hidden');
                
                // 3Ï¥à ÌõÑ ÌûåÌä∏ Ïà®ÍπÄ
                setTimeout(() => {
                    document.getElementById('markerHint').classList.add('hidden');
                }, 3000);
                
            } catch (err) {
                console.error('Ïπ¥Î©îÎùº Ïò§Î•ò:', err);
                showToast('Ïπ¥Î©îÎùºÎ•º ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§. Í∞§Îü¨Î¶¨ÏóêÏÑú ÏÑ†ÌÉùÌï©ÎãàÎã§.', 'error');
                openGallery(photoType);
            }
        }

        function preventEvent(e) {
            e.preventDefault();
            e.stopPropagation();
            return false;
        }

        // ÌÑ∞Ïπò Ïù¥Î≤§Ìä∏ ÏÑ§Ï†ï (ÌïÄÏπòÏ§å + ÎßàÏª§)
        function setupTouchEvents(video) {
            const container = video.parentElement;
            let initialDistance = 0;
            let initialZoom = 1.0;
            let touchStartTime = 0;
            
            const getDistance = (touch1, touch2) => {
                const dx = touch1.clientX - touch2.clientX;
                const dy = touch1.clientY - touch2.clientY;
                return Math.sqrt(dx * dx + dy * dy);
            };
            
            container.ontouchstart = (e) => {
                touchStartTime = Date.now();
                if (e.touches.length === 2) {
                    initialDistance = getDistance(e.touches[0], e.touches[1]);
                    initialZoom = currentZoom;
                    e.preventDefault();
                }
            };
            
            container.ontouchmove = (e) => {
                if (e.touches.length === 2) {
                    const newDistance = getDistance(e.touches[0], e.touches[1]);
                    const scale = newDistance / initialDistance;
                    applyZoom(initialZoom * scale);
                    e.preventDefault();
                }
            };
            
            container.ontouchend = (e) => {
                const touchDuration = Date.now() - touchStartTime;
                if (touchDuration < 200 && e.changedTouches.length === 1 && markers.length < 10) {
                    const touch = e.changedTouches[0];
                    const rect = container.getBoundingClientRect();
                    const x = (touch.clientX - rect.left) / rect.width;
                    const y = (touch.clientY - rect.top) / rect.height;
                    addMarker(x, y);
                }
            };
        }

        function applyZoom(zoom) {
            currentZoom = Math.max(1.0, Math.min(zoom, 5.0));
            const video = document.getElementById('cameraPreview');
            video.style.transform = `scale(${currentZoom})`;
            document.getElementById('zoomLevel').textContent = `${currentZoom.toFixed(1)}x`;
        }

        function resizeMarkerCanvas() {
            if (!markerCanvas) return;
            const video = document.getElementById('cameraPreview');
            const rect = video.getBoundingClientRect();
            markerCanvas.width = rect.width;
            markerCanvas.height = rect.height;
            redrawMarkers();
        }

        function addMarker(x, y) {
            markers.push({ x, y });
            redrawMarkers();
            document.getElementById('markerHint').classList.add('hidden');
        }

        function redrawMarkers() {
            if (!markerCtx || !markerCanvas) return;
            markerCtx.clearRect(0, 0, markerCanvas.width, markerCanvas.height);
            
            markers.forEach((marker, idx) => {
                const x = marker.x * markerCanvas.width;
                const y = marker.y * markerCanvas.height;
                
                markerCtx.beginPath();
                markerCtx.arc(x, y, 20, 0, Math.PI * 2);
                markerCtx.strokeStyle = '#00D4AA';
                markerCtx.lineWidth = 3;
                markerCtx.stroke();
                
                markerCtx.beginPath();
                markerCtx.arc(x, y, 4, 0, Math.PI * 2);
                markerCtx.fillStyle = '#00D4AA';
                markerCtx.fill();
                
                markerCtx.font = 'bold 12px sans-serif';
                markerCtx.fillStyle = '#00D4AA';
                markerCtx.textAlign = 'center';
                markerCtx.fillText(idx + 1, x, y - 28);
            });
        }

        function resetMarkers() {
            markers = [];
            redrawMarkers();
            showToast('ÎßàÏª§Í∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§');
        }

        function closeCamera() {
            if (cameraStream) {
                cameraStream.getTracks().forEach(t => t.stop());
                cameraStream = null;
            }
            const video = document.getElementById('cameraPreview');
            if (video) video.style.transform = 'scale(1)';
            document.getElementById('cameraModal').classList.remove('active');
        }

        function adjustZoom(delta) {
            applyZoom(currentZoom + delta);
        }

        function capturePhoto() {
            const video = document.getElementById('cameraPreview');
            const canvas = document.getElementById('photoCanvas');
            const ctx = canvas.getContext('2d', { alpha: false });
            
            // ÎîîÎ∞îÏù¥Ïä§Î≥Ñ ÏµúÏ†ÅÌôî (ÎçîÌôàÏ†êÍ≤Ä ÎèôÏùº)
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
            const maxSize = isIOS ? 1280 : 1920;
            const quality = isIOS ? 0.8 : 0.85;
            
            let width = video.videoWidth;
            let height = video.videoHeight;
            
            // ÏµúÎåÄ ÎÑàÎπÑ Ï†úÌïú
            if (width > maxSize) {
                height = Math.round(height * maxSize / width);
                width = maxSize;
            }
            
            // iOS Î©îÎ™®Î¶¨ Ï†úÌïú
            const maxPixels = isIOS ? 4096 * 4096 : 8192 * 8192;
            if (width * height > maxPixels) {
                const scale = Math.sqrt(maxPixels / (width * height));
                width = Math.floor(width * scale);
                height = Math.floor(height * scale);
            }
            
            canvas.width = width;
            canvas.height = height;
            
            // Î∞∞Í≤Ω Ìù∞ÏÉâ
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);
            
            // Í≥†ÌíàÏßà Î†åÎçîÎßÅ
            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = 'high';
            
            // Ï§å Ï†ÅÏö©ÌïòÏó¨ Ï∫°Ï≤ò
            if (currentZoom > 1) {
                const zoomedWidth = video.videoWidth / currentZoom;
                const zoomedHeight = video.videoHeight / currentZoom;
                const sx = (video.videoWidth - zoomedWidth) / 2;
                const sy = (video.videoHeight - zoomedHeight) / 2;
                ctx.drawImage(video, sx, sy, zoomedWidth, zoomedHeight, 0, 0, width, height);
            } else {
                ctx.drawImage(video, 0, 0, width, height);
            }
            
            // ÎßàÏª§ Í∑∏Î¶¨Í∏∞
            if (markers.length > 0) {
                markers.forEach((marker, idx) => {
                    const x = marker.x * width;
                    const y = marker.y * height;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 25, 0, Math.PI * 2);
                    ctx.strokeStyle = '#00D4AA';
                    ctx.lineWidth = 4;
                    ctx.stroke();
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 5, 0, Math.PI * 2);
                    ctx.fillStyle = '#00D4AA';
                    ctx.fill();
                    
                    ctx.font = 'bold 16px sans-serif';
                    ctx.fillStyle = '#00D4AA';
                    ctx.textAlign = 'center';
                    ctx.fillText(idx + 1, x, y - 35);
                });
            }
            
            const imageData = canvas.toDataURL('image/jpeg', quality);
            
            // ÏÇ¨ÏßÑ Ï†ÄÏû•
            currentDefect.photos[currentPhotoType] = imageData;
            
            // UI ÏóÖÎç∞Ïù¥Ìä∏
            updatePhotoBox(currentPhotoType, imageData);
            
            closeCamera();
            showToast(currentPhotoType === 'far' ? 'ÏõêÍ≤Ω ÏÇ¨ÏßÑ Ï¥¨ÏòÅ ÏôÑÎ£å!' : 'Í∑ºÍ≤Ω ÏÇ¨ÏßÑ Ï¥¨ÏòÅ ÏôÑÎ£å!');
        }

        function updatePhotoBox(photoType, imageData) {
            const box = document.getElementById(photoType === 'far' ? 'photoBoxFar' : 'photoBoxNear');
            const label = photoType === 'far' ? 'ÏõêÍ≤Ω' : 'Í∑ºÍ≤Ω';
            
            box.innerHTML = `
                <img src="${imageData}" class="photo-preview" alt="${label}">
                <span class="photo-badge ${photoType}">${label}</span>
                <button class="photo-retake-btn" onclick="event.stopPropagation(); retakePhoto('${photoType}')">üîÑ Îã§Ïãú Ï∞çÍ∏∞</button>
            `;
            box.classList.add('has-photo');
        }

        function retakePhoto(photoType) {
            currentDefect.photos[photoType] = null;
            
            const box = document.getElementById(photoType === 'far' ? 'photoBoxFar' : 'photoBoxNear');
            if (photoType === 'far') {
                box.innerHTML = `
                    <span class="photo-capture-icon">üì∏</span>
                    <span class="photo-capture-label">ÏõêÍ≤Ω Ï¥¨ÏòÅ</span>
                    <span class="photo-capture-sublabel">Î©ÄÎ¶¨ÏÑú Ï†ÑÏ≤¥ Î™®Ïäµ</span>
                `;
            } else {
                box.innerHTML = `
                    <span class="photo-capture-icon">üîç</span>
                    <span class="photo-capture-label">Í∑ºÍ≤Ω Ï¥¨ÏòÅ</span>
                    <span class="photo-capture-sublabel">Í∞ÄÍπåÏù¥ÏÑú ÏÉÅÏÑ∏Ìûà</span>
                `;
            }
            box.classList.remove('has-photo');
            
            // ÏòµÏÖò ÏãúÌä∏ ÌëúÏãú
            showPhotoOptions(photoType);
        }

        // Í∞§Îü¨Î¶¨ Ìè¥Î∞±
        function openGallery(photoType) {
            if (!photoType) return; // ÏïàÏ†ÑÏû•Ïπò
            currentPhotoType = photoType;
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = handleGallerySelect;
            input.click();
        }

        function openGalleryFromCamera() {
            // Ïπ¥Î©îÎùº Îã´Í≥† Í∞§Îü¨Î¶¨ Ïó¥Í∏∞
            if (cameraStream) {
                cameraStream.getTracks().forEach(t => t.stop());
                cameraStream = null;
            }
            document.getElementById('cameraModal').classList.remove('active');
            
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = handleGallerySelect;
            input.click();
        }

        // ==================== ÏÇ¨ÏßÑ ÏòµÏÖò Ïï°ÏÖòÏãúÌä∏ ====================
        let pendingPhotoType = null;

        function showPhotoOptions(photoType) {
            pendingPhotoType = photoType;
            const title = photoType === 'far' ? 'ÏõêÍ≤Ω ÏÇ¨ÏßÑ (Î©ÄÎ¶¨ÏÑú)' : 'Í∑ºÍ≤Ω ÏÇ¨ÏßÑ (Í∞ÄÍπåÏù¥ÏÑú)';
            document.getElementById('photoActionTitle').textContent = title;
            document.getElementById('photoActionSheet').classList.add('active');
        }

        function closePhotoOptions() {
            document.getElementById('photoActionSheet').classList.remove('active');
            pendingPhotoType = null;
        }

        function selectPhotoOption(option) {
            const photoType = pendingPhotoType; // Î®ºÏ†Ä Ï†ÄÏû•
            closePhotoOptions();
            
            if (!photoType) return;
            
            if (option === 'camera') {
                openCamera(photoType);
            } else if (option === 'gallery') {
                openGallery(photoType);
            }
        }

        // ==================== Ïù¥ÎØ∏ÏßÄ ÏïïÏ∂ï (ÎçîÌôàÏ†êÍ≤Ä ÎèôÏùº) ====================
        async function compressImage(input, maxWidth = 1920, quality = 0.85) {
            return new Promise((resolve, reject) => {
                try {
                    // ÎîîÎ∞îÏù¥Ïä§ Í∞êÏßÄ
                    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
                    
                    // iOS ÏµúÏ†ÅÌôî
                    if (isIOS) {
                        maxWidth = Math.min(maxWidth, 1280);
                        quality = Math.min(quality, 0.8);
                    }
                    
                    const img = new Image();
                    
                    img.onerror = () => reject(new Error('Ïù¥ÎØ∏ÏßÄ Î°úÎìú Ïã§Ìå®'));
                    
                    img.onload = () => {
                        try {
                            const canvas = document.getElementById('photoCanvas');
                            const ctx = canvas.getContext('2d', { alpha: false });
                            
                            let width = img.width;
                            let height = img.height;
                            
                            // ÏµúÎåÄ ÎÑàÎπÑ Ï†úÌïú
                            if (width > maxWidth) {
                                height = (height * maxWidth) / width;
                                width = maxWidth;
                            }
                            
                            // iOS Î©îÎ™®Î¶¨ Ï†úÌïú
                            const maxPixels = isIOS ? 4096 * 4096 : 8192 * 8192;
                            if (width * height > maxPixels) {
                                const scale = Math.sqrt(maxPixels / (width * height));
                                width = Math.floor(width * scale);
                                height = Math.floor(height * scale);
                            }
                            
                            canvas.width = width;
                            canvas.height = height;
                            
                            // Î∞∞Í≤Ω Ìù∞ÏÉâ (Ìà¨Î™Ö PNG Ï≤òÎ¶¨)
                            ctx.fillStyle = '#FFFFFF';
                            ctx.fillRect(0, 0, width, height);
                            
                            // Í≥†ÌíàÏßà Î†åÎçîÎßÅ
                            ctx.imageSmoothingEnabled = true;
                            ctx.imageSmoothingQuality = 'high';
                            ctx.drawImage(img, 0, 0, width, height);
                            
                            resolve(canvas.toDataURL('image/jpeg', quality));
                        } catch (err) {
                            reject(err);
                        }
                    };
                    
                    img.src = input;
                } catch (err) {
                    reject(err);
                }
            });
        }
        
        // Í∞§Îü¨Î¶¨ ÏÑ†ÌÉù Ìï∏Îì§Îü¨ (asyncÎ°ú Î≥ÄÍ≤Ω)
        async function handleGallerySelect(e) {
            const file = e.target.files[0];
            if (!file) return;
            if (!currentPhotoType) return;
            
            try {
                const reader = new FileReader();
                reader.onload = async function(event) {
                    try {
                        const compressed = await compressImage(event.target.result, 1280, 0.8);
                        currentDefect.photos[currentPhotoType] = compressed;
                        updatePhotoBox(currentPhotoType, compressed);
                        showToast('ÏÇ¨ÏßÑÏù¥ Ï≤®Î∂ÄÎêòÏóàÏäµÎãàÎã§');
                    } catch (err) {
                        console.error('ÏïïÏ∂ï Ïò§Î•ò:', err);
                        showToast('Ïù¥ÎØ∏ÏßÄ Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§', 'error');
                    }
                };
                reader.readAsDataURL(file);
            } catch (err) {
                showToast('ÌååÏùºÏùÑ ÏùΩÏùÑ Ïàò ÏóÜÏäµÎãàÎã§', 'error');
            }
        }

        // ==================== ÌïòÏûê Ï†ÄÏû• ====================
        function saveDefect() {
            // Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
            if (!currentDefect.photos.far || !currentDefect.photos.near) {
                showToast('ÏõêÍ≤Ω/Í∑ºÍ≤Ω ÏÇ¨ÏßÑ 2Ïû•ÏùÑ Î™®Îëê Ï¥¨ÏòÅÌï¥Ï£ºÏÑ∏Ïöî', 'error');
                return;
            }
            
            if (currentDefect.spaces.length === 0) {
                showToast('Í≥µÍ∞ÑÏùÑ 1Í∞ú Ïù¥ÏÉÅ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî', 'error');
                return;
            }
            
            // ÏÑ§Î™Ö Í∞ÄÏ†∏Ïò§Í∏∞
            currentDefect.description = document.getElementById('defectDescription').value;
            
            // ÏûêÎèô ÏÑ§Î™Ö ÏÉùÏÑ± (ÏûÖÎ†• ÏóÜÏùÑ Í≤ΩÏö∞)
            if (!currentDefect.description && currentDefect.spaces.length > 0) {
                currentDefect.description = currentDefect.spaces.join(', ') + ' ÌïòÏûê';
            }
            
            // Ï†ÄÏû•
            const defect = {
                id: Date.now(),
                spaces: [...currentDefect.spaces],
                description: currentDefect.description,
                photos: [currentDefect.photos.far, currentDefect.photos.near],
                createdAt: new Date().toISOString()
            };
            
            APP_DATA.defects.push(defect);
            saveData();
            
            closeDefectRegister();
            renderDefectList();
            showToast('ÌïòÏûêÍ∞Ä Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§!');
        }

        // ==================== ÌïòÏûê Î™©Î°ù Î†åÎçîÎßÅ ====================
        function renderDefectList() {
            const container = document.getElementById('defectList');
            
            if (APP_DATA.defects.length === 0) {
                container.innerHTML = `
                    <div class="defect-empty">
                        <div class="defect-empty-icon">üîç</div>
                        <p>ÏïÑÏßÅ Î∞úÍ≤¨Îêú ÌïòÏûêÍ∞Ä ÏóÜÏäµÎãàÎã§</p>
                        <p style="font-size: 12px; margin-top: 8px;">ÏïÑÎûò Î≤ÑÌäºÏùÑ ÎàåÎü¨ ÌïòÏûêÎ•º Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = APP_DATA.defects.map((defect, index) => `
                <div class="defect-card">
                    <button class="defect-delete-btn" onclick="event.stopPropagation(); deleteDefect(${defect.id})">üóëÔ∏è</button>
                    <div class="defect-header">
                        <span class="defect-number">${index + 1}</span>
                        <span class="defect-location">${defect.spaces.join(', ') || 'ÎØ∏ÏßÄÏ†ï'}</span>
                    </div>
                    <div class="defect-photos">
                        ${defect.photos[0] ? `<img src="${defect.photos[0]}" class="defect-photo" alt="ÏõêÍ≤Ω">` : ''}
                        ${defect.photos[1] ? `<img src="${defect.photos[1]}" class="defect-photo" alt="Í∑ºÍ≤Ω">` : ''}
                    </div>
                    ${defect.description ? `<div class="defect-desc">${defect.description}</div>` : ''}
                </div>
            `).join('');
        }

        function deleteDefect(id) {
            if (!confirm('Ïù¥ ÌïòÏûêÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            
            const idx = APP_DATA.defects.findIndex(d => d.id === id);
            if (idx > -1) {
                APP_DATA.defects.splice(idx, 1);
                saveData();
                renderDefectList();
                showToast('ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§');
            }
        }

        // ==================== Ïû•ÎπÑ Í∞ÄÏù¥Îìú ====================
        function renderEquipmentList() {
            const equipment = [
                { name: 'Ïó¥ÌôîÏÉÅ Ïπ¥Î©îÎùº', icon: 'üî•', desc: 'Í≤∞Î°ú, ÎàÑÏàò, Îã®Ïó¥ Î∂àÎüâ ÌôïÏù∏' },
                { name: 'ÎùºÎèà Ï∏°Ï†ïÍ∏∞', icon: '‚ò¢Ô∏è', desc: 'Ïã§ÎÇ¥ ÎùºÎèà ÎÜçÎèÑ Ï∏°Ï†ï' },
                { name: 'Î†àÏù¥Ï†Ä Î†àÎ≤®Í∏∞', icon: 'üìê', desc: 'Î∞îÎã•/Î≤Ω ÏàòÌèâ ÌôïÏù∏' },
                { name: 'Í≥µÍ∏∞Ïßà Ï∏°Ï†ïÍ∏∞', icon: 'üí®', desc: 'PM2.5, CO2, TVOC Ï∏°Ï†ï' }
            ];
            
            document.getElementById('equipmentList').innerHTML = equipment.map(eq => `
                <div style="background: var(--card-bg); border: 1px solid var(--card-border); border-radius: var(--radius); padding: 16px; margin-bottom: 12px; display: flex; align-items: center; gap: 16px;">
                    <div style="width: 48px; height: 48px; background: var(--primary-light); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px;">${eq.icon}</div>
                    <div>
                        <div style="font-weight: 600; margin-bottom: 4px;">${eq.name}</div>
                        <div style="font-size: 12px; color: var(--text-muted);">${eq.desc}</div>
                    </div>
                </div>
            `).join('');
        }

        // ==================== Î¶¨Ìè¨Ìä∏/Í≥µÏú† ====================
        function showLoading(text = 'PDF ÏÉùÏÑ± Ï§ë...') {
            document.getElementById('loadingText').textContent = text;
            document.getElementById('loadingOverlay').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        // ÌîÑÎ°úÏ†ùÌä∏ Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
        function getProjectInfo() {
            return {
                apartmentName: document.getElementById('apartmentName').value || 'ÎØ∏ÏûÖÎ†•',
                dong: document.getElementById('dongNumber').value || '-',
                ho: document.getElementById('hoNumber').value || '-',
                inspectionDate: document.getElementById('inspectionDate').value || new Date().toISOString().split('T')[0]
            };
        }

        // PDF ÏÉùÏÑ± Î©îÏù∏ Ìï®Ïàò
        async function generatePDF() {
            const projectInfo = getProjectInfo();
            
            // Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
            if (!projectInfo.apartmentName || projectInfo.apartmentName === 'ÎØ∏ÏûÖÎ†•') {
                showToast('ÏïÑÌååÌä∏Î™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'error');
                return;
            }
            
            if (APP_DATA.defects.length === 0) {
                if (!confirm('Î∞úÍ≤¨Îêú ÌïòÏûêÍ∞Ä ÏóÜÏäµÎãàÎã§. Í∑∏ÎûòÎèÑ Î≥¥Í≥†ÏÑúÎ•º ÏÉùÏÑ±ÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    return;
                }
            }

            showLoading('PDF Î≥¥Í≥†ÏÑú ÏÉùÏÑ± Ï§ë...');

            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                const pageWidth = 210;
                const pageHeight = 297;

                // 1ÌéòÏù¥ÏßÄ: ÌëúÏßÄ
                const coverHTML = createCoverPage(projectInfo);
                await addHTMLPageToPDF(doc, coverHTML, pageWidth, pageHeight);

                // 2ÌéòÏù¥ÏßÄ~: ÌïòÏûê Î™©Î°ù (ÏûàÎäî Í≤ΩÏö∞)
                if (APP_DATA.defects.length > 0) {
                    doc.addPage();
                    const listHTML = createDefectListPage(projectInfo);
                    await addHTMLPageToPDF(doc, listHTML, pageWidth, pageHeight);

                    // ÌïòÏûê ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄ (3Í∞úÏî©)
                    for (let i = 0; i < APP_DATA.defects.length; i += 3) {
                        doc.addPage();
                        const batch = APP_DATA.defects.slice(i, i + 3);
                        const detailHTML = createDefectDetailPage(batch, i, projectInfo);
                        await addHTMLPageToPDF(doc, detailHTML, pageWidth, pageHeight);
                    }
                }

                // ÌååÏùº Ï†ÄÏû•
                const filename = `Î∑∞ÌååÏù∏Îçî_${projectInfo.apartmentName}_${projectInfo.dong}Îèô${projectInfo.ho}Ìò∏_${projectInfo.inspectionDate}.pdf`;
                
                const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
                
                if (isMobile) {
                    const pdfBlob = doc.output('blob');
                    const blobUrl = URL.createObjectURL(pdfBlob);
                    
                    const link = document.createElement('a');
                    link.href = blobUrl;
                    link.download = filename;
                    document.body.appendChild(link);
                    link.click();
                    
                    setTimeout(() => {
                        document.body.removeChild(link);
                        URL.revokeObjectURL(blobUrl);
                    }, 100);
                } else {
                    doc.save(filename);
                }

                hideLoading();
                showToast('PDF Î≥¥Í≥†ÏÑúÍ∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§!');

            } catch (error) {
                console.error('PDF ÏÉùÏÑ± Ïò§Î•ò:', error);
                hideLoading();
                showToast('PDF ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§', 'error');
            }
        }

        // HTMLÏùÑ PDFÏóê Ï∂îÍ∞Ä
        async function addHTMLPageToPDF(doc, htmlContent, pageWidth, pageHeight) {
            const tempDiv = document.createElement('div');
            tempDiv.style.width = '794px';
            tempDiv.style.position = 'absolute';
            tempDiv.style.left = '-9999px';
            tempDiv.style.background = '#ffffff';
            tempDiv.innerHTML = htmlContent;
            document.body.appendChild(tempDiv);

            const canvas = await html2canvas(tempDiv, {
                scale: 2,
                useCORS: true,
                backgroundColor: '#ffffff',
                logging: false
            });

            document.body.removeChild(tempDiv);

            const imgData = canvas.toDataURL('image/jpeg', 0.95);
            const imgWidth = pageWidth;
            const imgHeight = (canvas.height * pageWidth) / canvas.width;
            
            doc.addImage(imgData, 'JPEG', 0, 0, imgWidth, Math.min(imgHeight, pageHeight));
        }

        // ÌëúÏßÄ ÌéòÏù¥ÏßÄ ÏÉùÏÑ±
        function createCoverPage(projectInfo) {
            const defectCount = APP_DATA.defects.length;
            const checkedCount = Object.keys(APP_DATA.checkedItems).filter(k => APP_DATA.checkedItems[k]).length;
            const totalItems = Object.keys(CHECKLIST_DATA).reduce((sum, key) => sum + CHECKLIST_DATA[key].items.length, 0);
            
            return `
                <div style="width: 794px; height: 1123px; background: #ffffff; font-family: 'Malgun Gothic', sans-serif; position: relative; box-sizing: border-box;">
                    
                    <!-- ÏÉÅÎã® ÎØºÌä∏ ÏïÖÏÑºÌä∏ Î∞î -->
                    <div style="height: 8px; background: linear-gradient(90deg, #00D4AA 0%, #00A080 100%);"></div>
                    
                    <!-- Ï¢åÏ∏° ÏÇ¨Ïù¥Îìú ÏïÖÏÑºÌä∏ -->
                    <div style="position: absolute; left: 0; top: 0; width: 6px; height: 100%; background: linear-gradient(180deg, #00D4AA 0%, #00A080 100%);"></div>
                    
                    <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† -->
                    <div style="padding: 60px 60px 50px 80px;">
                        
                        <!-- ÏÉÅÎã® Î°úÍ≥† -->
                        <div style="margin-bottom: 40px;">
                            <div style="display: inline-flex; align-items: center; gap: 12px; padding: 10px 20px; background: #e8f5e9; border-radius: 30px;">
                                <div style="width: 8px; height: 8px; background: #00D4AA; border-radius: 50%;"></div>
                                <span style="color: #000; font-size: 13px; font-weight: 600; letter-spacing: 1px;">SELF INSPECTION REPORT</span>
                            </div>
                        </div>
                        
                        <!-- ÌÉÄÏù¥ÌãÄ -->
                        <div style="margin-bottom: 50px;">
                            <h1 style="font-size: 52px; font-weight: 800; color: #000; margin: 0 0 15px 0; line-height: 1.2;">
                                ÏÖÄÌîÑÏ†êÍ≤Ä<br/>Î≥¥Í≥†ÏÑú
                            </h1>
                            <div style="width: 80px; height: 5px; background: #00D4AA; border-radius: 3px;"></div>
                        </div>
                        
                        <!-- ÌîÑÎ°úÏ†ùÌä∏ Ï†ïÎ≥¥ -->
                        <div style="background: #f8f9fa; border: 2px solid #ddd; border-radius: 16px; padding: 30px; margin-bottom: 40px;">
                            <div style="font-size: 14px; color: #000; font-weight: 700; margin-bottom: 20px;">üìã Ï†êÍ≤Ä Ï†ïÎ≥¥</div>
                            
                            <div style="display: flex; flex-direction: column; gap: 16px;">
                                <div style="display: flex; border-bottom: 1px solid #ddd; padding-bottom: 12px;">
                                    <span style="width: 100px; color: #666; font-size: 14px; font-weight: 500;">ÏïÑÌååÌä∏Î™Ö</span>
                                    <span style="font-size: 16px; font-weight: 700; color: #000;">${projectInfo.apartmentName}</span>
                                </div>
                                <div style="display: flex; border-bottom: 1px solid #ddd; padding-bottom: 12px;">
                                    <span style="width: 100px; color: #666; font-size: 14px; font-weight: 500;">Îèô/Ìò∏Ïàò</span>
                                    <span style="font-size: 16px; font-weight: 700; color: #000;">${projectInfo.dong}Îèô ${projectInfo.ho}Ìò∏</span>
                                </div>
                                <div style="display: flex;">
                                    <span style="width: 100px; color: #666; font-size: 14px; font-weight: 500;">Ï†êÍ≤ÄÏùºÏûê</span>
                                    <span style="font-size: 16px; font-weight: 700; color: #000;">${projectInfo.inspectionDate}</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ï†êÍ≤Ä Í≤∞Í≥º ÏöîÏïΩ -->
                        <div style="display: flex; gap: 20px; margin-bottom: 50px;">
                            <div style="flex: 1; background: linear-gradient(135deg, #e74c3c, #c0392b); border-radius: 16px; padding: 25px; text-align: center;">
                                <div style="font-size: 48px; font-weight: 800; color: white;">${defectCount}</div>
                                <div style="font-size: 14px; color: rgba(255,255,255,0.9); font-weight: 600;">Î∞úÍ≤¨Îêú ÌïòÏûê</div>
                            </div>
                            <div style="flex: 1; background: #f8f9fa; border: 2px solid #ddd; border-radius: 16px; padding: 25px; text-align: center;">
                                <div style="font-size: 48px; font-weight: 800; color: #000;">${checkedCount}</div>
                                <div style="font-size: 14px; color: #666; font-weight: 600;">Ï≤¥ÌÅ¨Î¶¨Ïä§Ìä∏ ÏôÑÎ£å</div>
                            </div>
                        </div>
                        
                        <!-- ÏïàÎÇ¥ Î¨∏Íµ¨ -->
                        <div style="background: #fff3e0; border: 2px solid #ff9800; border-radius: 12px; padding: 20px;">
                            <div style="font-size: 13px; color: #000; line-height: 1.6; font-weight: 500;">
                                üí° Î≥∏ Î≥¥Í≥†ÏÑúÎäî Î∑∞ÌååÏù∏Îçî ÏÖÄÌîÑÏ†êÍ≤Ä ÏÑúÎπÑÏä§Î•º ÌÜµÌï¥ ÏûëÏÑ±ÎêòÏóàÏäµÎãàÎã§.<br/>
                                Ï†ÑÎ¨∏Í∞Ä Ï†êÍ≤ÄÏù¥ ÌïÑÏöîÌïòÏãúÎ©¥ ÎçîÌôàÏ†êÍ≤Ä ÌîÑÎ°ú ÏÑúÎπÑÏä§Î•º Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÌïòÎã® Ìë∏ÌÑ∞ -->
                    <div style="position: absolute; bottom: 0; left: 0; right: 0; padding: 25px 60px; background: #f8f9fa; border-top: 2px solid #ddd;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 36px; height: 36px; background: linear-gradient(135deg, #00D4AA, #00A080); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: white; font-size: 18px;">üè†</div>
                                <span style="font-size: 18px; font-weight: 700; color: #000;">Î∑∞ÌååÏù∏Îçî</span>
                            </div>
                            <div style="text-align: right; font-size: 12px; color: #333; font-weight: 500;">
                                Ïä§ÎßàÌä∏ ÏÖÄÌîÑ ÌôàÏ≤¥ÌÅ¨ ÌîåÎû´Ìèº<br/>
                                ÎçîÌôàÏ†êÍ≤Ä | 010-9985-0128
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ÌïòÏûê Î™©Î°ù ÌéòÏù¥ÏßÄ ÏÉùÏÑ±
        function createDefectListPage(projectInfo) {
            let tableRows = '';
            
            APP_DATA.defects.forEach((defect, idx) => {
                const spaces = defect.spaces.join(', ') || '-';
                const desc = defect.description || '-';
                
                tableRows += `
                    <tr style="border-bottom: 1px solid #ddd;">
                        <td style="padding: 10px 4px; text-align: center; font-weight: bold; color: #000; font-size: 13px; vertical-align: middle; border-right: 1px solid #e0e0e0;">${idx + 1}</td>
                        <td style="padding: 10px 8px; text-align: center; color: #000; font-weight: 600; font-size: 13px; vertical-align: middle; border-right: 1px solid #e0e0e0;">${spaces}</td>
                        <td style="padding: 10px 8px; color: #000; font-weight: 500; font-size: 12px; word-break: break-word; white-space: normal; line-height: 1.5; vertical-align: middle;">${desc}</td>
                    </tr>
                `;
            });
            
            return `
                <div style="width: 794px; min-height: 1123px; max-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 35px; position: relative; box-sizing: border-box; overflow: hidden;">
                    <div style="margin-bottom: 20px;">
                        <h3 style="margin: 0 0 12px 0; font-size: 18px; color: #000; border-bottom: 3px solid #00D4AA; padding-bottom: 8px; font-weight: 700;">üìã ÌïòÏûêÏ†êÍ≤Ä Î™©Î°ù (Ï¥ù ${APP_DATA.defects.length}Í±¥)</h3>
                        <p style="margin: 5px 0 12px 0; font-size: 13px; color: #333; font-weight: 500;">${projectInfo.apartmentName} ${projectInfo.dong}Îèô ${projectInfo.ho}Ìò∏</p>
                    </div>

                    <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd; font-size: 13px; margin-bottom: 60px;">
                        <thead>
                            <tr style="background: #f8f9fa; border-bottom: 2px solid #999;">
                                <th style="padding: 12px 4px; width: 8%; color: #000; font-size: 13px; font-weight: bold; border-right: 1px solid #e0e0e0;">No</th>
                                <th style="padding: 12px 4px; width: 20%; color: #000; font-size: 13px; font-weight: bold; border-right: 1px solid #e0e0e0;">Í≥µÍ∞Ñ</th>
                                <th style="padding: 12px 6px; width: 72%; color: #000; font-size: 13px; font-weight: bold;">ÌïòÏûê ÎÇ¥Ïö©</th>
                            </tr>
                        </thead>
                        <tbody>${tableRows}</tbody>
                    </table>

                    <div style="position: absolute; bottom: 20px; left: 35px; right: 35px; padding-top: 10px; border-top: 1px solid #ddd; font-size: 11px; color: #333; text-align: center;">
                        <div>Î∑∞ÌååÏù∏Îçî | Ïä§ÎßàÌä∏ ÏÖÄÌîÑ ÌôàÏ≤¥ÌÅ¨ ÌîåÎû´Ìèº | ÎçîÌôàÏ†êÍ≤Ä</div>
                    </div>
                </div>
            `;
        }

        // ÌïòÏûê ÏÉÅÏÑ∏ ÌéòÏù¥ÏßÄ ÏÉùÏÑ± (ÎçîÌôàÏ†êÍ≤Ä ÎèôÏùº)
        function createDefectDetailPage(defects, startIndex, projectInfo) {
            let contentHTML = '';
            
            defects.forEach((defect, idx) => {
                const globalIndex = startIndex + idx + 1;
                const spaces = defect.spaces.join(', ') || '-';
                const description = defect.description || '-';
                const farPhoto = defect.photos[0] || '';
                const nearPhoto = defect.photos[1] || '';
                
                contentHTML += `
                    <div style="border: 1.5px solid #ddd; border-radius: 6px; padding: 12px; margin-bottom: 15px; background: white;">
                        <!-- ÌïòÏûê Î≤àÌò∏ Ìó§Îçî -->
                        <div style="background: #f0f9ff; color: #000; border-bottom: 1.5px solid #3498db; padding: 8px 12px; margin: -12px -12px 12px -12px; border-radius: 5px 5px 0 0; font-size: 13px; font-weight: bold;">
                            ÌïòÏûê ${globalIndex} | ${spaces}
                        </div>
                        
                        <!-- ÏÉÅÏÑ∏ÏÑ§Î™Ö -->
                        <div style="font-size: 12px; color: #000; margin-bottom: 10px; padding: 8px 10px; background: #f8f9fa; border-radius: 4px; font-weight: 600; line-height: 1.4;">
                            ${description}
                        </div>

                        <!-- ÏÇ¨ÏßÑ ÏòÅÏó≠ (ÎùºÎ≤® Ïò§Î≤ÑÎ†àÏù¥) -->
                        <div style="display: flex; gap: 10px;">
                            <div style="flex: 1; position: relative; border: 1px solid #ddd; border-radius: 4px; overflow: hidden;">
                                ${farPhoto ? `
                                    <img src="${farPhoto}" style="width: 100%; height: 320px; object-fit: contain; display: block; background: #fafafa;" />
                                    <div style="position: absolute; top: 8px; left: 8px; background: rgba(16, 185, 129, 0.9); color: white; padding: 4px 10px; border-radius: 4px; font-size: 11px; font-weight: bold;">üì∑ ÏõêÍ≤Ω</div>
                                ` : `
                                    <div style="width: 100%; height: 320px; background: #f5f5f5; display: flex; align-items: center; justify-content: center; color: #333; font-size: 11px;">ÏÇ¨ÏßÑ ÏóÜÏùå</div>
                                `}
                            </div>

                            <div style="flex: 1; position: relative; border: 1px solid #ddd; border-radius: 4px; overflow: hidden;">
                                ${nearPhoto ? `
                                    <img src="${nearPhoto}" style="width: 100%; height: 320px; object-fit: contain; display: block; background: #fafafa;" />
                                    <div style="position: absolute; top: 8px; left: 8px; background: rgba(245, 158, 11, 0.9); color: white; padding: 4px 10px; border-radius: 4px; font-size: 11px; font-weight: bold;">üîç Í∑ºÍ≤Ω</div>
                                ` : `
                                    <div style="width: 100%; height: 320px; background: #f5f5f5; display: flex; align-items: center; justify-content: center; color: #333; font-size: 11px;">ÏÇ¨ÏßÑ ÏóÜÏùå</div>
                                `}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            return `
                <div style="width: 794px; min-height: 1123px; background: white; font-family: 'Malgun Gothic', sans-serif; padding: 35px; box-sizing: border-box; position: relative;">
                    <!-- Ìó§Îçî -->
                    <div style="background: #ffebee; border: 1.5px solid #e74c3c; padding: 15px; margin-bottom: 20px; border-radius: 6px;">
                        <h2 style="margin: 0 0 5px 0; font-size: 20px; color: #000; font-weight: 700;">ÌïòÏûê ÏÉÅÏÑ∏ ÏÇ¨ÏßÑ (ÏõêÍ≤Ω+Í∑ºÍ≤Ω)</h2>
                        <p style="margin: 0; font-size: 12px; color: #000;">${projectInfo.apartmentName} ${projectInfo.dong}Îèô ${projectInfo.ho}Ìò∏ | ${projectInfo.inspectionDate || ''}</p>
                    </div>

                    ${contentHTML}

                    <!-- ÌïòÎã® -->
                    <div style="position: absolute; bottom: 20px; left: 35px; right: 35px; padding-top: 10px; border-top: 1px solid #ddd; font-size: 10px; color: #333; text-align: center;">
                        <div>Î∑∞ÌååÏù∏Îçî | ÎçîÌôàÏ†êÍ≤Ä | 010-9985-0128 | ÏÇ¨Ï†ÑÏ†êÍ≤Ä Ï†ÑÎ¨∏</div>
                    </div>
                </div>
            `;
        }

        function shareReport() {
            if (navigator.share) {
                navigator.share({
                    title: 'Î∑∞ÌååÏù∏Îçî Ï†êÍ≤Ä Í≤∞Í≥º',
                    text: `Ï†êÍ≤Ä ÏôÑÎ£å! Î∞úÍ≤¨Îêú ÌïòÏûê: ${APP_DATA.defects.length}Í±¥`,
                    url: window.location.href
                });
            } else {
                showToast('Í≥µÏú† Í∏∞Îä•ÏùÑ ÏßÄÏõêÌïòÏßÄ ÏïäÎäî Î∏åÎùºÏö∞Ï†ÄÏûÖÎãàÎã§');
            }
        }

        function showUpgradeModal() {
            showToast('ÏÑúÎπÑÏä§ ÏóÖÍ∑∏Î†àÏù¥Îìú Î¨∏Ïùò: 010-9985-0128');
        }

        function requestAddon() {
            if (confirm('ÌïòÏûê Ï†ëÏàò ÎåÄÌñâ ÏÑúÎπÑÏä§Î•º Ïã†Ï≤≠ÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n\nÏ†ÑÌôî Ïó∞Í≤∞Î°ú Ïù¥ÎèôÌï©ÎãàÎã§.')) {
                window.location.href = 'tel:010-9985-0128';
            }
        }

        // ==================== ÌÜ†Ïä§Ìä∏ ====================
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast' + (type === 'error' ? ' error' : '');
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2500);
        }
    </script>
</body>
</html>
